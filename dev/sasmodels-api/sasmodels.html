
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>sasmodels package &#8212; SasView 5.0.3 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="sasmodels.custom package" href="sasmodels.custom.html" />
    <link rel="prev" title="sasmodels" href="modules.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sasmodels.custom.html" title="sasmodels.custom package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="modules.html" title="sasmodels"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 5.0.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../dev.html" >Developer Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="modules.html" accesskey="U">sasmodels</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sasmodels-package">
<h1>sasmodels package</h1>
<div class="section" id="subpackages">
<h2>Subpackages</h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="sasmodels.custom.html">sasmodels.custom package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sasmodels.custom.html#module-sasmodels.custom">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sasmodels.custom.html#custom-models">Custom Models</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules</h2>
</div>
<div class="section" id="module-sasmodels.alignment">
<span id="sasmodels-alignment-module"></span><h2>sasmodels.alignment module</h2>
<p>GPU data alignment.</p>
<p>Some web sites say that maximizing performance for OpenCL code requires
aligning data on certain memory boundaries.  The following functions
provide this service:</p>
<p><a class="reference internal" href="#sasmodels.alignment.align_data" title="sasmodels.alignment.align_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">align_data()</span></code></a> aligns an existing array, returning a new array of the
correct alignment.</p>
<p><a class="reference internal" href="#sasmodels.alignment.align_empty" title="sasmodels.alignment.align_empty"><code class="xref py py-func docutils literal notranslate"><span class="pre">align_empty()</span></code></a> to create an empty array of the correct alignment.</p>
<p>Set alignment to <code class="xref py py-func docutils literal notranslate"><span class="pre">gpu.environment()</span></code> attribute <em>boundary</em>.</p>
<p>Note:  This code is unused. So far, tests have not demonstrated any
improvement from forcing correct alignment.  The tests should
be repeated with arrays forced away from the target boundaries
to decide whether it is really required.</p>
<dl class="function">
<dt id="sasmodels.alignment.align_data">
<code class="descclassname">sasmodels.alignment.</code><code class="descname">align_data</code><span class="sig-paren">(</span><em>x</em>, <em>dtype</em>, <em>alignment=128</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/alignment.html#align_data"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a copy of an array on the alignment boundary.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.alignment.align_empty">
<code class="descclassname">sasmodels.alignment.</code><code class="descname">align_empty</code><span class="sig-paren">(</span><em>shape</em>, <em>dtype</em>, <em>alignment=128</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/alignment.html#align_empty"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return an empty array aligned on the alignment boundary.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.bumps_model">
<span id="sasmodels-bumps-model-module"></span><h2>sasmodels.bumps_model module</h2>
<p>Wrap sasmodels for direct use by bumps.</p>
<p><a class="reference internal" href="#sasmodels.bumps_model.Model" title="sasmodels.bumps_model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> is a wrapper for the sasmodels kernel which defines a
bumps <em>Parameter</em> box for each kernel parameter.  <em>Model</em> accepts keyword
arguments to set the initial value for each parameter.</p>
<p><a class="reference internal" href="#sasmodels.bumps_model.Experiment" title="sasmodels.bumps_model.Experiment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Experiment</span></code></a> combines the <em>Model</em> function with a data file loaded by
the sasview data loader.  <em>Experiment</em> takes a <em>cutoff</em> parameter controlling
how far the polydispersity integral extends.</p>
<dl class="class">
<dt id="sasmodels.bumps_model.Model">
<em class="property">class </em><code class="descclassname">sasmodels.bumps_model.</code><code class="descname">Model</code><span class="sig-paren">(</span><em>model</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bumps wrapper for a SAS model.</p>
<p><em>model</em> is a runnable module as returned from <code class="xref py py-func docutils literal notranslate"><span class="pre">core.load_model()</span></code>.</p>
<p><em>cutoff</em> is the polydispersity weight cutoff.</p>
<p>Any additional <em>key=value</em> pairs are model dependent parameters.</p>
<dl class="method">
<dt id="sasmodels.bumps_model.Model.parameters">
<code class="descname">parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Model.parameters"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a dictionary of parameters objects for the parameters,
excluding polydispersity distribution type.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.bumps_model.Model.state">
<code class="descname">state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Model.state"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a dictionary of current values for all the parameters,
including polydispersity distribution type.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.bumps_model.Experiment">
<em class="property">class </em><code class="descclassname">sasmodels.bumps_model.</code><code class="descname">Experiment</code><span class="sig-paren">(</span><em>data</em>, <em>model</em>, <em>cutoff=1e-05</em>, <em>name=None</em>, <em>extra_pars=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Experiment"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.direct_model.DataMixin" title="sasmodels.direct_model.DataMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.direct_model.DataMixin</span></code></a></p>
<p>Bumps wrapper for a SAS experiment.</p>
<p><em>data</em> is a <code class="xref py py-class docutils literal notranslate"><span class="pre">data.Data1D</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">data.Data2D</span></code> or
<code class="xref py py-class docutils literal notranslate"><span class="pre">data.Sesans</span></code> object.  Use <code class="xref py py-func docutils literal notranslate"><span class="pre">data.empty_data1D()</span></code> or
<code class="xref py py-func docutils literal notranslate"><span class="pre">data.empty_data2D()</span></code> to define <span class="math notranslate nohighlight">\(q, \Delta q\)</span> calculation
points for displaying the SANS curve when there is no measured data.</p>
<p><em>model</em> is a <a class="reference internal" href="#sasmodels.bumps_model.Model" title="sasmodels.bumps_model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> object.</p>
<p><em>cutoff</em> is the integration cutoff, which avoids computing the
the SAS model where the polydispersity weight is low.</p>
<p>The resulting model can be used directly in a Bumps FitProblem call.</p>
<dl class="method">
<dt id="sasmodels.bumps_model.Experiment.nllf">
<code class="descname">nllf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Experiment.nllf"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the negative log likelihood of seeing data given the model
parameters, up to a normalizing constant which depends on the data
uncertainty.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.bumps_model.Experiment.numpoints">
<code class="descname">numpoints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Experiment.numpoints"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the number of data points</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.bumps_model.Experiment.parameters">
<code class="descname">parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Experiment.parameters"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a dictionary of parameters</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.bumps_model.Experiment.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>view=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Experiment.plot"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Plot the data and residuals.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.bumps_model.Experiment.residuals">
<code class="descname">residuals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Experiment.residuals"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return theory minus data normalized by uncertainty.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.bumps_model.Experiment.resolution">
<code class="descname">resolution</code></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.Resolution</span></code> applied to the data, if any.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.bumps_model.Experiment.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>basename</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Experiment.save"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Save the model parameters and data into a file.</p>
<p>Not Implemented except for sesans fits.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.bumps_model.Experiment.simulate_data">
<code class="descname">simulate_data</code><span class="sig-paren">(</span><em>noise=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Experiment.simulate_data"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate simulated data.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.bumps_model.Experiment.theory">
<code class="descname">theory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Experiment.theory"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the theory corresponding to the model parameters.</p>
<p>This method uses lazy evaluation, and requires model.update() to be
called when the parameters have changed.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.bumps_model.Experiment.update">
<code class="descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/bumps_model.html#Experiment.update"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Call when model parameters have changed and theory needs to be
recalculated.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-sasmodels.compare">
<span id="sasmodels-compare-module"></span><h2>sasmodels.compare module</h2>
<p>Program to compare models using different compute engines.</p>
<p>This program lets you compare results between OpenCL and DLL versions
of the code and between precision (half, fast, single, double, quad),
where fast precision is single precision using native functions for
trig, etc., and may not be completely IEEE 754 compliant.  This lets
make sure that the model calculations are stable, or if you need to
tag the model as double precision only.</p>
<p>Run using ./compare.sh (Linux, Mac) or compare.bat (Windows) in the
sasmodels root to see the command line options.</p>
<p>Note that there is no way within sasmodels to select between an
OpenCL CPU device and a GPU device, but you can do so by setting the
PYOPENCL_CTX environment variable ahead of time.  Start a python
interpreter and enter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyopencl</span> <span class="k">as</span> <span class="nn">cl</span>
<span class="n">cl</span><span class="o">.</span><span class="n">create_some_context</span><span class="p">()</span>
</pre></div>
</div>
<p>This will prompt you to select from the available OpenCL devices
and tell you which string to use for the PYOPENCL_CTX variable.
On Windows you will need to remove the quotes.</p>
<div class="section" id="program-description">
<h3>Program description</h3>
<p>usage: sascomp model [options…] [key=val]</p>
<p>Generate and compare SAS models.  If a single model is specified it shows
a plot of that model.  Different models can be compared, or the same model
with different parameters.  The same model with the same parameters can
be compared with different calculation engines to see the effects of precision
on the resultant values.</p>
<p>model or model1,model2 are the names of the models to compare (see below).</p>
<p>Options (* for default):</p>
<blockquote>
<div><p>=== data generation ===
-data=”path” uses q, dq from the data file
-noise=0 sets the measurement error dI/I
-res=0 sets the resolution width dQ/Q if calculating with resolution
-lowq*/-midq/-highq/-exq use q values up to 0.05, 0.2, 1.0, 10.0
-q=min:max alternative specification of qrange
-nq=128 sets the number of Q points in the data set
-1d*/-2d computes 1d or 2d data
-zero indicates that q=0 should be included</p>
<p>=== model parameters ===
-preset*/-random[=seed] preset or random parameters
-sets=n generates n random datasets with the seed given by -random=seed
-pars/-nopars* prints the parameter set or not
-sphere[=150] set up spherical integration over theta/phi using n points
-mono*/-poly suppress or allow polydispersity on generated parameters
-magnetic/-nonmagnetic* suppress or allow magnetism on generated parameters
-maxdim[=inf] limit randomly generate particle dimensions to maxdim</p>
<p>=== calculation options ===
-cutoff=1e-5* cutoff value for including a point in polydispersity
-accuracy=Low accuracy of the resolution calculation Low, Mid, High, Xhigh
-neval=1 sets the number of evals for more accurate timing
-ngauss=0 overrides the number of points in the 1-D gaussian quadrature</p>
<p>=== precision options ===
-engine=default uses the default calcution precision
-single/-double/-half/-fast sets an OpenCL calculation engine
-single!/-double!/-quad! sets an OpenMP calculation engine</p>
<p>=== plotting ===
-plot*/-noplot plots or suppress the plot of the model
-linear/-log*/-q4 intensity scaling on plots
-hist/-nohist* plot histogram of relative error
-abs/-rel* plot relative or absolute error
-title=”note” adds note to the plot title, after the model name
-weights shows weights plots for the polydisperse parameters
-profile shows the sld profile if the model has a plottable sld profile</p>
<p>=== output options ===
-edit starts the parameter explorer
-help/-html shows the model docs instead of running the model</p>
<p>=== help ===
-h/-? print this help
-models[=all] show all builtin models of a given type:</p>
<blockquote>
<div>all, py, c, double, single, opencl, 1d, 2d, magnetic</div></blockquote>
<p>=== environment variables ===
-DSAS_MODELPATH=~/.sasmodels/custom_models sets path to custom models
-DSAS_WEIGHTS_PATH=~/.sasview/weights sets path to custom distributions
-DSAS_OPENCL=vendor:device|cuda:device|none sets the target GPU device
-DXDG_CACHE_HOME=~/.cache sets the pyopencl cache root (linux only)
-DSAS_COMPILER=tinycc|msvc|mingw|unix sets the DLL compiler
-DSAS_OPENMP=0 set to 1 to turn on OpenMP for the DLLs
-DSAS_DLL_PATH=~/.sasmodels/compiled_models sets the DLL cache
-DPYOPENCL_NO_CACHE=1 turns off the PyOpenCL cache</p>
</div></blockquote>
<p>The interpretation of quad precision depends on architecture, and may
vary from 64-bit to 128-bit, with 80-bit floats being common (1e-19 precision).
On unix and mac you may need single quotes around the DLL computation
engines, such as -engine=’single!,double!’ since !, is treated as a history
expansion request in the shell.</p>
<p>Key=value pairs allow you to set specific values for the model parameters.
Key=value1,value2 to compare different values of the same parameter. The
value can be an expression including other parameters.</p>
<p>Items later on the command line override those that appear earlier.</p>
<p>Examples:</p>
<blockquote>
<div><p># compare single and double precision calculation for a barbell
sascomp barbell -engine=single,double</p>
<p># generate 10 random lorentz models, with seed=27
sascomp lorentz -sets=10 -seed=27</p>
<p># compare ellipsoid with R = R_polar = R_equatorial to sphere of radius R
sascomp sphere,ellipsoid radius_polar=radius radius_equatorial=radius</p>
<p># model timing test requires multiple evals to perform the estimate
sascomp pringle -engine=single,double -timing=100,100 -noplot</p>
</div></blockquote>
<dl class="class">
<dt id="sasmodels.compare.Explore">
<em class="property">class </em><code class="descclassname">sasmodels.compare.</code><code class="descname">Explore</code><span class="sig-paren">(</span><em>opts</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#Explore"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bumps wrapper for a SAS model comparison.</p>
<p>The resulting object can be used as a Bumps fit problem so that
parameters can be adjusted in the GUI, with plots updated on the fly.</p>
<dl class="method">
<dt id="sasmodels.compare.Explore.model_update">
<code class="descname">model_update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#Explore.model_update"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Respond to signal that model parameters have been changed.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.compare.Explore.nllf">
<code class="descname">nllf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#Explore.nllf"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return cost.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.compare.Explore.numpoints">
<code class="descname">numpoints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#Explore.numpoints"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the number of points.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.compare.Explore.parameters">
<code class="descname">parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#Explore.parameters"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a dictionary of parameters.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.compare.Explore.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>view='log'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#Explore.plot"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Plot the data and residuals.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.compare.Explore.revert_values">
<code class="descname">revert_values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#Explore.revert_values"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Restore starting values of the parameters.</p>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="sasmodels.compare.MATH">
<code class="descclassname">sasmodels.compare.</code><code class="descname">MATH</code><em class="property"> = {'acos': &lt;built-in function acos&gt;, 'acosh': &lt;built-in function acosh&gt;, 'asin': &lt;built-in function asin&gt;, 'asinh': &lt;built-in function asinh&gt;, 'atan': &lt;built-in function atan&gt;, 'atan2': &lt;built-in function atan2&gt;, 'atanh': &lt;built-in function atanh&gt;, 'ceil': &lt;built-in function ceil&gt;, 'copysign': &lt;built-in function copysign&gt;, 'cos': &lt;built-in function cos&gt;, 'cosh': &lt;built-in function cosh&gt;, 'degrees': &lt;built-in function degrees&gt;, 'e': 2.718281828459045, 'erf': &lt;built-in function erf&gt;, 'erfc': &lt;built-in function erfc&gt;, 'exp': &lt;built-in function exp&gt;, 'expm1': &lt;built-in function expm1&gt;, 'fabs': &lt;built-in function fabs&gt;, 'factorial': &lt;built-in function factorial&gt;, 'floor': &lt;built-in function floor&gt;, 'fmod': &lt;built-in function fmod&gt;, 'frexp': &lt;built-in function frexp&gt;, 'fsum': &lt;built-in function fsum&gt;, 'gamma': &lt;built-in function gamma&gt;, 'gcd': &lt;built-in function gcd&gt;, 'hypot': &lt;built-in function hypot&gt;, 'inf': inf, 'isclose': &lt;built-in function isclose&gt;, 'isfinite': &lt;built-in function isfinite&gt;, 'isinf': &lt;built-in function isinf&gt;, 'isnan': &lt;built-in function isnan&gt;, 'ldexp': &lt;built-in function ldexp&gt;, 'lgamma': &lt;built-in function lgamma&gt;, 'log': &lt;built-in function log&gt;, 'log10': &lt;built-in function log10&gt;, 'log1p': &lt;built-in function log1p&gt;, 'log2': &lt;built-in function log2&gt;, 'modf': &lt;built-in function modf&gt;, 'nan': nan, 'pi': 3.141592653589793, 'pow': &lt;built-in function pow&gt;, 'radians': &lt;built-in function radians&gt;, 'sin': &lt;built-in function sin&gt;, 'sinh': &lt;built-in function sinh&gt;, 'sqrt': &lt;built-in function sqrt&gt;, 'tan': &lt;built-in function tan&gt;, 'tanh': &lt;built-in function tanh&gt;, 'tau': 6.283185307179586, 'trunc': &lt;built-in function trunc&gt;}</em></dt>
<dd><p>list of math functions for use in evaluating parameters</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.build_math_context">
<code class="descclassname">sasmodels.compare.</code><code class="descname">build_math_context</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#build_math_context"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>build dictionary of functions from math module</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.columnize">
<code class="descclassname">sasmodels.compare.</code><code class="descname">columnize</code><span class="sig-paren">(</span><em>items</em>, <em>indent=''</em>, <em>width=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#columnize"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Format a list of strings into columns.</p>
<p>Returns a string with carriage returns ready for printing.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.compare">
<code class="descclassname">sasmodels.compare.</code><code class="descname">compare</code><span class="sig-paren">(</span><em>opts</em>, <em>limits=None</em>, <em>maxdim=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#compare"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Preform a comparison using options from the command line.</p>
<p><em>limits</em> are the display limits on the graph, either to set the y-axis
for 1D or to set the colormap scale for 2D.  If None, then they are
inferred from the data and returned. When exploring using Bumps,
the limits are set when the model is initially called, and maintained
as the values are adjusted, making it easier to see the effects of the
parameters.</p>
<p><em>maxdim</em> <strong>DEPRECATED</strong> Use opts[‘maxdim’] instead.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.constrain_pars">
<code class="descclassname">sasmodels.compare.</code><code class="descname">constrain_pars</code><span class="sig-paren">(</span><em>model_info</em>, <em>pars</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#constrain_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Restrict parameters to valid values.</p>
<p>This includes model specific code for models such as capped_cylinder
which need to support within model constraints (cap radius more than
cylinder radius in this case).</p>
<p>Warning: this updates the <em>pars</em> dictionary in place.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.delay">
<code class="descclassname">sasmodels.compare.</code><code class="descname">delay</code><span class="sig-paren">(</span><em>dt</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#delay"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return number date-time delta as number seconds</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.eval_ctypes">
<code class="descclassname">sasmodels.compare.</code><code class="descname">eval_ctypes</code><span class="sig-paren">(</span><em>model_info</em>, <em>data</em>, <em>dtype='double'</em>, <em>cutoff=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#eval_ctypes"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a model calculator using the DLL calculation engine.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.eval_opencl">
<code class="descclassname">sasmodels.compare.</code><code class="descname">eval_opencl</code><span class="sig-paren">(</span><em>model_info</em>, <em>data</em>, <em>dtype='single'</em>, <em>cutoff=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#eval_opencl"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a model calculator using the OpenCL calculation engine.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.explore">
<code class="descclassname">sasmodels.compare.</code><code class="descname">explore</code><span class="sig-paren">(</span><em>opts</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#explore"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>explore the model using the bumps gui.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.get_pars">
<code class="descclassname">sasmodels.compare.</code><code class="descname">get_pars</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#get_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Extract default parameters from the model definition.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.isnumber">
<code class="descclassname">sasmodels.compare.</code><code class="descname">isnumber</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#isnumber"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return True if string contains an int or float</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.limit_dimensions">
<code class="descclassname">sasmodels.compare.</code><code class="descname">limit_dimensions</code><span class="sig-paren">(</span><em>model_info</em>, <em>pars</em>, <em>maxdim</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#limit_dimensions"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Limit parameters of units of Ang to maxdim.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.main">
<code class="descclassname">sasmodels.compare.</code><code class="descname">main</code><span class="sig-paren">(</span><em>*argv</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#main"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Main program.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.make_data">
<code class="descclassname">sasmodels.compare.</code><code class="descname">make_data</code><span class="sig-paren">(</span><em>opts</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#make_data"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate an empty dataset, used with the model to set Q points
and resolution.</p>
<p><em>opts</em> contains the options, with ‘qmax’, ‘nq’, ‘res’,
‘accuracy’, ‘is2d’ and ‘view’ parsed from the command line.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.make_engine">
<code class="descclassname">sasmodels.compare.</code><code class="descname">make_engine</code><span class="sig-paren">(</span><em>model_info</em>, <em>data</em>, <em>dtype</em>, <em>cutoff</em>, <em>ngauss=0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#make_engine"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate the appropriate calculation engine for the given datatype.</p>
<p>Datatypes with ‘!’ appended are evaluated using external C DLLs rather
than OpenCL.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.parameter_range">
<code class="descclassname">sasmodels.compare.</code><code class="descname">parameter_range</code><span class="sig-paren">(</span><em>p</em>, <em>v</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#parameter_range"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Choose a parameter range based on parameter name and initial value.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.parlist">
<code class="descclassname">sasmodels.compare.</code><code class="descname">parlist</code><span class="sig-paren">(</span><em>model_info</em>, <em>pars</em>, <em>is2d</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#parlist"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Format the parameter list for printing.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.parse_opts">
<code class="descclassname">sasmodels.compare.</code><code class="descname">parse_opts</code><span class="sig-paren">(</span><em>argv</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#parse_opts"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Parse command line options.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.parse_pars">
<code class="descclassname">sasmodels.compare.</code><code class="descname">parse_pars</code><span class="sig-paren">(</span><em>opts</em>, <em>maxdim=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#parse_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate parameter sets for base and comparison models.</p>
<p>Returns a pair of parameter dictionaries.</p>
<p>The default parameter values come from the model, or a randomized model
if a seed value is given.  Next, evaluate any parameter expressions,
constraining the value of the parameter within and between models.</p>
<p>Note: When generating random parameters, <strong>the seed must already be set</strong>
with a call to <em>np.random.seed(opts[‘seed’])</em>.</p>
<p><em>opts</em> controls the parameter generation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">model_info</span> <span class="mi">1</span><span class="p">,</span> <span class="n">model_info</span> <span class="mi">2</span><span class="p">),</span>
    <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>         <span class="c1"># if seed&gt;=0 then randomize parameters</span>
    <span class="s1">&#39;mono&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>      <span class="c1"># force monodisperse random parameters</span>
    <span class="s1">&#39;magnetic&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># force nonmagetic random parameters</span>
    <span class="s1">&#39;maxdim&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>   <span class="c1"># limit particle size to maxdim for random pars</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;par=expr&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>  <span class="c1"># override parameter values in model</span>
    <span class="s1">&#39;show_pars&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="c1"># Show parameter values</span>
    <span class="s1">&#39;is2d&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>      <span class="c1"># Show values for orientation parameters</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The values of <em>par=expr</em> are evaluated approximately as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">parameter_set</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">parameter_set</span><span class="o">.</span><span class="n">par</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</pre></div>
</div>
<p>That is, you can use arbitrary python math expressions including the
functions defined in the math library and the numpy library.  You can
also use the existing parameter values, which will either be the model
defaults or the randomly generated values if seed is non-negative.</p>
<p>To compare different values of the same parameter, use <em>par=expr,expr</em>.
The first parameter set will have the values from the first expression
and the second parameter set will have the values from the second
expression.  Note that the second expression is evaluated using the
values from the first expression, which allows things like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">radius</span><span class="p">,</span><span class="n">length</span><span class="o">+</span><span class="mi">3</span>
</pre></div>
</div>
<p>which will compare length to length+3 when length is set to 2*radius.</p>
<p><em>maxdim</em> <strong>DEPRECATED</strong> Use <em>opts[‘maxdim’]</em> instead.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.plot_models">
<code class="descclassname">sasmodels.compare.</code><code class="descname">plot_models</code><span class="sig-paren">(</span><em>opts</em>, <em>result</em>, <em>limits=None</em>, <em>setnum=0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#plot_models"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Plot the results from <code class="xref py py-func docutils literal notranslate"><span class="pre">run_model()</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.plot_profile">
<code class="descclassname">sasmodels.compare.</code><code class="descname">plot_profile</code><span class="sig-paren">(</span><em>model_info</em>, <em>label='base'</em>, <em>**args</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#plot_profile"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Plot the profile returned by the model profile method.</p>
<p><em>model_info</em> defines model parameters, etc.</p>
<p><em>mesh</em> is a list of tuples containing (<em>value</em>, <em>dispersity</em>, <em>weights</em>)
for each parameter, where (<em>dispersity</em>, <em>weights</em>) pairs are the
distributions to be plotted.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.print_models">
<code class="descclassname">sasmodels.compare.</code><code class="descname">print_models</code><span class="sig-paren">(</span><em>kind=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#print_models"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Print the list of available models in columns.</p>
</dd></dl>

<dl class="class">
<dt id="sasmodels.compare.push_seed">
<em class="property">class </em><code class="descclassname">sasmodels.compare.</code><code class="descname">push_seed</code><span class="sig-paren">(</span><em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#push_seed"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Set the seed value for the random number generator.</p>
<p>When used in a with statement, the random number generator state is
restored after the with statement is complete.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt><em>seed</em> <span class="classifier-delimiter">:</span> <span class="classifier">int or array_like, optional</span></dt>
<dd>Seed for RandomState</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Seed can be used directly to set the seed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="k">import</span> <span class="n">randint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">push_seed</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="go">&lt;...push_seed object at...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000000</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[242082    899 211136]</span>
</pre></div>
</div>
<p>Seed can also be used in a with statement, which sets the random
number generator state for the enclosed computations and restores
it to the previous state on completion:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">push_seed</span><span class="p">(</span><span class="mi">24</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000000</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[242082    899 211136]</span>
</pre></div>
</div>
<p>Using nested contexts, we can demonstrate that state is indeed
restored after the block completes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">push_seed</span><span class="p">(</span><span class="mi">24</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000000</span><span class="p">))</span>
<span class="gp">... </span>   <span class="k">with</span> <span class="n">push_seed</span><span class="p">(</span><span class="mi">24</span><span class="p">):</span>
<span class="gp">... </span>       <span class="nb">print</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000000</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000000</span><span class="p">))</span>
<span class="go">242082</span>
<span class="go">[242082    899 211136]</span>
<span class="go">899</span>
</pre></div>
</div>
<p>The restore step is protected against exceptions in the block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">push_seed</span><span class="p">(</span><span class="mi">24</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000000</span><span class="p">))</span>
<span class="gp">... </span>   <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>       <span class="k">with</span> <span class="n">push_seed</span><span class="p">(</span><span class="mi">24</span><span class="p">):</span>
<span class="gp">... </span>           <span class="nb">print</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000000</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">... </span>           <span class="k">raise</span> <span class="ne">Exception</span><span class="p">()</span>
<span class="gp">... </span>   <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="gp">... </span>       <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exception raised&quot;</span><span class="p">)</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000000</span><span class="p">))</span>
<span class="go">242082</span>
<span class="go">[242082    899 211136]</span>
<span class="go">Exception raised</span>
<span class="go">899</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.randomize_pars">
<code class="descclassname">sasmodels.compare.</code><code class="descname">randomize_pars</code><span class="sig-paren">(</span><em>model_info</em>, <em>pars</em>, <em>maxdim=inf</em>, <em>is2d=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#randomize_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate random values for all of the parameters.</p>
<p>Valid ranges for the random number generator are guessed from the name of
the parameter; this will not account for constraints such as cap radius
greater than cylinder radius in the capped_cylinder model, so
<a class="reference internal" href="#sasmodels.compare.constrain_pars" title="sasmodels.compare.constrain_pars"><code class="xref py py-func docutils literal notranslate"><span class="pre">constrain_pars()</span></code></a> needs to be called afterward..</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.run_models">
<code class="descclassname">sasmodels.compare.</code><code class="descname">run_models</code><span class="sig-paren">(</span><em>opts</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#run_models"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Process a parameter set, return calculation results and times.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.set_beam_stop">
<code class="descclassname">sasmodels.compare.</code><code class="descname">set_beam_stop</code><span class="sig-paren">(</span><em>data</em>, <em>radius</em>, <em>outer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#set_beam_stop"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Add a beam stop of the given <em>radius</em>.  If <em>outer</em>, make an annulus.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.set_spherical_integration_parameters">
<code class="descclassname">sasmodels.compare.</code><code class="descname">set_spherical_integration_parameters</code><span class="sig-paren">(</span><em>opts</em>, <em>steps</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#set_spherical_integration_parameters"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Set integration parameters for spherical integration over the entire
surface in theta-phi coordinates.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.show_docs">
<code class="descclassname">sasmodels.compare.</code><code class="descname">show_docs</code><span class="sig-paren">(</span><em>opts</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#show_docs"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>show html docs for the model</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.suppress_magnetism">
<code class="descclassname">sasmodels.compare.</code><code class="descname">suppress_magnetism</code><span class="sig-paren">(</span><em>pars</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#suppress_magnetism"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Complete eliminate magnetism of the model to test models more quickly.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.suppress_pd">
<code class="descclassname">sasmodels.compare.</code><code class="descname">suppress_pd</code><span class="sig-paren">(</span><em>pars</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#suppress_pd"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Complete eliminate polydispersity of the model to test models more quickly.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.tic">
<code class="descclassname">sasmodels.compare.</code><code class="descname">tic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#tic"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Timer function.</p>
<p>Use “toc=tic()” to start the clock and “toc()” to measure
a time interval.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare.time_calculation">
<code class="descclassname">sasmodels.compare.</code><code class="descname">time_calculation</code><span class="sig-paren">(</span><em>calculator</em>, <em>pars</em>, <em>evals=1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare.html#time_calculation"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute the average calculation time over N evaluations.</p>
<p>An additional call is generated without polydispersity in order to
initialize the calculation engine, and make the average more stable.</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-sasmodels.compare_many">
<span id="sasmodels-compare-many-module"></span><h2>sasmodels.compare_many module</h2>
<p>Program to compare results from many random parameter sets for a given model.</p>
<p>The result is a comma separated value (CSV) table that can be redirected
from standard output into a file and loaded into a spreadsheet.</p>
<p>The models are compared for each parameter set and if the difference is
greater than expected for that precision, the parameter set is labeled
as bad and written to the output, along with the random seed used to
generate that parameter value.  This seed can be used with <code class="xref py py-mod docutils literal notranslate"><span class="pre">compare</span></code>
to reload and display the details of the model.</p>
<dl class="function">
<dt id="sasmodels.compare_many.calc_stats">
<code class="descclassname">sasmodels.compare_many.</code><code class="descname">calc_stats</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>index</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare_many.html#calc_stats"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Calculate statistics between the target value and the computed value.</p>
<p><em>target</em> and <em>value</em> are the vectors being compared, with the
difference normalized by <em>target</em> to get relative error.  Only
the elements listed in <em>index</em> are used, though index may be
and empty slice defined by <em>slice(None, None)</em>.</p>
<p>Returns:</p>
<blockquote>
<div><p><em>maxrel</em> the maximum relative difference</p>
<p><em>rel95</em> the relative difference with the 5% biggest differences ignored</p>
<p><em>maxabs</em> the maximum absolute difference for the 5% biggest differences</p>
<p><em>maxval</em> the maximum value for the 5% biggest differences</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare_many.compare_instance">
<code class="descclassname">sasmodels.compare_many.</code><code class="descname">compare_instance</code><span class="sig-paren">(</span><em>name</em>, <em>data</em>, <em>index</em>, <em>N=1</em>, <em>mono=True</em>, <em>cutoff=1e-05</em>, <em>base='single'</em>, <em>comp='double'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare_many.html#compare_instance"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compare the model under different calculation engines.</p>
<p><em>name</em> is the name of the model.</p>
<p><em>data</em> is the data object giving <span class="math notranslate nohighlight">\(q, \Delta q\)</span> calculation points.</p>
<p><em>index</em> is the active set of points.</p>
<p><em>N</em> is the number of comparisons to make.</p>
<p><em>cutoff</em> is the polydispersity weight cutoff to make the calculation
a little bit faster.</p>
<p><em>base</em> and <em>comp</em> are the names of the calculation engines to compare.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare_many.main">
<code class="descclassname">sasmodels.compare_many.</code><code class="descname">main</code><span class="sig-paren">(</span><em>argv</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare_many.html#main"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Main program.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare_many.print_column_headers">
<code class="descclassname">sasmodels.compare_many.</code><code class="descname">print_column_headers</code><span class="sig-paren">(</span><em>pars</em>, <em>parts</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare_many.html#print_column_headers"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate column headers for the differences and for the parameters,
and print them to standard output.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare_many.print_help">
<code class="descclassname">sasmodels.compare_many.</code><code class="descname">print_help</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare_many.html#print_help"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Print usage string, the option description and the list of available models.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.compare_many.print_usage">
<code class="descclassname">sasmodels.compare_many.</code><code class="descname">print_usage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/compare_many.html#print_usage"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Print the command usage string.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.conversion_table">
<span id="sasmodels-conversion-table-module"></span><h2>sasmodels.conversion_table module</h2>
<p>Parameter conversion table</p>
<p><em>CONVERSION_TABLE</em> gives the old model name and a dictionary of old parameter
names for each parameter in sasmodels.  This is used by <code class="xref py py-mod docutils literal notranslate"><span class="pre">convert</span></code> to
determine the equivalent parameter set when comparing a sasmodels model to
the models defined in previous versions of SasView and sasmodels. This is now
versioned based on the version number of SasView.</p>
<p>When any sasmodels parameter or model name is changed, this must be modified to
account for that.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">old_Sasview_version</span><span class="o">&gt;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="o">&lt;</span><span class="n">new_model_name</span><span class="o">&gt;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="o">&lt;</span><span class="n">old_model_name</span><span class="o">&gt;</span> <span class="p">,</span>
        <span class="p">{</span>
            <span class="o">&lt;</span><span class="n">new_param_name_1</span><span class="o">&gt;</span> <span class="p">:</span> <span class="o">&lt;</span><span class="n">old_param_name_1</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="o">...</span>
            <span class="o">&lt;</span><span class="n">new_param_name_n</span><span class="o">&gt;</span> <span class="p">:</span> <span class="o">&lt;</span><span class="n">old_param_name_n</span><span class="o">&gt;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Any future parameter and model name changes can and should be given in this
table for future compatibility.</p>
</div>
<div class="section" id="module-sasmodels.convert">
<span id="sasmodels-convert-module"></span><h2>sasmodels.convert module</h2>
<p>Convert models to and from sasview.</p>
<dl class="function">
<dt id="sasmodels.convert.constrain_new_to_old">
<code class="descclassname">sasmodels.convert.</code><code class="descname">constrain_new_to_old</code><span class="sig-paren">(</span><em>model_info</em>, <em>pars</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/convert.html#constrain_new_to_old"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Restrict parameter values to those that will match sasview.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.convert.convert_model">
<code class="descclassname">sasmodels.convert.</code><code class="descname">convert_model</code><span class="sig-paren">(</span><em>name</em>, <em>pars</em>, <em>use_underscore=False</em>, <em>model_version=(3</em>, <em>1</em>, <em>2)</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/convert.html#convert_model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert model from old style parameter names to new style.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.convert.revert_name">
<code class="descclassname">sasmodels.convert.</code><code class="descname">revert_name</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/convert.html#revert_name"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Translate model name back to the name used in SasView 3.x</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.convert.revert_pars">
<code class="descclassname">sasmodels.convert.</code><code class="descname">revert_pars</code><span class="sig-paren">(</span><em>model_info</em>, <em>pars</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/convert.html#revert_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert model from new style parameter names to old style.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.convert.test_backward_forward">
<code class="descclassname">sasmodels.convert.</code><code class="descname">test_backward_forward</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/convert.html#test_backward_forward"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Test conversion of model parameters from 4.x to 3.x and back.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.core">
<span id="sasmodels-core-module"></span><h2>sasmodels.core module</h2>
<p>Core model handling routines.</p>
<dl class="function">
<dt id="sasmodels.core.list_models">
<code class="descclassname">sasmodels.core.</code><code class="descname">list_models</code><span class="sig-paren">(</span><em>kind=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/core.html#list_models"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the list of available models on the model path.</p>
<p><em>kind</em> can be one of the following:</p>
<blockquote>
<div><ul class="simple">
<li>all: all models</li>
<li>py: python models only</li>
<li>c: c models only</li>
<li>single: c models which support single precision</li>
<li>double: c models which require double precision</li>
<li>opencl: c models which run in opencl</li>
<li>dll: c models which do not run in opencl</li>
<li>1d: models without orientation</li>
<li>2d: models with orientation</li>
<li>magnetic: models supporting magnetic sld</li>
<li>nommagnetic: models without magnetic parameter</li>
</ul>
</div></blockquote>
<p>For multiple conditions, combine with plus.  For example, <em>c+single+2d</em>
would return all oriented models implemented in C which can be computed
accurately with single precision arithmetic.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.core.load_model">
<code class="descclassname">sasmodels.core.</code><code class="descname">load_model</code><span class="sig-paren">(</span><em>model_name</em>, <em>dtype=None</em>, <em>platform='ocl'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/core.html#load_model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load model info and build model.</p>
<p><em>model_name</em> is the name of the model, or perhaps a model expression
such as sphere*hardsphere or sphere+cylinder.</p>
<p><em>dtype</em> and <em>platform</em> are given by <a class="reference internal" href="#sasmodels.core.build_model" title="sasmodels.core.build_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_model()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.core.load_model_info">
<code class="descclassname">sasmodels.core.</code><code class="descname">load_model_info</code><span class="sig-paren">(</span><em>model_string</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/core.html#load_model_info"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load a model definition given the model name.</p>
<p><em>model_string</em> is the name of the model, or perhaps a model expression
such as sphere*cylinder or sphere+cylinder. Use ‘&#64;’ for a structure
factor product, e.g. <a class="reference external" href="mailto:sphere&#37;&#52;&#48;hardsphere">sphere<span>&#64;</span>hardsphere</a>. Custom models can be specified by
prefixing the model name with ‘custom.’, e.g. ‘custom.MyModel+sphere’.</p>
<p>This returns a handle to the module defining the model.  This can be
used with functions in generate to build the docs or extract model info.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.core.build_model">
<code class="descclassname">sasmodels.core.</code><code class="descname">build_model</code><span class="sig-paren">(</span><em>model_info</em>, <em>dtype=None</em>, <em>platform='ocl'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/core.html#build_model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Prepare the model for the default execution platform.</p>
<p>This will return an OpenCL model, a DLL model or a python model depending
on the model and the computing platform.</p>
<p><em>model_info</em> is the model definition structure returned from
<a class="reference internal" href="#sasmodels.core.load_model_info" title="sasmodels.core.load_model_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_model_info()</span></code></a>.</p>
<p><em>dtype</em> indicates whether the model should use single or double precision
for the calculation.  Choices are ‘single’, ‘double’, ‘quad’, ‘half’,
or ‘fast’.  If <em>dtype</em> ends with ‘!’, then force the use of the DLL rather
than OpenCL for the calculation.</p>
<p><em>platform</em> should be “dll” to force the dll to be used for C models,
otherwise it uses the default “ocl”.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.core.precompile_dlls">
<code class="descclassname">sasmodels.core.</code><code class="descname">precompile_dlls</code><span class="sig-paren">(</span><em>path</em>, <em>dtype='double'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/core.html#precompile_dlls"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Precompile the dlls for all builtin models, returning a list of dll paths.</p>
<p><em>path</em> is the directory in which to save the dlls.  It will be created if
it does not already exist.</p>
<p>This can be used when build the windows distribution of sasmodels
which may be missing the OpenCL driver and the dll compiler.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.data">
<span id="sasmodels-data-module"></span><h2>sasmodels.data module</h2>
<p>SAS data representations.</p>
<p>Plotting functions for data sets:</p>
<blockquote>
<div><p><a class="reference internal" href="#sasmodels.data.plot_data" title="sasmodels.data.plot_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_data()</span></code></a> plots the data file.</p>
<p><a class="reference internal" href="#sasmodels.data.plot_theory" title="sasmodels.data.plot_theory"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_theory()</span></code></a> plots a calculated result from the model.</p>
</div></blockquote>
<p>Wrappers for the sasview data loader and data manipulations:</p>
<blockquote>
<div><p><a class="reference internal" href="#sasmodels.data.load_data" title="sasmodels.data.load_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_data()</span></code></a> loads a sasview data file.</p>
<p><a class="reference internal" href="#sasmodels.data.set_beam_stop" title="sasmodels.data.set_beam_stop"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_beam_stop()</span></code></a> masks the beam stop from the data.</p>
<p><a class="reference internal" href="#sasmodels.data.set_half" title="sasmodels.data.set_half"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_half()</span></code></a> selects the right or left half of the data, which can
be useful for shear measurements which have not been properly corrected
for path length and reflections.</p>
<p><a class="reference internal" href="#sasmodels.data.set_top" title="sasmodels.data.set_top"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_top()</span></code></a> cuts the top part off the data.</p>
</div></blockquote>
<p>Empty data sets for evaluating models without data:</p>
<blockquote>
<div><p><a class="reference internal" href="#sasmodels.data.empty_data1D" title="sasmodels.data.empty_data1D"><code class="xref py py-func docutils literal notranslate"><span class="pre">empty_data1D()</span></code></a> creates an empty dataset, which is useful for plotting
a theory function before the data is measured.</p>
<p><a class="reference internal" href="#sasmodels.data.empty_data2D" title="sasmodels.data.empty_data2D"><code class="xref py py-func docutils literal notranslate"><span class="pre">empty_data2D()</span></code></a> creates an empty 2D dataset.</p>
</div></blockquote>
<p>Note that the empty datasets use a minimal representation of the SasView
objects so that models can be run without SasView on the path.  You could
also use these for your own data loader.</p>
<dl class="class">
<dt id="sasmodels.data.Data1D">
<em class="property">class </em><code class="descclassname">sasmodels.data.</code><code class="descname">Data1D</code><span class="sig-paren">(</span><em>x=None</em>, <em>y=None</em>, <em>dx=None</em>, <em>dy=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#Data1D"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>1D data object.</p>
<p>Note that this definition matches the attributes from sasview, with
some generic 1D data vectors and some SAS specific definitions.  Some
refactoring to allow consistent naming conventions between 1D, 2D and
SESANS data would be helpful.</p>
<p><strong>Attributes</strong></p>
<p><em>x</em>, <em>dx</em>: <span class="math notranslate nohighlight">\(q\)</span> vector and gaussian resolution</p>
<p><em>y</em>, <em>dy</em>: <span class="math notranslate nohighlight">\(I(q)\)</span> vector and measurement uncertainty</p>
<p><em>mask</em>: values to include in plotting/analysis</p>
<p><em>dxl</em>: slit widths for slit smeared data, with <em>dx</em> ignored</p>
<p><em>qmin</em>, <em>qmax</em>: range of <span class="math notranslate nohighlight">\(q\)</span> values in <em>x</em></p>
<p><em>filename</em>: label for the data line</p>
<p><em>_xaxis</em>, <em>_xunit</em>: label and units for the <em>x</em> axis</p>
<p><em>_yaxis</em>, <em>_yunit</em>: label and units for the <em>y</em> axis</p>
<dl class="method">
<dt id="sasmodels.data.Data1D.xaxis">
<code class="descname">xaxis</code><span class="sig-paren">(</span><em>label</em>, <em>unit</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#Data1D.xaxis"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>set the x axis label and unit</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.data.Data1D.yaxis">
<code class="descname">yaxis</code><span class="sig-paren">(</span><em>label</em>, <em>unit</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#Data1D.yaxis"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>set the y axis label and unit</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.data.Data2D">
<em class="property">class </em><code class="descclassname">sasmodels.data.</code><code class="descname">Data2D</code><span class="sig-paren">(</span><em>x=None</em>, <em>y=None</em>, <em>z=None</em>, <em>dx=None</em>, <em>dy=None</em>, <em>dz=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#Data2D"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>2D data object.</p>
<p>Note that this definition matches the attributes from sasview. Some
refactoring to allow consistent naming conventions between 1D, 2D and
SESANS data would be helpful.</p>
<p><strong>Attributes</strong></p>
<p><em>qx_data</em>, <em>dqx_data</em>: <span class="math notranslate nohighlight">\(q_x\)</span> matrix and gaussian resolution</p>
<p><em>qy_data</em>, <em>dqy_data</em>: <span class="math notranslate nohighlight">\(q_y\)</span> matrix and gaussian resolution</p>
<p><em>data</em>, <em>err_data</em>: <span class="math notranslate nohighlight">\(I(q)\)</span> matrix and measurement uncertainty</p>
<p><em>mask</em>: values to exclude from plotting/analysis</p>
<p><em>qmin</em>, <em>qmax</em>: range of <span class="math notranslate nohighlight">\(q\)</span> values in <em>x</em></p>
<p><em>filename</em>: label for the data line</p>
<p><em>_xaxis</em>, <em>_xunit</em>: label and units for the <em>x</em> axis</p>
<p><em>_yaxis</em>, <em>_yunit</em>: label and units for the <em>y</em> axis</p>
<p><em>_zaxis</em>, <em>_zunit</em>: label and units for the <em>y</em> axis</p>
<p><em>Q_unit</em>, <em>I_unit</em>: units for Q and intensity</p>
<p><em>x_bins</em>, <em>y_bins</em>: grid steps in <em>x</em> and <em>y</em> directions</p>
<dl class="method">
<dt id="sasmodels.data.Data2D.xaxis">
<code class="descname">xaxis</code><span class="sig-paren">(</span><em>label</em>, <em>unit</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#Data2D.xaxis"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>set the x axis label and unit</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.data.Data2D.yaxis">
<code class="descname">yaxis</code><span class="sig-paren">(</span><em>label</em>, <em>unit</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#Data2D.yaxis"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>set the y axis label and unit</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.data.Data2D.zaxis">
<code class="descname">zaxis</code><span class="sig-paren">(</span><em>label</em>, <em>unit</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#Data2D.zaxis"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>set the y axis label and unit</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.data.Detector">
<em class="property">class </em><code class="descclassname">sasmodels.data.</code><code class="descname">Detector</code><span class="sig-paren">(</span><em>pixel_size=(None</em>, <em>None)</em>, <em>distance=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#Detector"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Detector attributes.</p>
</dd></dl>

<dl class="class">
<dt id="sasmodels.data.Sample">
<em class="property">class </em><code class="descclassname">sasmodels.data.</code><code class="descname">Sample</code><a class="reference internal" href="../../_modules/sasmodels/data.html#Sample"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Sample attributes.</p>
</dd></dl>

<dl class="class">
<dt id="sasmodels.data.SesansData">
<em class="property">class </em><code class="descclassname">sasmodels.data.</code><code class="descname">SesansData</code><span class="sig-paren">(</span><em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#SesansData"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.data.Data1D" title="sasmodels.data.Data1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.data.Data1D</span></code></a></p>
<p>SESANS data object.</p>
<p>This is just <a class="reference internal" href="#sasmodels.data.Data1D" title="sasmodels.data.Data1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data1D</span></code></a> with a wavelength parameter.</p>
<p><em>x</em> is spin echo length and <em>y</em> is polarization (P/P0).</p>
<dl class="attribute">
<dt id="sasmodels.data.SesansData.isSesans">
<code class="descname">isSesans</code><em class="property"> = True</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.data.Source">
<em class="property">class </em><code class="descclassname">sasmodels.data.</code><code class="descname">Source</code><a class="reference internal" href="../../_modules/sasmodels/data.html#Source"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Beam attributes.</p>
</dd></dl>

<dl class="class">
<dt id="sasmodels.data.Vector">
<em class="property">class </em><code class="descclassname">sasmodels.data.</code><code class="descname">Vector</code><span class="sig-paren">(</span><em>x=None</em>, <em>y=None</em>, <em>z=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#Vector"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>3-space vector of <em>x</em>, <em>y</em>, <em>z</em></p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.data.demo">
<code class="descclassname">sasmodels.data.</code><code class="descname">demo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#demo"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load and plot a SAS dataset.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.data.empty_data1D">
<code class="descclassname">sasmodels.data.</code><code class="descname">empty_data1D</code><span class="sig-paren">(</span><em>q</em>, <em>resolution=0.0</em>, <em>L=0.0</em>, <em>dL=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#empty_data1D"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create empty 1D data using the given <em>q</em> as the x value.</p>
<p>rms <em>resolution</em> <span class="math notranslate nohighlight">\(\Delta q/q\)</span> defaults to 0%.  If wavelength <em>L</em> and rms
wavelength divergence <em>dL</em> are defined, then <em>resolution</em> defines
rms <span class="math notranslate nohighlight">\(\Delta \theta/\theta\)</span> for the lowest <em>q</em>, with <span class="math notranslate nohighlight">\(\theta\)</span> derived from
<span class="math notranslate nohighlight">\(q = 4\pi/\lambda \sin(\theta)\)</span>.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.data.empty_data2D">
<code class="descclassname">sasmodels.data.</code><code class="descname">empty_data2D</code><span class="sig-paren">(</span><em>qx</em>, <em>qy=None</em>, <em>resolution=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#empty_data2D"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create empty 2D data using the given mesh.</p>
<p>If <em>qy</em> is missing, create a square mesh with <em>qy=qx</em>.</p>
<p><em>resolution</em> dq/q defaults to 5%.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.data.load_data">
<code class="descclassname">sasmodels.data.</code><code class="descname">load_data</code><span class="sig-paren">(</span><em>filename</em>, <em>index=0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#load_data"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load data using a sasview loader.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.data.plot_data">
<code class="descclassname">sasmodels.data.</code><code class="descname">plot_data</code><span class="sig-paren">(</span><em>data</em>, <em>view=None</em>, <em>limits=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#plot_data"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Plot data loaded by the sasview loader.</p>
<p><em>data</em> is a sasview data object, either 1D, 2D or SESANS.</p>
<p><em>view</em> is log or linear.</p>
<p><em>limits</em> sets the intensity limits on the plot; if None then the limits
are inferred from the data.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.data.plot_theory">
<code class="descclassname">sasmodels.data.</code><code class="descname">plot_theory</code><span class="sig-paren">(</span><em>data</em>, <em>theory</em>, <em>resid=None</em>, <em>view=None</em>, <em>use_data=True</em>, <em>limits=None</em>, <em>Iq_calc=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#plot_theory"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Plot theory calculation.</p>
<p><em>data</em> is needed to define the graph properties such as labels and
units, and to define the data mask.</p>
<p><em>theory</em> is a matrix of the same shape as the data.</p>
<p><em>view</em> is log or linear</p>
<p><em>use_data</em> is True if the data should be plotted as well as the theory.</p>
<p><em>limits</em> sets the intensity limits on the plot; if None then the limits
are inferred from the data.</p>
<p><em>Iq_calc</em> is the raw theory values without resolution smearing</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.data.protect">
<code class="descclassname">sasmodels.data.</code><code class="descname">protect</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#protect"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Decorator to wrap calls in an exception trapper which prints the
exception and continues.  Keyboard interrupts are ignored.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.data.set_beam_stop">
<code class="descclassname">sasmodels.data.</code><code class="descname">set_beam_stop</code><span class="sig-paren">(</span><em>data</em>, <em>radius</em>, <em>outer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#set_beam_stop"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Add a beam stop of the given <em>radius</em>.  If <em>outer</em>, make an annulus.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.data.set_half">
<code class="descclassname">sasmodels.data.</code><code class="descname">set_half</code><span class="sig-paren">(</span><em>data</em>, <em>half</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#set_half"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Select half of the data, either “right” or “left”.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.data.set_top">
<code class="descclassname">sasmodels.data.</code><code class="descname">set_top</code><span class="sig-paren">(</span><em>data</em>, <em>cutoff</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/data.html#set_top"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Chop the top off the data, above <em>cutoff</em>.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.details">
<span id="sasmodels-details-module"></span><h2>sasmodels.details module</h2>
<div class="section" id="kernel-call-details">
<h3>Kernel Call Details</h3>
<p>When calling sas computational kernels with polydispersity there are a
number of details that need to be sent to the caller.  This includes the
list of polydisperse parameters, the number of points in the polydispersity
weight distribution, and which parameter is the “theta” parameter for
polar coordinate integration.  The <a class="reference internal" href="#sasmodels.details.CallDetails" title="sasmodels.details.CallDetails"><code class="xref py py-class docutils literal notranslate"><span class="pre">CallDetails</span></code></a> object maintains
this data.  Use <code class="xref py py-func docutils literal notranslate"><span class="pre">build_details()</span></code> to build a <em>details</em> object which
can be passed to one of the computational kernels.</p>
<dl class="class">
<dt id="sasmodels.details.CallDetails">
<em class="property">class </em><code class="descclassname">sasmodels.details.</code><code class="descname">CallDetails</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/details.html#CallDetails"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Manage the polydispersity information for the kernel call.</p>
<p>Conceptually, a polydispersity calculation is an integral over a mesh
in n-D space where n is the number of polydisperse parameters.  In order
to keep the program responsive, and not crash the GPU, only a portion
of the mesh is computed at a time.  Meshes with a large number of points
will therefore require many calls to the polydispersity loop.  Restarting
a nested loop in the middle requires that the indices of the individual
mesh dimensions can be computed for the current loop location.  This
is handled by the <em>pd_stride</em> vector, with n//stride giving the loop
index and n%stride giving the position in the sub loops.</p>
<p>One of the parameters may be the latitude.  When integrating in polar
coordinates, the total circumference decreases as latitude varies from
pi r^2 at the equator to 0 at the pole, and the weight associated
with a range of latitude values needs to be scaled by this circumference.
This scale factor needs to be updated each time the theta value
changes.  <em>theta_par</em> indicates which of the values in the parameter
vector is the latitude parameter, or -1 if there is no latitude
parameter in the model.  In practice, the normalization term cancels
if the latitude is not a polydisperse parameter.</p>
<dl class="attribute">
<dt id="sasmodels.details.CallDetails.num_active">
<code class="descname">num_active</code></dt>
<dd><p>Number of active polydispersity loops</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.details.CallDetails.num_eval">
<code class="descname">num_eval</code></dt>
<dd><p>Total size of the pd mesh</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.details.CallDetails.num_weights">
<code class="descname">num_weights</code></dt>
<dd><p>Total length of all the weight vectors</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.details.CallDetails.parts">
<code class="descname">parts</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.details.CallDetails.pd_length">
<code class="descname">pd_length</code></dt>
<dd><p>Number of weights for each polydisperse parameter</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.details.CallDetails.pd_offset">
<code class="descname">pd_offset</code></dt>
<dd><p>Offsets for the individual weight vectors in the set of weights</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.details.CallDetails.pd_par">
<code class="descname">pd_par</code></dt>
<dd><p>List of polydisperse parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.details.CallDetails.pd_stride">
<code class="descname">pd_stride</code></dt>
<dd><p>Stride in the pd mesh for each pd dimension</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.details.CallDetails.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>values=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/details.html#CallDetails.show"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Print the polydispersity call details to the console</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.details.CallDetails.theta_par">
<code class="descname">theta_par</code></dt>
<dd><p>Location of the theta parameter in the parameter vector</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.details.convert_magnetism">
<code class="descclassname">sasmodels.details.</code><code class="descname">convert_magnetism</code><span class="sig-paren">(</span><em>parameters</em>, <em>values</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/details.html#convert_magnetism"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert magnetism values from polar to rectangular coordinates.</p>
<p>Returns True if any magnetism is present.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.details.correct_theta_weights">
<code class="descclassname">sasmodels.details.</code><code class="descname">correct_theta_weights</code><span class="sig-paren">(</span><em>parameters</em>, <em>dispersity</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/details.html#correct_theta_weights"><span class="viewcode-link">[source]</span></a></dt>
<dd><p><strong>Deprecated</strong> Theta weights will be computed in the kernel wrapper if
they are needed.</p>
<p>If there is a theta parameter, update the weights of that parameter so that
the cosine weighting required for polar integration is preserved.</p>
<p>Avoid evaluation strictly at the pole, which would otherwise send the
weight to zero.  This is probably not a problem in practice (if dispersity
is +/- 90, then you probably should be using a 1-D model of the circular
average).</p>
<p>Note: scale and background parameters are not include in the tuples for
dispersity and weights, so index is parameters.theta_offset, not
parameters.theta_offset+2</p>
<p>Returns updated weights vectors</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.details.dispersion_mesh">
<code class="descclassname">sasmodels.details.</code><code class="descname">dispersion_mesh</code><span class="sig-paren">(</span><em>model_info</em>, <em>mesh</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/details.html#dispersion_mesh"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create a mesh grid of dispersion parameters and weights.</p>
<p><em>mesh</em> is a list of (value, dispersity, weights), where the values
are the individual parameter values, and (dispersity, weights) is
the distribution of parameter values.</p>
<p>Only the volume parameters should be included in this list.  Orientation
parameters do not affect the calculation of effective radius or volume
ratio.  This is convenient since it avoids the distinction between
value and dispersity that is present in orientation parameters but not
shape parameters.</p>
<p>Returns [p1,p2,…],w where pj is a vector of values for parameter j
and w is a vector containing the products for weights for each
parameter set in the vector.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.details.make_details">
<code class="descclassname">sasmodels.details.</code><code class="descname">make_details</code><span class="sig-paren">(</span><em>model_info</em>, <em>length</em>, <em>offset</em>, <em>num_weights</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/details.html#make_details"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a <a class="reference internal" href="#sasmodels.details.CallDetails" title="sasmodels.details.CallDetails"><code class="xref py py-class docutils literal notranslate"><span class="pre">CallDetails</span></code></a> object for a polydisperse calculation
of the model defined by <em>model_info</em>.  Polydispersity is defined by
the <em>length</em> of the polydispersity distribution for each parameter
and the <em>offset</em> of the distribution in the polydispersity array.
Monodisperse parameters should use a polydispersity length of one
with weight 1.0. <em>num_weights</em> is the total length of the polydispersity
array.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.details.make_kernel_args">
<code class="descclassname">sasmodels.details.</code><code class="descname">make_kernel_args</code><span class="sig-paren">(</span><em>kernel</em>, <em>mesh</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/details.html#make_kernel_args"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Converts (value, dispersity, weight) for each parameter into kernel pars.</p>
<p>Returns a CallDetails object indicating the polydispersity, a data object
containing the different values, and the magnetic flag indicating whether
any magnetic magnitudes are non-zero. Magnetic vectors (M0, phi, theta) are
converted to rectangular coordinates (mx, my, mz).</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-sasmodels.direct_model">
<span id="sasmodels-direct-model-module"></span><h2>sasmodels.direct_model module</h2>
<p>Class interface to the model calculator.</p>
<p>Calling a model is somewhat non-trivial since the functions called depend
on the data type.  For 1D data the <em>Iq</em> kernel needs to be called, for
2D data the <em>Iqxy</em> kernel needs to be called, and for SESANS data the
<em>Iq</em> kernel needs to be called followed by a Hankel transform.  Before
the kernel is called an appropriate <em>q</em> calculation vector needs to be
constructed.  This is not the simple <em>q</em> vector where you have measured
the data since the resolution calculation will require values beyond the
range of the measured data.  After the calculation the resolution calculator
must be called to return the predicted value for each measured data point.</p>
<p><a class="reference internal" href="#sasmodels.direct_model.DirectModel" title="sasmodels.direct_model.DirectModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DirectModel</span></code></a> is a callable object that takes <em>parameter=value</em>
keyword arguments and returns the appropriate theory values for the data.</p>
<p><a class="reference internal" href="#sasmodels.direct_model.DataMixin" title="sasmodels.direct_model.DataMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataMixin</span></code></a> does the real work of interpreting the data and calling
the model calculator.  This is used by <a class="reference internal" href="#sasmodels.direct_model.DirectModel" title="sasmodels.direct_model.DirectModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DirectModel</span></code></a>, which uses
direct parameter values and by <code class="xref py py-class docutils literal notranslate"><span class="pre">bumps_model.Experiment</span></code> which wraps
the parameter values in boxes so that the user can set fitting ranges, etc.
on the individual parameters and send the model to the Bumps optimizers.</p>
<dl class="class">
<dt id="sasmodels.direct_model.DataMixin">
<em class="property">class </em><code class="descclassname">sasmodels.direct_model.</code><code class="descname">DataMixin</code><a class="reference internal" href="../../_modules/sasmodels/direct_model.html#DataMixin"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>DataMixin captures the common aspects of evaluating a SAS model for a
particular data set, including calculating Iq and evaluating the
resolution function.  It is used in particular by <a class="reference internal" href="#sasmodels.direct_model.DirectModel" title="sasmodels.direct_model.DirectModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DirectModel</span></code></a>,
which evaluates a SAS model parameters as key word arguments to the
calculator method, and by <code class="xref py py-class docutils literal notranslate"><span class="pre">bumps_model.Experiment</span></code>, which wraps the
model and data for use with the Bumps fitting engine.  It is not
currently used by <code class="xref py py-class docutils literal notranslate"><span class="pre">sasview_model.SasviewModel</span></code> since this will
require a number of changes to SasView before we can do it.</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_interpret_data()</span></code> initializes the data structures necessary
to manage the calculations.  This sets attributes in the child class
such as <em>data_type</em> and <em>resolution</em>.</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_calc_theory()</span></code> evaluates the model at the given control values.</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_set_data()</span></code> sets the intensity data in the data object,
possibly with random noise added.  This is useful for simulating a
dataset with the results from <code class="xref py py-meth docutils literal notranslate"><span class="pre">_calc_theory()</span></code>.</p>
</dd></dl>

<dl class="class">
<dt id="sasmodels.direct_model.DirectModel">
<em class="property">class </em><code class="descclassname">sasmodels.direct_model.</code><code class="descname">DirectModel</code><span class="sig-paren">(</span><em>data</em>, <em>model</em>, <em>cutoff=1e-05</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/direct_model.html#DirectModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.direct_model.DataMixin" title="sasmodels.direct_model.DataMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.direct_model.DataMixin</span></code></a></p>
<p>Create a calculator object for a model.</p>
<p><em>data</em> is 1D SAS, 2D SAS or SESANS data</p>
<p><em>model</em> is a model calculator return from <code class="xref py py-func docutils literal notranslate"><span class="pre">generate.load_model()</span></code></p>
<p><em>cutoff</em> is the polydispersity weight cutoff.</p>
<dl class="method">
<dt id="sasmodels.direct_model.DirectModel.profile">
<code class="descname">profile</code><span class="sig-paren">(</span><em>**pars</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/direct_model.html#DirectModel.profile"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate a plottable profile.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.direct_model.DirectModel.simulate_data">
<code class="descname">simulate_data</code><span class="sig-paren">(</span><em>noise=None</em>, <em>**pars</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/direct_model.html#DirectModel.simulate_data"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate simulated data for the model.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.direct_model.call_Fq">
<code class="descclassname">sasmodels.direct_model.</code><code class="descname">call_Fq</code><span class="sig-paren">(</span><em>calculator</em>, <em>pars</em>, <em>cutoff=0.0</em>, <em>mono=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/direct_model.html#call_Fq"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Like <a class="reference internal" href="#sasmodels.direct_model.call_kernel" title="sasmodels.direct_model.call_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">call_kernel()</span></code></a>, but returning F, F^2, R_eff, V_shell, V_form/V_shell.</p>
<p>For solid objects V_shell is equal to V_form and the volume ratio is 1.</p>
<p>Use parameter <em>radius_effective_mode</em> to select the effective radius
calculation to use amongst the <em>radius_effective_modes</em> list given in the
model.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.direct_model.call_kernel">
<code class="descclassname">sasmodels.direct_model.</code><code class="descname">call_kernel</code><span class="sig-paren">(</span><em>calculator</em>, <em>pars</em>, <em>cutoff=0.0</em>, <em>mono=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/direct_model.html#call_kernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Call <em>kernel</em> returned from <em>model.make_kernel</em> with parameters <em>pars</em>.</p>
<p><em>cutoff</em> is the limiting value for the product of dispersion weights used
to perform the multidimensional dispersion calculation more quickly at a
slight cost to accuracy. The default value of <em>cutoff=0</em> integrates over
the entire dispersion cube.  Using <em>cutoff=1e-5</em> can be 50% faster, but
with an error of about 1%, which is usually less than the measurement
uncertainty.</p>
<p><em>mono</em> is True if polydispersity should be set to none on all parameters.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.direct_model.call_profile">
<code class="descclassname">sasmodels.direct_model.</code><code class="descname">call_profile</code><span class="sig-paren">(</span><em>model_info</em>, <em>pars=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/direct_model.html#call_profile"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns the profile <em>x, y, (xlabel, ylabel)</em> representing the model.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.direct_model.get_mesh">
<code class="descclassname">sasmodels.direct_model.</code><code class="descname">get_mesh</code><span class="sig-paren">(</span><em>model_info</em>, <em>values</em>, <em>dim='1d'</em>, <em>mono=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/direct_model.html#get_mesh"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Retrieve the dispersity mesh described by the parameter set.</p>
<p>Returns a list of <em>(value, dispersity, weights)</em> with one tuple for each
parameter in the model call parameters.  Inactive parameters return the
default value with a weight of 1.0.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.direct_model.main">
<code class="descclassname">sasmodels.direct_model.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/direct_model.html#main"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Program to evaluate a particular model at a set of q values.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.direct_model.test_reparameterize">
<code class="descclassname">sasmodels.direct_model.</code><code class="descname">test_reparameterize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/direct_model.html#test_reparameterize"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Check simple reparameterized models will load and build</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.exception">
<span id="sasmodels-exception-module"></span><h2>sasmodels.exception module</h2>
<p>Utility to add annotations to python exceptions.</p>
<dl class="exception">
<dt id="sasmodels.exception.WindowsError">
<em class="property">exception </em><code class="descclassname">sasmodels.exception.</code><code class="descname">WindowsError</code><a class="reference internal" href="../../_modules/sasmodels/exception.html#WindowsError"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Fake WindowsException when not on Windows.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.exception.annotate_exception">
<code class="descclassname">sasmodels.exception.</code><code class="descname">annotate_exception</code><span class="sig-paren">(</span><em>msg</em>, <em>exc=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/exception.html#annotate_exception"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Add an annotation to the current exception, which can then be forwarded
to the caller using a bare “raise” statement to raise the annotated
exception.  If the exception <em>exc</em> is provided, then that exception is the
one that is annotated, otherwise <em>sys.exc_info</em> is used.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="k">except</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">annotate_exception</span><span class="p">(</span><span class="s2">&quot;while accessing &#39;D&#39;&quot;</span><span class="p">)</span>
<span class="gp">... </span>   <span class="k">raise</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">&quot;hello while accessing &#39;D&#39;&quot;</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.generate">
<span id="sasmodels-generate-module"></span><h2>sasmodels.generate module</h2>
<p>SAS model constructor.</p>
<p>Small angle scattering models are defined by a set of kernel functions:</p>
<blockquote>
<div><p><em>Iq(q, p1, p2, …)</em> returns the scattering at q for a form with
particular dimensions averaged over all orientations.</p>
<p><em>Iqac(qab, qc, p1, p2, …)</em> returns the scattering at qab, qc
for a rotationally symmetric form with particular dimensions.
qab, qc are determined from shape orientation and scattering angles.
This call is used if the shape has orientation parameters theta and phi.</p>
<p><em>Iqabc(qa, qb, qc, p1, p2, …)</em> returns the scattering at qa, qb, qc
for a form with particular dimensions.  qa, qb, qc are determined from
shape orientation and scattering angles. This call is used if the shape
has orientation parameters theta, phi and psi.</p>
<p><em>Iqxy(qx, qy, p1, p2, …)</em> returns the scattering at qx, qy.  Use this
to create an arbitrary 2D theory function, needed for q-dependent
background functions and for models with non-uniform magnetism.</p>
<p><em>form_volume(p1, p2, …)</em> returns the volume of the form with particular
dimension, or 1.0 if no volume normalization is required.</p>
<p><em>shell_volume(p1, p2, …)</em> returns the volume of the shell for forms
which are hollow.</p>
<p><em>radius_effective(mode, p1, p2, …)</em> returns the effective radius of
the form with particular dimensions.  Mode determines the type of
effective radius returned, with mode=1 for equivalent volume.</p>
</div></blockquote>
<p>These functions are defined in a kernel module .py script and an associated
set of .c files.  The model constructor will use them to create models with
polydispersity across volume and orientation parameters, and provide
scale and background parameters for each model.</p>
<p>C code should be stylized C-99 functions written for OpenCL. All functions
need prototype declarations even if the are defined before they are used.
Although OpenCL supports <em>#include</em> preprocessor directives, the list of
includes should be given as part of the metadata in the kernel module
definition. The included files should be listed using a path relative to the
kernel module, or if using “lib/file.c” if it is one of the standard includes
provided with the sasmodels source. The includes need to be listed in order
so that functions are defined before they are used.</p>
<p>Floating point values should be declared as <em>double</em>.  For single precision
calculations, <em>double</em> will be replaced by <em>float</em>.  The single precision
conversion will also tag floating point constants with “f” to make them
single precision constants.  When using integral values in floating point
expressions, they should be expressed as floating point values by including
a decimal point.  This includes 0., 1. and 2.</p>
<p>OpenCL has a <em>sincos</em> function which can improve performance when both
the <em>sin</em> and <em>cos</em> values are needed for a particular argument.  Since
this function does not exist in C99, all use of <em>sincos</em> should be
replaced by the macro <em>SINCOS(value, sn, cn)</em> where <em>sn</em> and <em>cn</em> are
previously declared <em>double</em> variables.  When compiled for systems without
OpenCL, <em>SINCOS</em> will be replaced by <em>sin</em> and <em>cos</em> calls.   If <em>value</em> is
an expression, it will appear twice in this case; whether or not it will be
evaluated twice depends on the quality of the compiler.</p>
<p>The kernel module must set variables defining the kernel meta data:</p>
<blockquote>
<div><p><em>id</em> is an implicit variable formed from the filename.  It will be
a valid python identifier, and will be used as the reference into
the html documentation, with ‘_’ replaced by ‘-‘.</p>
<p><em>name</em> is the model name as displayed to the user.  If it is missing,
it will be constructed from the id.</p>
<p><em>title</em> is a short description of the model, suitable for a tool tip,
or a one line model summary in a table of models.</p>
<p><em>description</em> is an extended description of the model to be displayed
while the model parameters are being edited.</p>
<p><em>parameters</em> is the list of parameters.  Parameters in the kernel
functions must appear in the same order as they appear in the
parameters list.  Two additional parameters, <em>scale</em> and <em>background</em>
are added to the beginning of the parameter list.  They will show up
in the documentation as model parameters, but they are never sent to
the kernel functions.  Note that <em>effect_radius</em> and <em>volfraction</em>
must occur first in structure factor calculations.</p>
<p><em>category</em> is the default category for the model.  The category is
two level structure, with the form “group:section”, indicating where
in the manual the model will be located.  Models are alphabetical
within their section.</p>
<p><em>source</em> is the list of C-99 source files that must be joined to
create the OpenCL kernel functions.  The files defining the functions
need to be listed before the files which use the functions.</p>
<p><em>form_volume</em>, <em>Iq</em>, <em>Iqac</em>, <em>Iqabc</em> are strings containing
the C source code for the body of the volume, Iq, and Iqac functions
respectively.  These can also be defined in the last source file.</p>
<p><em>Iq</em>, <em>Iqac</em>, <em>Iqabc</em> also be instead be python functions defining the
kernel.  If they are marked as <em>Iq.vectorized = True</em> then the
kernel is passed the entire <em>q</em> vector at once, otherwise it is
passed values one <em>q</em> at a time.  The performance improvement of
this step is significant.</p>
<p><em>valid</em> expression that evaluates to True if the input parameters
are valid (e.g., “bell_radius &gt;= radius” for the barbell or capped
cylinder models).  The expression can call C functions, including
those defined in your model file.</p>
</div></blockquote>
<p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">modelinfo.ModelInfo</span></code> structure is constructed from the kernel meta
data and returned to the caller.</p>
<p>Valid inputs should be identified by the <em>valid</em> expression.
Particularly with polydispersity, there are some sets of shape parameters
which lead to nonsensical forms, such as a capped cylinder where the
cap radius is smaller than the cylinder radius.  The polydispersity
calculation will ignore these points, effectively chopping the
parameter weight distributions at the boundary of the infeasible region.
The resulting scattering will be set to background, even for models with
no polydispersity.  If the <em>valid</em> expression misses some parameter
combinations and they reach the kernel, the kernel should probably return
NaN rather than zero.  Even if the volume also evaluates to zero for
these parameters, the distribution weights are still accumulated and the
average volume calculation will be slightly off.</p>
<p>The doc string at the start of the kernel module will be used to
construct the model documentation web pages.  Embedded figures should
appear in the subdirectory “img” beside the model definition, and tagged
with the kernel module name to avoid collision with other models.  Some
file systems are case-sensitive, so only use lower case characters for
file names and extensions.</p>
<p>Code follows the C99 standard with the following extensions and conditions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M_PI_180</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
<span class="n">M_4PI_3</span> <span class="o">=</span> <span class="mi">4</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>
<span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="n">cube</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="n">sas_sinx_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="k">with</span> <span class="n">sin</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">1</span>
<span class="nb">all</span> <span class="n">double</span> <span class="n">precision</span> <span class="n">constants</span> <span class="n">must</span> <span class="n">include</span> <span class="n">the</span> <span class="n">decimal</span> <span class="n">point</span>
<span class="nb">all</span> <span class="n">double</span> <span class="n">declarations</span> <span class="n">may</span> <span class="n">be</span> <span class="n">converted</span> <span class="n">to</span> <span class="n">half</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="ow">or</span> <span class="n">long</span> <span class="n">double</span>
<span class="n">FLOAT_SIZE</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="nb">bytes</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">converted</span> <span class="n">variables</span>
</pre></div>
</div>
<p><a class="reference internal" href="#sasmodels.generate.load_kernel_module" title="sasmodels.generate.load_kernel_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_kernel_module()</span></code></a> loads the model definition file and
<code class="xref py py-func docutils literal notranslate"><span class="pre">modelinfo.make_model_info()</span></code> parses it. <a class="reference internal" href="#sasmodels.generate.make_source" title="sasmodels.generate.make_source"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_source()</span></code></a>
converts C-based model definitions to C source code, including the
polydispersity integral.  <a class="reference internal" href="#sasmodels.generate.model_sources" title="sasmodels.generate.model_sources"><code class="xref py py-func docutils literal notranslate"><span class="pre">model_sources()</span></code></a> returns the list of
source files the model depends on, and <code class="xref py py-func docutils literal notranslate"><span class="pre">timestamp()</span></code> returns
the latest time stamp amongst the source files (so you can check if
the model needs to be rebuilt).</p>
<p>The function <a class="reference internal" href="#sasmodels.generate.make_doc" title="sasmodels.generate.make_doc"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_doc()</span></code></a> extracts the doc string and adds the
parameter table to the top.  <em>make_figure</em> in <em>sasmodels/doc/genmodel</em>
creates the default figure for the model.  [These two sets of code
should mignrate into docs.py so docs can be updated in one place].</p>
<dl class="function">
<dt id="sasmodels.generate.contains_Fq">
<code class="descclassname">sasmodels.generate.</code><code class="descname">contains_Fq</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#contains_Fq"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return True if C source defines “void Fq(“.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.contains_shell_volume">
<code class="descclassname">sasmodels.generate.</code><code class="descname">contains_shell_volume</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#contains_shell_volume"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return True if C source defines “double shell_volume(“.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.convert_section_titles_to_boldface">
<code class="descclassname">sasmodels.generate.</code><code class="descname">convert_section_titles_to_boldface</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#convert_section_titles_to_boldface"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Use explicit bold-face rather than section headings so that the table of
contents is not polluted with section names from the model documentation.</p>
<p>Sections are identified as the title line followed by a line of punctuation
at least as long as the title line.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.convert_type">
<code class="descclassname">sasmodels.generate.</code><code class="descname">convert_type</code><span class="sig-paren">(</span><em>source</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#convert_type"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert code from double precision to the desired type.</p>
<p>Floating point constants are tagged with ‘f’ for single precision or ‘L’
for long double precision.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.demo_time">
<code class="descclassname">sasmodels.generate.</code><code class="descname">demo_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#demo_time"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Show how long it takes to process a model.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.dll_timestamp">
<code class="descclassname">sasmodels.generate.</code><code class="descname">dll_timestamp</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#dll_timestamp"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a timestamp for the model corresponding to the most recently
changed file or dependency.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.find_xy_mode">
<code class="descclassname">sasmodels.generate.</code><code class="descname">find_xy_mode</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#find_xy_mode"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the xy mode as qa, qac, qabc or qxy.</p>
<p>Note this is not a C parser, and so can be easily confused by
non-standard syntax.  Also, it will incorrectly identify the following
as having 2D models:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="n">double</span> <span class="n">Iqac</span><span class="p">(</span><span class="n">qab</span><span class="p">,</span> <span class="n">qc</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="n">fill</span> <span class="n">this</span> <span class="ow">in</span> <span class="n">later</span> <span class="o">...</span> <span class="p">}</span>
<span class="o">*/</span>
</pre></div>
</div>
<p>If you want to comment out the function, use // on the front of the
line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">//</span> <span class="n">double</span> <span class="n">Iqac</span><span class="p">(</span><span class="n">qab</span><span class="p">,</span> <span class="n">qc</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="n">fill</span> <span class="n">this</span> <span class="ow">in</span> <span class="n">later</span> <span class="o">...</span> <span class="p">}</span>
<span class="o">*/</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.format_units">
<code class="descclassname">sasmodels.generate.</code><code class="descname">format_units</code><span class="sig-paren">(</span><em>units</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#format_units"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert units into ReStructured Text format.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.get_data_path">
<code class="descclassname">sasmodels.generate.</code><code class="descname">get_data_path</code><span class="sig-paren">(</span><em>external_dir</em>, <em>target_file</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#get_data_path"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Search for the target file relative in the installed application.</p>
<p>Search first in the location of the generate module in case we are
running directly from the distribution.  Search next to the python
executable for windows installs.  Search in the ../Resources directory
next to the executable for Mac OS/X installs.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.indent">
<code class="descclassname">sasmodels.generate.</code><code class="descname">indent</code><span class="sig-paren">(</span><em>s</em>, <em>depth</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#indent"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Indent a string of text with <em>depth</em> additional spaces on each line.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.kernel_name">
<code class="descclassname">sasmodels.generate.</code><code class="descname">kernel_name</code><span class="sig-paren">(</span><em>model_info</em>, <em>variant</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#kernel_name"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Name of the exported kernel symbol.</p>
<p><em>variant</em> is “Iq”, “Iqxy” or “Imagnetic”.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.load_kernel_module">
<code class="descclassname">sasmodels.generate.</code><code class="descname">load_kernel_module</code><span class="sig-paren">(</span><em>model_name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#load_kernel_module"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the kernel module named in <em>model_name</em>.</p>
<p>If the name ends in <em>.py</em> then load it as a custom model using
<a class="reference internal" href="sasmodels.custom.html#sasmodels.custom.load_custom_kernel_module" title="sasmodels.custom.load_custom_kernel_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">sasmodels.custom.load_custom_kernel_module()</span></code></a>, otherwise
load it from <code class="xref py py-mod docutils literal notranslate"><span class="pre">sasmodels.models</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.load_template">
<code class="descclassname">sasmodels.generate.</code><code class="descname">load_template</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#load_template"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load template file from sasmodels resource directory.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.main">
<code class="descclassname">sasmodels.generate.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#main"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Program which prints the source produced by the model.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.make_doc">
<code class="descclassname">sasmodels.generate.</code><code class="descname">make_doc</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#make_doc"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the documentation for the model.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.make_html">
<code class="descclassname">sasmodels.generate.</code><code class="descname">make_html</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#make_html"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert model docs directly to html.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.make_partable">
<code class="descclassname">sasmodels.generate.</code><code class="descname">make_partable</code><span class="sig-paren">(</span><em>pars</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#make_partable"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate the parameter table to include in the sphinx documentation.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.make_source">
<code class="descclassname">sasmodels.generate.</code><code class="descname">make_source</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#make_source"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate the OpenCL/ctypes kernel from the module info.</p>
<p>Uses source files found in the given search path.  Returns None if this
is a pure python model, with no C source components.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.model_sources">
<code class="descclassname">sasmodels.generate.</code><code class="descname">model_sources</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#model_sources"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a list of the sources file paths for the module.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.ocl_timestamp">
<code class="descclassname">sasmodels.generate.</code><code class="descname">ocl_timestamp</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#ocl_timestamp"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a timestamp for the model corresponding to the most recently
changed file or dependency.</p>
<p>Note that this does not look at the time stamps for the OpenCL header
information since that need not trigger a recompile of the DLL.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.read_text">
<code class="descclassname">sasmodels.generate.</code><code class="descname">read_text</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#read_text"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="sasmodels.generate.set_integration_size">
<code class="descclassname">sasmodels.generate.</code><code class="descname">set_integration_size</code><span class="sig-paren">(</span><em>info</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#set_integration_size"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Update the model definition, replacing the gaussian integration with
a gaussian integration of a different size.</p>
<p>Note: this really ought to be a method in modelinfo, but that leads to
import loops.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.tag_source">
<code class="descclassname">sasmodels.generate.</code><code class="descname">tag_source</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#tag_source"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a unique tag for the source code.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.test_tag_float">
<code class="descclassname">sasmodels.generate.</code><code class="descname">test_tag_float</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#test_tag_float"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Check that floating point constants are identified and tagged with ‘f’</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.view_html">
<code class="descclassname">sasmodels.generate.</code><code class="descname">view_html</code><span class="sig-paren">(</span><em>model_name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#view_html"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load the model definition and view its help.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.generate.view_html_from_info">
<code class="descclassname">sasmodels.generate.</code><code class="descname">view_html_from_info</code><span class="sig-paren">(</span><em>info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/generate.html#view_html_from_info"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>View the help for a loaded model definition.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.gengauss">
<span id="sasmodels-gengauss-module"></span><h2>sasmodels.gengauss module</h2>
<p>Generate the Gauss-Legendre integration points and save them as a C file.</p>
<dl class="function">
<dt id="sasmodels.gengauss.gengauss">
<code class="descclassname">sasmodels.gengauss.</code><code class="descname">gengauss</code><span class="sig-paren">(</span><em>n</em>, <em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/gengauss.html#gengauss"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Save the Gauss-Legendre integration points for length <em>n</em> into file <em>path</em>.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.guyou">
<span id="sasmodels-guyou-module"></span><h2>sasmodels.guyou module</h2>
<p>Convert between latitude-longitude and Guyou map coordinates.</p>
<dl class="function">
<dt id="sasmodels.guyou.ellipticFi">
<code class="descclassname">sasmodels.guyou.</code><code class="descname">ellipticFi</code><span class="sig-paren">(</span><em>phi</em>, <em>psi</em>, <em>m</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/guyou.html#ellipticFi"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns F(phi+ipsi|m). See Abramowitz and Stegun, 17.4.11.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.guyou.ellipticJi">
<code class="descclassname">sasmodels.guyou.</code><code class="descname">ellipticJi</code><span class="sig-paren">(</span><em>u</em>, <em>v</em>, <em>m</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/guyou.html#ellipticJi"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns [sn, cn, dn](u + iv|m).</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.guyou.guyou">
<code class="descclassname">sasmodels.guyou.</code><code class="descname">guyou</code><span class="sig-paren">(</span><em>lam</em>, <em>phi</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/guyou.html#guyou"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Transform from (latitude, longitude) to point (x, y)</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.guyou.guyou_invert">
<code class="descclassname">sasmodels.guyou.</code><code class="descname">guyou_invert</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/guyou.html#guyou_invert"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Transform from point (x, y) on plot to (latitude, longitude)</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.guyou.main">
<code class="descclassname">sasmodels.guyou.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/guyou.html#main"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Show the Guyou transformation</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.guyou.plot_grid">
<code class="descclassname">sasmodels.guyou.</code><code class="descname">plot_grid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/guyou.html#plot_grid"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Plot the latitude-longitude grid for Guyou transform</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.jitter">
<span id="sasmodels-jitter-module"></span><h2>sasmodels.jitter module</h2>
<div class="section" id="jitter-explorer">
<h3>Jitter Explorer</h3>
<p>Application to explore orientation angle and angular dispersity.</p>
<p>From the command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show docs</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">sasmodels</span><span class="o">.</span><span class="n">jitter</span> <span class="o">--</span><span class="n">help</span>

<span class="c1"># Guyou projection jitter, uniform over 20 degree theta and 10 in phi</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">sasmodels</span><span class="o">.</span><span class="n">jitter</span> <span class="o">--</span><span class="n">projection</span><span class="o">=</span><span class="n">guyou</span> <span class="o">--</span><span class="n">dist</span><span class="o">=</span><span class="n">uniform</span> <span class="o">--</span><span class="n">jitter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span>
</pre></div>
</div>
<p>From a jupyter cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ipyvolume</span> <span class="k">as</span> <span class="nn">ipv</span>
<span class="kn">from</span> <span class="nn">sasmodels</span> <span class="k">import</span> <span class="n">jitter</span>
<span class="kn">import</span> <span class="nn">importlib</span><span class="p">;</span> <span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">jitter</span><span class="p">)</span>
<span class="n">jitter</span><span class="o">.</span><span class="n">set_plotter</span><span class="p">(</span><span class="s2">&quot;ipv&quot;</span><span class="p">)</span>

<span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">#size = (15, 15, 100)</span>
<span class="c1">#view = (60, 60, 0)</span>

<span class="n">dview</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">#dview = (5, 5, 0)</span>
<span class="c1">#dview = (15, 180, 0)</span>
<span class="c1">#dview = (180, 15, 0)</span>

<span class="n">projection</span> <span class="o">=</span> <span class="s1">&#39;equirectangular&#39;</span>
<span class="c1">#projection = &#39;azimuthal_equidistance&#39;</span>
<span class="c1">#projection = &#39;guyou&#39;</span>
<span class="c1">#projection = &#39;sinusoidal&#39;</span>
<span class="c1">#projection = &#39;azimuthal_equal_area&#39;</span>

<span class="n">dist</span> <span class="o">=</span> <span class="s1">&#39;uniform&#39;</span>
<span class="c1">#dist = &#39;gaussian&#39;</span>

<span class="n">jitter</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="n">dview</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
<span class="c1">#filename = projection+(&#39;_theta&#39; if dview[0] == 180 else &#39;_phi&#39; if dview[1] == 180 else &#39;&#39;)</span>
<span class="c1">#ipv.savefig(filename+&#39;.png&#39;)</span>
</pre></div>
</div>
<dl class="function">
<dt id="sasmodels.jitter.PLOT_ENGINE">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">PLOT_ENGINE</code><span class="sig-paren">(</span><em>calculator</em>, <em>draw_shape</em>, <em>size</em>, <em>view</em>, <em>jitter</em>, <em>dist</em>, <em>mesh</em>, <em>projection</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="class">
<dt id="sasmodels.jitter.Quaternion">
<em class="property">class </em><code class="descclassname">sasmodels.jitter.</code><code class="descname">Quaternion</code><span class="sig-paren">(</span><em>w</em>, <em>r</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#Quaternion"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Quaternion(w, r) = w + ir[0] + jr[1] + kr[2]</p>
<p>Quaternion.from_angle_axis(theta, r) for a rotation of angle theta about
an axis oriented toward the direction r.  This defines a unit quaternion,
normalizing <span class="math notranslate nohighlight">\(r\)</span> to the unit vector <span class="math notranslate nohighlight">\(\hat r\)</span>, and setting quaternion
<span class="math notranslate nohighlight">\(Q = \cos \theta + \sin \theta \hat r\)</span></p>
<p>Quaternion objects can be multiplied, which applies a rotation about the
given axis, allowing composition of rotations without risk of gimbal lock.
The resulting quaternion is applied to a set of points using <em>Q.rot(v)</em>.</p>
<dl class="method">
<dt id="sasmodels.jitter.Quaternion.conj">
<code class="descname">conj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#Quaternion.conj"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Conjugate quaternion</p>
</dd></dl>

<dl class="staticmethod">
<dt id="sasmodels.jitter.Quaternion.from_angle_axis">
<em class="property">static </em><code class="descname">from_angle_axis</code><span class="sig-paren">(</span><em>theta</em>, <em>r</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#Quaternion.from_angle_axis"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Build quaternion as rotation theta about axis r</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.jitter.Quaternion.inv">
<code class="descname">inv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#Quaternion.inv"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Inverse quaternion</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.jitter.Quaternion.norm">
<code class="descname">norm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#Quaternion.norm"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Quaternion length</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.jitter.Quaternion.rot">
<code class="descname">rot</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#Quaternion.rot"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Transform point <em>v</em> by quaternion</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.R_to_xyz">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">R_to_xyz</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#R_to_xyz"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return phi, theta, psi Tait-Bryan angles corresponding to the given rotation matrix.</p>
<p>Extracting Euler Angles from a Rotation Matrix
Mike Day, Insomniac Games
<a class="reference external" href="https://d3cw3dd2w32x2b.cloudfront.net/wp-content/uploads/2012/07/euler-angles1.pdf">https://d3cw3dd2w32x2b.cloudfront.net/wp-content/uploads/2012/07/euler-angles1.pdf</a>
Based on: Shoemake’s “Euler Angle Conversion”, Graphics Gems IV, pp.  222-229</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.Rx">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">Rx</code><span class="sig-paren">(</span><em>angle</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#Rx"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Construct a matrix to rotate points about <em>x</em> by <em>angle</em> degrees.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.Ry">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">Ry</code><span class="sig-paren">(</span><em>angle</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#Ry"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Construct a matrix to rotate points about <em>y</em> by <em>angle</em> degrees.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.Rz">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">Rz</code><span class="sig-paren">(</span><em>angle</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#Rz"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Construct a matrix to rotate points about <em>z</em> by <em>angle</em> degrees.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.apply_jitter">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">apply_jitter</code><span class="sig-paren">(</span><em>jitter</em>, <em>points</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#apply_jitter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Apply the jitter transform to a set of points.</p>
<p>Points are stored in a 3 x n numpy matrix, not a numpy array or tuple.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.build_model">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">build_model</code><span class="sig-paren">(</span><em>model_name</em>, <em>n=150</em>, <em>qmax=0.5</em>, <em>**pars</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#build_model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Build a calculator for the given shape.</p>
<p><em>model_name</em> is any sasmodels model.  <em>n</em> and <em>qmax</em> define an n x n mesh
on which to evaluate the model.  The remaining parameters are stored in
the returned calculator as <em>calculator.pars</em>.  They are used by
<a class="reference internal" href="#sasmodels.jitter.draw_scattering" title="sasmodels.jitter.draw_scattering"><code class="xref py py-func docutils literal notranslate"><span class="pre">draw_scattering()</span></code></a> to set the non-orientation parameters in the
calculation.</p>
<p>Returns a <em>calculator</em> function which takes a dictionary or parameters and
produces Iqxy.  The Iqxy value needs to be reshaped to an n x n matrix
for plotting.  See the <a class="reference internal" href="#sasmodels.direct_model.DirectModel" title="sasmodels.direct_model.DirectModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.direct_model.DirectModel</span></code></a> class
for details.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.clipped_range">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">clipped_range</code><span class="sig-paren">(</span><em>data</em>, <em>portion=1.0</em>, <em>mode='central'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#clipped_range"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Determine range from data.</p>
<p>If <em>portion</em> is 1, use full range, otherwise use the center of the range
or the top of the range, depending on whether <em>mode</em> is ‘central’ or ‘top’.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_axes">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_axes</code><span class="sig-paren">(</span><em>axes</em>, <em>origin=(-1</em>, <em>-1</em>, <em>-1)</em>, <em>length=(2</em>, <em>2</em>, <em>2)</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_axes"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw wireframe axes lines, with given origin and length</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_bcc">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_bcc</code><span class="sig-paren">(</span><em>axes</em>, <em>size</em>, <em>view</em>, <em>jitter</em>, <em>steps=None</em>, <em>alpha=1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_bcc"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw points for body-centered cubic paracrystal</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_beam">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_beam</code><span class="sig-paren">(</span><em>axes</em>, <em>view=(0</em>, <em>0)</em>, <em>alpha=0.5</em>, <em>steps=25</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_beam"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw the beam going from source at (0, 0, 1) to detector at (0, 0, -1)</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_box">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_box</code><span class="sig-paren">(</span><em>axes</em>, <em>size</em>, <em>view</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_box"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw a wireframe box at a particular view.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_ellipsoid">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_ellipsoid</code><span class="sig-paren">(</span><em>axes</em>, <em>size</em>, <em>view</em>, <em>jitter</em>, <em>steps=25</em>, <em>alpha=1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_ellipsoid"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw an ellipsoid.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_fcc">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_fcc</code><span class="sig-paren">(</span><em>axes</em>, <em>size</em>, <em>view</em>, <em>jitter</em>, <em>steps=None</em>, <em>alpha=1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_fcc"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw points for face-centered cubic paracrystal</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_jitter">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_jitter</code><span class="sig-paren">(</span><em>axes</em>, <em>view</em>, <em>jitter</em>, <em>dist='gaussian'</em>, <em>size=(0.1</em>, <em>0.4</em>, <em>1.0)</em>, <em>draw_shape=&lt;function draw_parallelepiped&gt;</em>, <em>projection='equirectangular'</em>, <em>alpha=0.8</em>, <em>views=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_jitter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Represent jitter as a set of shapes at different orientations.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_labels">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_labels</code><span class="sig-paren">(</span><em>axes</em>, <em>view</em>, <em>jitter</em>, <em>text</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_labels"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw text at a particular location.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_mesh">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_mesh</code><span class="sig-paren">(</span><em>axes</em>, <em>view</em>, <em>jitter</em>, <em>radius=1.2</em>, <em>n=11</em>, <em>dist='gaussian'</em>, <em>projection='equirectangular'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_mesh"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw the dispersion mesh showing the theta-phi orientations at which
the model will be evaluated.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_parallelepiped">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_parallelepiped</code><span class="sig-paren">(</span><em>axes</em>, <em>size</em>, <em>view</em>, <em>jitter</em>, <em>steps=None</em>, <em>color=(0.6</em>, <em>1.0</em>, <em>0.6)</em>, <em>alpha=1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_parallelepiped"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw a parallelepiped surface, with view and jitter.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_person_on_sphere">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_person_on_sphere</code><span class="sig-paren">(</span><em>axes</em>, <em>view</em>, <em>height=0.5</em>, <em>radius=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_person_on_sphere"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw a person on the surface of a sphere.</p>
<p><em>view</em> indicates (latitude, longitude, orientation)</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_sc">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_sc</code><span class="sig-paren">(</span><em>axes</em>, <em>size</em>, <em>view</em>, <em>jitter</em>, <em>steps=None</em>, <em>alpha=1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_sc"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw points for simple cubic paracrystal</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_scattering">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_scattering</code><span class="sig-paren">(</span><em>calculator</em>, <em>axes</em>, <em>view</em>, <em>jitter</em>, <em>dist='gaussian'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_scattering"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Plot the scattering for the particular view.</p>
<p><em>calculator</em> is returned from <a class="reference internal" href="#sasmodels.jitter.build_model" title="sasmodels.jitter.build_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_model()</span></code></a>.  <em>axes</em> are the 3D axes
on which the data will be plotted.  <em>view</em> and <em>jitter</em> are the current
orientation and orientation dispersity.  <em>dist</em> is one of the sasmodels
weight distributions.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.draw_sphere">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">draw_sphere</code><span class="sig-paren">(</span><em>axes</em>, <em>radius=1.0</em>, <em>steps=25</em>, <em>center=(0</em>, <em>0</em>, <em>0)</em>, <em>color='w'</em>, <em>alpha=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#draw_sphere"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Draw a sphere</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.get_projection">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">get_projection</code><span class="sig-paren">(</span><em>projection</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#get_projection"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>jitter projections
&lt;<a class="reference external" href="https://en.wikipedia.org/wiki/List_of_map_projections">https://en.wikipedia.org/wiki/List_of_map_projections</a>&gt;</p>
<dl class="docutils">
<dt>equirectangular (standard latitude-longitude mesh)</dt>
<dd>&lt;<a class="reference external" href="https://en.wikipedia.org/wiki/Equirectangular_projection">https://en.wikipedia.org/wiki/Equirectangular_projection</a>&gt;
Allows free movement in phi (around the equator), but theta is
limited to +/- 90, and points are cos-weighted. Jitter in phi is
uniform in weight along a line of latitude.  With small theta and
phi ranging over +/- 180 this forms a wobbling disk.  With small
phi and theta ranging over +/- 90 this forms a wedge like a slice
of an orange.</dd>
<dt>azimuthal_equidistance (Postel)</dt>
<dd>&lt;<a class="reference external" href="https://en.wikipedia.org/wiki/Azimuthal_equidistant_projection">https://en.wikipedia.org/wiki/Azimuthal_equidistant_projection</a>&gt;
Preserves distance from center, and so is an excellent map for
representing a bivariate gaussian on the surface.  Theta and phi
operate identically, cutting wegdes from the antipode of the viewing
angle.  This unfortunately does not allow free movement in either
theta or phi since the orthogonal wobble decreases to 0 as the body
rotates through 180 degrees.</dd>
<dt>sinusoidal (Sanson-Flamsteed, Mercator equal-area)</dt>
<dd>&lt;<a class="reference external" href="https://en.wikipedia.org/wiki/Sinusoidal_projection">https://en.wikipedia.org/wiki/Sinusoidal_projection</a>&gt;
Preserves arc length with latitude, giving bad behaviour at
theta near +/- 90.  Theta and phi operate somewhat differently,
so a system with a-b-c dtheta-dphi-dpsi will not give the same
value as one with b-a-c dphi-dtheta-dpsi, as would be the case
for azimuthal equidistance.  Free movement using theta or phi
uniform over +/- 180 will work, but not as well as equirectangular
phi, with theta being slightly worse.  Computationally it is much
cheaper for wide theta-phi meshes since it excludes points which
lie outside the sinusoid near theta +/- 90 rather than packing
them close together as in equirectangle.  Note that the poles
will be slightly overweighted for theta &gt; 90 with the circle
from theta at 90+dt winding backwards around the pole, overlapping
the circle from theta at 90-dt.</dd>
<dt>Guyou (hemisphere-in-a-square) <strong>not weighted</strong></dt>
<dd>&lt;<a class="reference external" href="https://en.wikipedia.org/wiki/Guyou_hemisphere-in-a-square_projection">https://en.wikipedia.org/wiki/Guyou_hemisphere-in-a-square_projection</a>&gt;
With tiling, allows rotation in phi or theta through +/- 180, with
uniform spacing.  Both theta and phi allow free rotation, with wobble
in the orthogonal direction reasonably well behaved (though not as
good as equirectangular phi). The forward/reverse transformations
relies on elliptic integrals that are somewhat expensive, so the
behaviour has to be very good to justify the cost and complexity.
The weighting function for each point has not yet been computed.
Note: run the module <em>guyou.py</em> directly and it will show the forward
and reverse mappings.</dd>
<dt>azimuthal_equal_area  <strong>incomplete</strong></dt>
<dd>&lt;<a class="reference external" href="https://en.wikipedia.org/wiki/Lambert_azimuthal_equal-area_projection">https://en.wikipedia.org/wiki/Lambert_azimuthal_equal-area_projection</a>&gt;
Preserves the relative density of the surface patches.  Not that
useful and not completely implemented</dd>
<dt>Gauss-Kreuger <strong>not implemented</strong></dt>
<dd>&lt;<a class="reference external" href="https://en.wikipedia.org/wiki/Transverse_Mercator_projection#Ellipsoidal_transverse_Mercator">https://en.wikipedia.org/wiki/Transverse_Mercator_projection#Ellipsoidal_transverse_Mercator</a>&gt;
Should allow free movement in theta, but phi is distorted.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.ipv_axes">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">ipv_axes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#ipv_axes"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Build a matplotlib style Axes interface for ipyvolume</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.main">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#main"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Command line interface to the jitter viewer.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.make_image">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">make_image</code><span class="sig-paren">(</span><em>z</em>, <em>kw</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#make_image"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert numpy array <em>z</em> into a <em>PIL</em> RGB image.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.make_vec">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">make_vec</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#make_vec"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Turn all elements of <em>args</em> into numpy arrays</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.map_colors">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">map_colors</code><span class="sig-paren">(</span><em>z</em>, <em>kw</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#map_colors"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Process matplotlib-style colour arguments.</p>
<p>Pulls ‘cmap’, ‘alpha’, ‘vmin’, and ‘vmax’ from th <em>kw</em> dictionary, setting
the <em>kw[‘color’]</em> to an RGB array.  These are ignored if ‘c’ or ‘color’ are
set inside <em>kw</em>.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.orient_relative_to_beam">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">orient_relative_to_beam</code><span class="sig-paren">(</span><em>view</em>, <em>points</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#orient_relative_to_beam"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Apply the view transform to a set of points.</p>
<p>Points are stored in a 3 x n numpy matrix, not a numpy array or tuple.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.orient_relative_to_beam_quaternion">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">orient_relative_to_beam_quaternion</code><span class="sig-paren">(</span><em>view</em>, <em>points</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#orient_relative_to_beam_quaternion"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Apply the view transform to a set of points.</p>
<p>Points are stored in a 3 x n numpy matrix, not a numpy array or tuple.</p>
<p>This variant uses quaternions rather than rotation matrices for the
computation.  It works but it is not used because it doesn’t solve
any problems.  The challenge of mapping theta/phi/psi to SO(3) does
not disappear by calculating the transform differently.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.run">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">run</code><span class="sig-paren">(</span><em>model_name='parallelepiped'</em>, <em>size=(10</em>, <em>40</em>, <em>100)</em>, <em>view=(0</em>, <em>0</em>, <em>0)</em>, <em>jitter=(0</em>, <em>0</em>, <em>0)</em>, <em>dist='gaussian'</em>, <em>mesh=30</em>, <em>projection='equirectangular'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#run"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Show an interactive orientation and jitter demo.</p>
<p><em>model_name</em> is one of: sphere, ellipsoid, triaxial_ellipsoid,
parallelepiped, cylinder, or sc/fcc/bcc_paracrystal</p>
<p><em>size</em> gives the dimensions (a, b, c) of the shape.</p>
<p><em>view</em> gives the initial view (theta, phi, psi) of the shape.</p>
<p><em>view</em> gives the initial jitter (dtheta, dphi, dpsi) of the shape.</p>
<p><em>dist</em> is the type of dispersition: gaussian, rectangle, or uniform.</p>
<p><em>mesh</em> is the number of points in the dispersion mesh.</p>
<p><em>projection</em> is the map projection to use for the mesh: equirectangular,
sinusoidal, guyou, azimuthal_equidistance, or azimuthal_equal_area.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.select_calculator">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">select_calculator</code><span class="sig-paren">(</span><em>model_name</em>, <em>n=150</em>, <em>size=(10</em>, <em>40</em>, <em>100)</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#select_calculator"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create a model calculator for the given shape.</p>
<p><em>model_name</em> is one of sphere, cylinder, ellipsoid, triaxial_ellipsoid,
parallelepiped or bcc_paracrystal. <em>n</em> is the number of points to use
in the q range.  <em>qmax</em> is chosen based on model parameters for the
given model to show something intersting.</p>
<p>Returns <em>calculator</em> and tuple <em>size</em> (a,b,c) giving minor and major
equitorial axes and polar axis respectively.  See <a class="reference internal" href="#sasmodels.jitter.build_model" title="sasmodels.jitter.build_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_model()</span></code></a>
for details on the returned calculator.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.set_plotter">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">set_plotter</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#set_plotter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Setting the plotting engine to matplotlib/ipyvolume or equivalently mpl/ipv.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.test_qrot">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">test_qrot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#test_qrot"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Quaternion checks</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.jitter.transform_xyz">
<code class="descclassname">sasmodels.jitter.</code><code class="descname">transform_xyz</code><span class="sig-paren">(</span><em>view</em>, <em>jitter</em>, <em>x</em>, <em>y</em>, <em>z</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/jitter.html#transform_xyz"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Send a set of (x,y,z) points through the jitter and view transforms.</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-sasmodels.kernel">
<span id="sasmodels-kernel-module"></span><h2>sasmodels.kernel module</h2>
<div class="section" id="execution-kernel-interface">
<h3>Execution kernel interface</h3>
<p><a class="reference internal" href="#sasmodels.kernel.KernelModel" title="sasmodels.kernel.KernelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelModel</span></code></a> defines the interface to all kernel models.
In particular, each model should provide a <a class="reference internal" href="#sasmodels.kernel.KernelModel.make_kernel" title="sasmodels.kernel.KernelModel.make_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">KernelModel.make_kernel()</span></code></a>
call which returns an executable kernel, <a class="reference internal" href="#sasmodels.kernel.Kernel" title="sasmodels.kernel.Kernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></a>, that operates
on the given set of <em>q_vector</em> inputs.  On completion of the computation,
the kernel should be released, which also releases the inputs.</p>
<dl class="class">
<dt id="sasmodels.kernel.Kernel">
<em class="property">class </em><code class="descclassname">sasmodels.kernel.</code><code class="descname">Kernel</code><a class="reference internal" href="../../_modules/sasmodels/kernel.html#Kernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Instantiated model for the compute engine, applied to a particular <em>q</em>.</p>
<p>Subclasses should define <code class="xref py py-meth docutils literal notranslate"><span class="pre">_call_kernel()</span></code> to evaluate the kernel over
its inputs.</p>
<dl class="method">
<dt id="sasmodels.kernel.Kernel.Fq">
<code class="descname">Fq</code><span class="sig-paren">(</span><em>call_details</em>, <em>values</em>, <em>cutoff</em>, <em>magnetic</em>, <em>radius_effective_mode=0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernel.html#Kernel.Fq"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns &lt;F(q)&gt;, &lt;F(q)^2&gt;, effective radius, shell volume and
form:shell volume ratio.  The &lt;F(q)&gt; term may be None if the
form factor does not support direct computation of <span class="math notranslate nohighlight">\(F(q)\)</span></p>
<p><span class="math notranslate nohighlight">\(P(q) = &lt;F^2(q)&gt;/&lt;V&gt;\)</span> is used for structure factor calculations,</p>
<div class="math notranslate nohighlight">
\[I(q) = \text{scale} \cdot P(q) \cdot S(q) + \text{background}\]</div>
<p>For the beta approximation, this becomes</p>
<div class="math notranslate nohighlight">
\[I(q) = \text{scale} P (1 + &lt;F&gt;^2/&lt;F^2&gt; (S - 1)) + \text{background}
     = \text{scale}/&lt;V&gt; (&lt;F^2&gt; + &lt;F&gt;^2 (S - 1)) + \text{background}\]</div>
<p><span class="math notranslate nohighlight">\(&lt;F(q)&gt;\)</span> and <span class="math notranslate nohighlight">\(&lt;F^2(q)&gt;\)</span> are averaged by polydispersity in shape
and orientation, with each configuration <span class="math notranslate nohighlight">\(x_k\)</span> having form factor
<span class="math notranslate nohighlight">\(F(q, x_k)\)</span>, weight <span class="math notranslate nohighlight">\(w_k\)</span> and volume <span class="math notranslate nohighlight">\(V_k\)</span>.  The result is:</p>
<div class="math notranslate nohighlight">
\[P(q)=\frac{\sum w_k F^2(q, x_k) / \sum w_k}{\sum w_k V_k / \sum w_k}\]</div>
<p>The form factor itself is scaled by volume and contrast to compute the
total scattering.  This is then squared, and the volume weighted
F^2 is then normalized by volume F.  For a given density, the number
of scattering centers is assumed to scale linearly with volume.  Later
scaling the resulting <span class="math notranslate nohighlight">\(P(q)\)</span> by the volume fraction of particles
gives the total scattering on an absolute scale. Most models
incorporate the volume fraction into the overall scale parameter.  An
exception is vesicle, which includes the volume fraction parameter in
the model itself, scaling <span class="math notranslate nohighlight">\(F\)</span> by <span class="math notranslate nohighlight">\(\surd V_f\)</span> so that the math for
the beta approximation works out.</p>
<p>By scaling <span class="math notranslate nohighlight">\(P(q)\)</span> by total weight <span class="math notranslate nohighlight">\(\sum w_k\)</span>, there is no need to make
sure that the polydisperisity distributions normalize to one.  In
particular, any distibution values <span class="math notranslate nohighlight">\(x_k\)</span> outside the valid domain
of <span class="math notranslate nohighlight">\(F\)</span> will not be included, and the distribution will be implicitly
truncated.  This is controlled by the parameter limits defined in the
model (which truncate the distribution before calling the kernel) as
well as any region excluded using the <em>INVALID</em> macro defined within
the model itself.</p>
<p>The volume used in the polydispersity calculation is the form volume
for solid objects or the shell volume for hollow objects.  Shell
volume should be used within <span class="math notranslate nohighlight">\(F\)</span> so that the normalizing scale
represents the volume fraction of the shell rather than the entire
form.  This corresponds to the volume fraction of shell-forming
material added to the solvent.</p>
<p>The calculation of <span class="math notranslate nohighlight">\(S\)</span> requires the effective radius and the
volume fraction of the particles.  The model can have several
different ways to compute effective radius, with the
<em>radius_effective_mode</em> parameter used to select amongst them.  The
volume fraction of particles should be determined from the total
volume fraction of the form, not just the shell volume fraction.
This makes a difference for hollow shapes, which need to scale
the volume fraction by the returned volume ratio when computing <span class="math notranslate nohighlight">\(S\)</span>.
For solid objects, the shell volume is set to the form volume so
this scale factor evaluates to one and so can be used for both
hollow and solid shapes.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.kernel.Kernel.Iq">
<code class="descname">Iq</code><span class="sig-paren">(</span><em>call_details</em>, <em>values</em>, <em>cutoff</em>, <em>magnetic</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernel.html#Kernel.Iq"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns I(q) from the polydisperse average scattering.</p>
<div class="math notranslate nohighlight">
\[I(q) = \text{scale} \cdot P(q) + \text{background}\]</div>
<p>With the correct choice of model and contrast, setting <em>scale</em> to
the volume fraction <span class="math notranslate nohighlight">\(V_f\)</span> of particles should match the measured
absolute scattering.  Some models (e.g., vesicle) have volume fraction
built into the model, and do not need an additional scale.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernel.Kernel.dim">
<code class="descname">dim</code><em class="property"> = None</em></dt>
<dd><p>Kernel dimension, either “1d” or “2d”.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernel.Kernel.dtype">
<code class="descname">dtype</code><em class="property"> = None</em></dt>
<dd><p>Numerical precision for the computation.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernel.Kernel.info">
<code class="descname">info</code><em class="property"> = None</em></dt>
<dd><p>Model info.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernel.Kernel.q_input">
<code class="descname">q_input</code><em class="property"> = None</em></dt>
<dd><p>q values at which the kernel is to be evaluated</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.kernel.Kernel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernel.html#Kernel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free resources associated with the kernel instance.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernel.Kernel.result">
<code class="descname">result</code><em class="property"> = None</em></dt>
<dd><p>Place to hold result of <code class="xref py py-meth docutils literal notranslate"><span class="pre">_call_kernel()</span></code> for subclass.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.kernel.KernelModel">
<em class="property">class </em><code class="descclassname">sasmodels.kernel.</code><code class="descname">KernelModel</code><a class="reference internal" href="../../_modules/sasmodels/kernel.html#KernelModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Model definition for the compute engine.</p>
<dl class="attribute">
<dt id="sasmodels.kernel.KernelModel.dtype">
<code class="descname">dtype</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernel.KernelModel.info">
<code class="descname">info</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sasmodels.kernel.KernelModel.make_kernel">
<code class="descname">make_kernel</code><span class="sig-paren">(</span><em>q_vectors</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernel.html#KernelModel.make_kernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Instantiate a kernel for evaluating the model at <em>q_vectors</em>.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.kernel.KernelModel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernel.html#KernelModel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free resources associated with the kernel.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-sasmodels.kernelcl">
<span id="sasmodels-kernelcl-module"></span><h2>sasmodels.kernelcl module</h2>
<p>GPU driver for C kernels</p>
<p>TODO: docs are out of date</p>
<p>There should be a single GPU environment running on the system.  This
environment is constructed on the first call to <code class="xref py py-func docutils literal notranslate"><span class="pre">env()</span></code>, and the
same environment is returned on each call.</p>
<p>After retrieving the environment, the next step is to create the kernel.
This is done with a call to <code class="xref py py-meth docutils literal notranslate"><span class="pre">GpuEnvironment.make_kernel()</span></code>, which
returns the type of data used by the kernel.</p>
<p>Next a <code class="xref py py-class docutils literal notranslate"><span class="pre">GpuData</span></code> object should be created with the correct kind
of data.  This data object can be used by multiple kernels, for example,
if the target model is a weighted sum of multiple kernels.  The data
should include any extra evaluation points required to compute the proper
data smearing.  This need not match the square grid for 2D data if there
is an index saying which q points are active.</p>
<p>Together the GpuData, the program, and a device form a <a class="reference internal" href="#sasmodels.kernelcl.GpuKernel" title="sasmodels.kernelcl.GpuKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GpuKernel</span></code></a>.
This kernel is used during fitting, receiving new sets of parameters and
evaluating them.  The output value is stored in an output buffer on the
devices, where it can be combined with other structure factors and form
factors and have instrumental resolution effects applied.</p>
<p>In order to use OpenCL for your models, you will need OpenCL drivers for
your machine.  These should be available from your graphics card vendor.
Intel provides OpenCL drivers for CPUs as well as their integrated HD
graphics chipsets.  AMD also provides drivers for Intel CPUs, but as of
this writing the performance is lacking compared to the Intel drivers.
NVidia combines drivers for CUDA and OpenCL in one package.  The result
is a bit messy if you have multiple drivers installed.  You can see which
drivers are available by starting python and running:</p>
<blockquote>
<div>import pyopencl as cl
cl.create_some_context(interactive=True)</div></blockquote>
<p>Once you have done that, it will show the available drivers which you
can select.  It will then tell you that you can use these drivers
automatically by setting the SAS_OPENCL environment variable, which is
PYOPENCL_CTX equivalent but not conflicting with other pyopnecl programs.</p>
<p>Some graphics cards have multiple devices on the same card.  You cannot
yet use both of them concurrently to evaluate models, but you can run
the program twice using a different device for each session.</p>
<p>OpenCL kernels are compiled when needed by the device driver.  Some
drivers produce compiler output even when there is no error.  You
can see the output by setting PYOPENCL_COMPILER_OUTPUT=1.  It should be
harmless, albeit annoying.</p>
<dl class="class">
<dt id="sasmodels.kernelcl.GpuEnvironment">
<em class="property">class </em><code class="descclassname">sasmodels.kernelcl.</code><code class="descname">GpuEnvironment</code><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#GpuEnvironment"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>GPU context for OpenCL, with possibly many devices and one queue per device.</p>
<dl class="method">
<dt id="sasmodels.kernelcl.GpuEnvironment.compile_program">
<code class="descname">compile_program</code><span class="sig-paren">(</span><em>name</em>, <em>source</em>, <em>dtype</em>, <em>fast</em>, <em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#GpuEnvironment.compile_program"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compile the program for the device in the given context.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.kernelcl.GpuEnvironment.has_type">
<code class="descname">has_type</code><span class="sig-paren">(</span><em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#GpuEnvironment.has_type"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return True if all devices support a given type.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.kernelcl.GpuInput">
<em class="property">class </em><code class="descclassname">sasmodels.kernelcl.</code><code class="descname">GpuInput</code><span class="sig-paren">(</span><em>q_vectors</em>, <em>dtype=dtype('float32')</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#GpuInput"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Make q data available to the gpu.</p>
<p><em>q_vectors</em> is a list of q vectors, which will be <em>[q]</em> for 1-D data,
and <em>[qx, qy]</em> for 2-D data.  Internally, the vectors will be reallocated
to get the best performance on OpenCL, which may involve shifting and
stretching the array to better match the memory architecture.  Additional
points will be evaluated with <em>q=1e-3</em>.</p>
<p><em>dtype</em> is the data type for the q vectors. The data type should be
set to match that of the kernel, which is an attribute of
<code class="xref py py-class docutils literal notranslate"><span class="pre">GpuProgram</span></code>.  Note that not all kernels support double
precision, so even if the program was created for double precision,
the <em>GpuProgram.dtype</em> may be single precision.</p>
<p>Call <a class="reference internal" href="#sasmodels.kernelcl.GpuInput.release" title="sasmodels.kernelcl.GpuInput.release"><code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code></a> when complete.  Even if not called directly, the
buffer will be released when the data object is freed.</p>
<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuInput.dtype">
<code class="descname">dtype</code><em class="property"> = dtype('float32')</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuInput.is_2d">
<code class="descname">is_2d</code><em class="property"> = False</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuInput.nq">
<code class="descname">nq</code><em class="property"> = 0</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuInput.q">
<code class="descname">q</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuInput.q_b">
<code class="descname">q_b</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sasmodels.kernelcl.GpuInput.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#GpuInput.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free the buffer associated with the q value.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.kernelcl.GpuKernel">
<em class="property">class </em><code class="descclassname">sasmodels.kernelcl.</code><code class="descname">GpuKernel</code><span class="sig-paren">(</span><em>model</em>, <em>q_vectors</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#GpuKernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.Kernel" title="sasmodels.kernel.Kernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.Kernel</span></code></a></p>
<p>Callable SAS kernel.</p>
<p><em>model</em> is the GpuModel object to call</p>
<p>The kernel is derived from <code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code>, providing the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">call_kernel()</span></code> method to evaluate the kernel for a given set of
parameters.  Because of the need to move the q values to the GPU before
evaluation, the kernel is instantiated for a particular set of q vectors,
and can be called many times without transfering q each time.</p>
<p>Call <a class="reference internal" href="#sasmodels.kernelcl.GpuKernel.release" title="sasmodels.kernelcl.GpuKernel.release"><code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code></a> when done with the kernel instance.</p>
<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuKernel.dim">
<code class="descname">dim</code><em class="property"> = ''</em></dt>
<dd><p>Kernel dimensions (1d or 2d).</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuKernel.dtype">
<code class="descname">dtype</code><em class="property"> = None</em></dt>
<dd><p>Kernel precision.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuKernel.info">
<code class="descname">info</code><em class="property"> = None</em></dt>
<dd><p>SAS model information structure.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuKernel.q_input">
<code class="descname">q_input</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sasmodels.kernelcl.GpuKernel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#GpuKernel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Release resources associated with the kernel.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuKernel.result">
<code class="descname">result</code><em class="property"> = None</em></dt>
<dd><p>Calculation results, updated after each call to <code class="xref py py-meth docutils literal notranslate"><span class="pre">_call_kernel()</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.kernelcl.GpuModel">
<em class="property">class </em><code class="descclassname">sasmodels.kernelcl.</code><code class="descname">GpuModel</code><span class="sig-paren">(</span><em>source</em>, <em>model_info</em>, <em>dtype=dtype('float32')</em>, <em>fast=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#GpuModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.KernelModel" title="sasmodels.kernel.KernelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.KernelModel</span></code></a></p>
<p>GPU wrapper for a single model.</p>
<p><em>source</em> and <em>model_info</em> are the model source and interface as returned
from <code class="xref py py-func docutils literal notranslate"><span class="pre">generate.make_source()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">generate.make_model_info()</span></code>.</p>
<p><em>dtype</em> is the desired model precision.  Any numpy dtype for single
or double precision floats will do, such as ‘f’, ‘float32’ or ‘single’
for single and ‘d’, ‘float64’ or ‘double’ for double.  Double precision
is an optional extension which may not be available on all devices.
Half precision (‘float16’,’half’) may be available on some devices.
Fast precision (‘fast’) is a loose version of single precision, indicating
that the compiler is allowed to take shortcuts.</p>
<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuModel.dtype">
<code class="descname">dtype</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuModel.fast">
<code class="descname">fast</code><em class="property"> = False</em></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sasmodels.kernelcl.GpuModel.get_function">
<code class="descname">get_function</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#GpuModel.get_function"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Fetch the kernel from the environment by name, compiling it if it
does not already exist.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuModel.info">
<code class="descname">info</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sasmodels.kernelcl.GpuModel.make_kernel">
<code class="descname">make_kernel</code><span class="sig-paren">(</span><em>q_vectors</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#GpuModel.make_kernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Instantiate a kernel for evaluating the model at <em>q_vectors</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcl.GpuModel.source">
<code class="descname">source</code><em class="property"> = ''</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcl.compile_model">
<code class="descclassname">sasmodels.kernelcl.</code><code class="descname">compile_model</code><span class="sig-paren">(</span><em>context</em>, <em>source</em>, <em>dtype</em>, <em>fast=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#compile_model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Build a model to run on the gpu.</p>
<p>Returns the compiled program and its type.</p>
<p>Raises an error if the desired precision is not available.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcl.environment">
<code class="descclassname">sasmodels.kernelcl.</code><code class="descname">environment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#environment"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns a singleton <a class="reference internal" href="#sasmodels.kernelcl.GpuEnvironment" title="sasmodels.kernelcl.GpuEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">GpuEnvironment</span></code></a>.</p>
<p>This provides an OpenCL context and one queue per device.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcl.fix_pyopencl_include">
<code class="descclassname">sasmodels.kernelcl.</code><code class="descname">fix_pyopencl_include</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#fix_pyopencl_include"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Monkey patch pyopencl to allow spaces in include file path.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcl.get_warp">
<code class="descclassname">sasmodels.kernelcl.</code><code class="descname">get_warp</code><span class="sig-paren">(</span><em>kernel</em>, <em>queue</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#get_warp"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the size of an execution batch for <em>kernel</em> running on <em>queue</em>.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcl.has_type">
<code class="descclassname">sasmodels.kernelcl.</code><code class="descname">has_type</code><span class="sig-paren">(</span><em>device</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#has_type"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return true if device supports the requested precision.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcl.quote_path">
<code class="descclassname">sasmodels.kernelcl.</code><code class="descname">quote_path</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#quote_path"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Quote the path if it is not already quoted.</p>
<p>If v starts with ‘-‘, then assume that it is a -I option or similar
and do not quote it.  This is fragile:  -Ipath with space needs to
be quoted.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcl.reset_environment">
<code class="descclassname">sasmodels.kernelcl.</code><code class="descname">reset_environment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#reset_environment"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a new OpenCL context, such as after a change to SAS_OPENCL.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcl.use_opencl">
<code class="descclassname">sasmodels.kernelcl.</code><code class="descname">use_opencl</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcl.html#use_opencl"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return True if OpenCL is the default computational engine</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.kernelcuda">
<span id="sasmodels-kernelcuda-module"></span><h2>sasmodels.kernelcuda module</h2>
<p>GPU driver for C kernels (with CUDA)</p>
<p>To select cuda, use SAS_OPENCL=cuda, or SAS_OPENCL=cuda:n for a particular
device number.  If no device number is specified, then look for CUDA_DEVICE=n
or a file ~/.cuda-device containing n for the device number.  Otherwise, try
all available device numbers.</p>
<p>TODO: docs are out of date</p>
<p>There should be a single GPU environment running on the system.  This
environment is constructed on the first call to <code class="xref py py-func docutils literal notranslate"><span class="pre">env()</span></code>, and the
same environment is returned on each call.</p>
<p>After retrieving the environment, the next step is to create the kernel.
This is done with a call to <code class="xref py py-meth docutils literal notranslate"><span class="pre">GpuEnvironment.make_kernel()</span></code>, which
returns the type of data used by the kernel.</p>
<p>Next a <code class="xref py py-class docutils literal notranslate"><span class="pre">GpuData</span></code> object should be created with the correct kind
of data.  This data object can be used by multiple kernels, for example,
if the target model is a weighted sum of multiple kernels.  The data
should include any extra evaluation points required to compute the proper
data smearing.  This need not match the square grid for 2D data if there
is an index saying which q points are active.</p>
<p>Together the GpuData, the program, and a device form a <a class="reference internal" href="#sasmodels.kernelcuda.GpuKernel" title="sasmodels.kernelcuda.GpuKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GpuKernel</span></code></a>.
This kernel is used during fitting, receiving new sets of parameters and
evaluating them.  The output value is stored in an output buffer on the
devices, where it can be combined with other structure factors and form
factors and have instrumental resolution effects applied.</p>
<p>In order to use OpenCL for your models, you will need OpenCL drivers for
your machine.  These should be available from your graphics card vendor.
Intel provides OpenCL drivers for CPUs as well as their integrated HD
graphics chipsets.  AMD also provides drivers for Intel CPUs, but as of
this writing the performance is lacking compared to the Intel drivers.
NVidia combines drivers for CUDA and OpenCL in one package.  The result
is a bit messy if you have multiple drivers installed.  You can see which
drivers are available by starting python and running:</p>
<blockquote>
<div>import pyopencl as cl
cl.create_some_context(interactive=True)</div></blockquote>
<p>Once you have done that, it will show the available drivers which you
can select.  It will then tell you that you can use these drivers
automatically by setting the SAS_OPENCL environment variable, which is
PYOPENCL_CTX equivalent but not conflicting with other pyopnecl programs.</p>
<p>Some graphics cards have multiple devices on the same card.  You cannot
yet use both of them concurrently to evaluate models, but you can run
the program twice using a different device for each session.</p>
<p>OpenCL kernels are compiled when needed by the device driver.  Some
drivers produce compiler output even when there is no error.  You
can see the output by setting PYOPENCL_COMPILER_OUTPUT=1.  It should be
harmless, albeit annoying.</p>
<dl class="class">
<dt id="sasmodels.kernelcuda.GpuEnvironment">
<em class="property">class </em><code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">GpuEnvironment</code><span class="sig-paren">(</span><em>devnum=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#GpuEnvironment"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>GPU context for CUDA.</p>
<dl class="method">
<dt id="sasmodels.kernelcuda.GpuEnvironment.compile_program">
<code class="descname">compile_program</code><span class="sig-paren">(</span><em>name</em>, <em>source</em>, <em>dtype</em>, <em>fast</em>, <em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#GpuEnvironment.compile_program"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compile the program for the device in the given context.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcuda.GpuEnvironment.context">
<code class="descname">context</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sasmodels.kernelcuda.GpuEnvironment.has_type">
<code class="descname">has_type</code><span class="sig-paren">(</span><em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#GpuEnvironment.has_type"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return True if all devices support a given type.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.kernelcuda.GpuEnvironment.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#GpuEnvironment.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free the CUDA device associated with this context.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.kernelcuda.GpuInput">
<em class="property">class </em><code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">GpuInput</code><span class="sig-paren">(</span><em>q_vectors</em>, <em>dtype=dtype('float32')</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#GpuInput"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Make q data available to the gpu.</p>
<p><em>q_vectors</em> is a list of q vectors, which will be <em>[q]</em> for 1-D data,
and <em>[qx, qy]</em> for 2-D data.  Internally, the vectors will be reallocated
to get the best performance on OpenCL, which may involve shifting and
stretching the array to better match the memory architecture.  Additional
points will be evaluated with <em>q=1e-3</em>.</p>
<p><em>dtype</em> is the data type for the q vectors. The data type should be
set to match that of the kernel, which is an attribute of
<code class="xref py py-class docutils literal notranslate"><span class="pre">GpuProgram</span></code>.  Note that not all kernels support double
precision, so even if the program was created for double precision,
the <em>GpuProgram.dtype</em> may be single precision.</p>
<p>Call <a class="reference internal" href="#sasmodels.kernelcuda.GpuInput.release" title="sasmodels.kernelcuda.GpuInput.release"><code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code></a> when complete.  Even if not called directly, the
buffer will be released when the data object is freed.</p>
<dl class="method">
<dt id="sasmodels.kernelcuda.GpuInput.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#GpuInput.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free the buffer associated with the q value.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.kernelcuda.GpuKernel">
<em class="property">class </em><code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">GpuKernel</code><span class="sig-paren">(</span><em>model</em>, <em>q_vectors</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#GpuKernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.Kernel" title="sasmodels.kernel.Kernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.Kernel</span></code></a></p>
<p>Callable SAS kernel.</p>
<p><em>model</em> is the GpuModel object to call</p>
<p>The kernel is derived from <code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code>, providing the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">call_kernel()</span></code> method to evaluate the kernel for a given set of
parameters.  Because of the need to move the q values to the GPU before
evaluation, the kernel is instantiated for a particular set of q vectors,
and can be called many times without transfering q each time.</p>
<p>Call <a class="reference internal" href="#sasmodels.kernelcuda.GpuKernel.release" title="sasmodels.kernelcuda.GpuKernel.release"><code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code></a> when done with the kernel instance.</p>
<dl class="attribute">
<dt id="sasmodels.kernelcuda.GpuKernel.dim">
<code class="descname">dim</code><em class="property"> = ''</em></dt>
<dd><p>Kernel dimensions (1d or 2d).</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcuda.GpuKernel.dtype">
<code class="descname">dtype</code><em class="property"> = None</em></dt>
<dd><p>Kernel precision.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcuda.GpuKernel.info">
<code class="descname">info</code><em class="property"> = None</em></dt>
<dd><p>SAS model information structure.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.kernelcuda.GpuKernel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#GpuKernel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Release resources associated with the kernel.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcuda.GpuKernel.result">
<code class="descname">result</code><em class="property"> = None</em></dt>
<dd><p>Calculation results, updated after each call to <code class="xref py py-meth docutils literal notranslate"><span class="pre">_call_kernel()</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.kernelcuda.GpuModel">
<em class="property">class </em><code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">GpuModel</code><span class="sig-paren">(</span><em>source</em>, <em>model_info</em>, <em>dtype=dtype('float32')</em>, <em>fast=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#GpuModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.KernelModel" title="sasmodels.kernel.KernelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.KernelModel</span></code></a></p>
<p>GPU wrapper for a single model.</p>
<p><em>source</em> and <em>model_info</em> are the model source and interface as returned
from <code class="xref py py-func docutils literal notranslate"><span class="pre">generate.make_source()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">generate.make_model_info()</span></code>.</p>
<p><em>dtype</em> is the desired model precision.  Any numpy dtype for single
or double precision floats will do, such as ‘f’, ‘float32’ or ‘single’
for single and ‘d’, ‘float64’ or ‘double’ for double.  Double precision
is an optional extension which may not be available on all devices.
Half precision (‘float16’,’half’) may be available on some devices.
Fast precision (‘fast’) is a loose version of single precision, indicating
that the compiler is allowed to take shortcuts.</p>
<dl class="attribute">
<dt id="sasmodels.kernelcuda.GpuModel.dtype">
<code class="descname">dtype</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcuda.GpuModel.fast">
<code class="descname">fast</code><em class="property"> = False</em></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sasmodels.kernelcuda.GpuModel.get_function">
<code class="descname">get_function</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#GpuModel.get_function"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Fetch the kernel from the environment by name, compiling it if it
does not already exist.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcuda.GpuModel.info">
<code class="descname">info</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sasmodels.kernelcuda.GpuModel.make_kernel">
<code class="descname">make_kernel</code><span class="sig-paren">(</span><em>q_vectors</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#GpuModel.make_kernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Instantiate a kernel for evaluating the model at <em>q_vectors</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.kernelcuda.GpuModel.source">
<code class="descname">source</code><em class="property"> = ''</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcuda.compile_model">
<code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">compile_model</code><span class="sig-paren">(</span><em>source</em>, <em>dtype</em>, <em>fast=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#compile_model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Build a model to run on the gpu.</p>
<p>Returns the compiled program and its type.  The returned type will
be float32 even if the desired type is float64 if any of the
devices in the context do not support the cl_khr_fp64 extension.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcuda.environment">
<code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">environment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#environment"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns a singleton <a class="reference internal" href="#sasmodels.kernelcuda.GpuEnvironment" title="sasmodels.kernelcuda.GpuEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">GpuEnvironment</span></code></a>.</p>
<p>This provides an OpenCL context and one queue per device.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcuda.has_type">
<code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">has_type</code><span class="sig-paren">(</span><em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#has_type"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return true if device supports the requested precision.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcuda.mark_device_functions">
<code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">mark_device_functions</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#mark_device_functions"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Mark all function declarations as __device__ functions (except kernel).</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcuda.partition">
<code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">partition</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#partition"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Constructs block and grid arguments for <em>n</em> elements.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcuda.reset_environment">
<code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">reset_environment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#reset_environment"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Call to create a new OpenCL context, such as after a change to SAS_OPENCL.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcuda.show_device_functions">
<code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">show_device_functions</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#show_device_functions"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Show all discovered function declarations, but don’t change any.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcuda.sync">
<code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">sync</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#sync"><span class="viewcode-link">[source]</span></a></dt>
<dd><dl class="docutils">
<dt>Overview:</dt>
<dd>Waits for operation in the current context to complete.</dd>
</dl>
<p>Note: Maybe context.synchronize() is sufficient.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kernelcuda.use_cuda">
<code class="descclassname">sasmodels.kernelcuda.</code><code class="descname">use_cuda</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelcuda.html#use_cuda"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns True if CUDA is the default compute engine.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.kerneldll">
<span id="sasmodels-kerneldll-module"></span><h2>sasmodels.kerneldll module</h2>
<p>DLL driver for C kernels</p>
<p>If the environment variable <em>SAS_OPENMP</em> is set, then sasmodels
will attempt to compile with OpenMP flags so that the model can use all
available kernels.  This may or may not be available on your compiler
toolchain.  Depending on operating system and environment.</p>
<p>Windows does not have provide a compiler with the operating system.
Instead, we assume that TinyCC is installed and available.  This can
be done with a simple pip command if it is not already available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">tinycc</span>
</pre></div>
</div>
<p>If Microsoft Visual C++ is available (because VCINSTALLDIR is
defined in the environment), then that will be used instead.
Microsoft Visual C++ for Python is available from Microsoft:</p>
<blockquote>
<div><a class="reference external" href="http://www.microsoft.com/en-us/download/details.aspx?id=44266">http://www.microsoft.com/en-us/download/details.aspx?id=44266</a></div></blockquote>
<p>If neither compiler is available, sasmodels will check for <em>MinGW</em>,
the GNU compiler toolchain. This available in packages such as Anaconda
and PythonXY, or available stand alone. This toolchain has had
difficulties on some systems, and may or may not work for you.</p>
<p>You can control which compiler to use by setting SAS_COMPILER in the
environment:</p>
<blockquote>
<div><ul class="simple">
<li>tinycc (Windows): use the TinyCC compiler shipped with SasView</li>
<li>msvc (Windows): use the Microsoft Visual C++ compiler</li>
<li>mingw (Windows): use the MinGW GNU cc compiler</li>
<li>unix (Linux): use the system cc compiler.</li>
<li>unix (Mac): use the clang compiler. You will need XCode installed, and
the XCode command line tools. Mac comes with OpenCL drivers, so generally
this will not be needed.</li>
</ul>
</div></blockquote>
<p>Both <em>msvc</em> and <em>mingw</em> require that the compiler is available on your path.
For <em>msvc</em>, this can done by running vcvarsall.bat in a windows terminal.
Install locations are system dependent, such as:</p>
<blockquote>
<div>C:Program Files (x86)Common FilesMicrosoftVisual
C++ for Python9.0vcvarsall.bat</div></blockquote>
<p>or maybe</p>
<blockquote>
<div>C:UsersyournameAppDataLocalProgramsCommonMicrosoftVisual
C++ for Python9.0vcvarsall.bat</div></blockquote>
<p>OpenMP for <em>msvc</em> requires the Microsoft vcomp90.dll library, which doesn’t
seem to be included with the compiler, nor does there appear to be a public
download location.  There may be one on your machine already in a location
such as:</p>
<blockquote>
<div>C:Windowswinsxsx86_microsoft.vc90.openmp*vcomp90.dll</div></blockquote>
<p>If you copy this to somewhere on your path, such as the python directory or
the install directory for this application, then OpenMP should be supported.</p>
<p>For full control of the compiler, define a function
<em>compile_command(source,output)</em> which takes the name of the source file
and the name of the output file and returns a compile command that can be
evaluated in the shell.  For even more control, replace the entire
<em>compile(source,output)</em> function.</p>
<p>The global attribute <em>ALLOW_SINGLE_PRECISION_DLLS</em> should be set to <em>False</em> if
you wish to prevent single precision floating point evaluation for the compiled
models, otherwise set it defaults to <em>True</em>.</p>
<dl class="class">
<dt id="sasmodels.kerneldll.DllKernel">
<em class="property">class </em><code class="descclassname">sasmodels.kerneldll.</code><code class="descname">DllKernel</code><span class="sig-paren">(</span><em>kernel</em>, <em>model_info</em>, <em>q_input</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kerneldll.html#DllKernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.Kernel" title="sasmodels.kernel.Kernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.Kernel</span></code></a></p>
<p>Callable SAS kernel.</p>
<p><em>kernel</em> is the c function to call.</p>
<p><em>model_info</em> is the module information</p>
<p><em>q_input</em> is the DllInput q vectors at which the kernel should be
evaluated.</p>
<p>The resulting call method takes the <em>pars</em>, a list of values for
the fixed parameters to the kernel, and <em>pd_pars</em>, a list of (value, weight)
vectors for the polydisperse parameters.  <em>cutoff</em> determines the
integration limits: any points with combined weight less than <em>cutoff</em>
will not be calculated.</p>
<p>Call <a class="reference internal" href="#sasmodels.kerneldll.DllKernel.release" title="sasmodels.kerneldll.DllKernel.release"><code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code></a> when done with the kernel instance.</p>
<dl class="method">
<dt id="sasmodels.kerneldll.DllKernel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kerneldll.html#DllKernel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Release resources associated with the kernel.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.kerneldll.DllModel">
<em class="property">class </em><code class="descclassname">sasmodels.kerneldll.</code><code class="descname">DllModel</code><span class="sig-paren">(</span><em>dllpath</em>, <em>model_info</em>, <em>dtype=dtype('float32')</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kerneldll.html#DllModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.KernelModel" title="sasmodels.kernel.KernelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.KernelModel</span></code></a></p>
<p>ctypes wrapper for a single model.</p>
<p><em>source</em> and <em>model_info</em> are the model source and interface as returned
from <code class="xref py py-func docutils literal notranslate"><span class="pre">gen.make()</span></code>.</p>
<p><em>dtype</em> is the desired model precision.  Any numpy dtype for single
or double precision floats will do, such as ‘f’, ‘float32’ or ‘single’
for single and ‘d’, ‘float64’ or ‘double’ for double.  Double precision
is an optional extension which may not be available on all devices.</p>
<p>Call <a class="reference internal" href="#sasmodels.kerneldll.DllModel.release" title="sasmodels.kerneldll.DllModel.release"><code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code></a> when done with the kernel.</p>
<dl class="method">
<dt id="sasmodels.kerneldll.DllModel.make_kernel">
<code class="descname">make_kernel</code><span class="sig-paren">(</span><em>q_vectors</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kerneldll.html#DllModel.make_kernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Instantiate a kernel for evaluating the model at <em>q_vectors</em>.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.kerneldll.DllModel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kerneldll.html#DllModel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Release any resources associated with the model.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.kerneldll.compile_command">
<code class="descclassname">sasmodels.kerneldll.</code><code class="descname">compile_command</code><span class="sig-paren">(</span><em>source</em>, <em>output</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kerneldll.html#compile_command"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>unix compiler command</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kerneldll.compile_model">
<code class="descclassname">sasmodels.kerneldll.</code><code class="descname">compile_model</code><span class="sig-paren">(</span><em>source</em>, <em>output</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kerneldll.html#compile_model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compile <em>source</em> producing <em>output</em>.</p>
<p>Raises RuntimeError if the compile failed or the output wasn’t produced.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kerneldll.decode">
<code class="descclassname">sasmodels.kerneldll.</code><code class="descname">decode</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="function">
<dt id="sasmodels.kerneldll.dll_name">
<code class="descclassname">sasmodels.kerneldll.</code><code class="descname">dll_name</code><span class="sig-paren">(</span><em>model_file</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kerneldll.html#dll_name"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Name of the dll containing the model.  This is the base file name without
any path or extension, with a form such as ‘sas_sphere32’.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kerneldll.dll_path">
<code class="descclassname">sasmodels.kerneldll.</code><code class="descname">dll_path</code><span class="sig-paren">(</span><em>model_file</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kerneldll.html#dll_path"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Complete path to the dll for the model.  Note that the dll may not
exist yet if it hasn’t been compiled.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kerneldll.load_dll">
<code class="descclassname">sasmodels.kerneldll.</code><code class="descname">load_dll</code><span class="sig-paren">(</span><em>source</em>, <em>model_info</em>, <em>dtype=dtype('float64')</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kerneldll.html#load_dll"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create and load a dll corresponding to the source, info pair returned
from <code class="xref py py-func docutils literal notranslate"><span class="pre">sasmodels.generate.make()</span></code> compiled for the target precision.</p>
<p>See <a class="reference internal" href="#sasmodels.kerneldll.make_dll" title="sasmodels.kerneldll.make_dll"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_dll()</span></code></a> for details on controlling the dll path and the
allowed floating point precision.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.kerneldll.make_dll">
<code class="descclassname">sasmodels.kerneldll.</code><code class="descname">make_dll</code><span class="sig-paren">(</span><em>source</em>, <em>model_info</em>, <em>dtype=dtype('float64')</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kerneldll.html#make_dll"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns the path to the compiled model defined by <em>kernel_module</em>.</p>
<p>If the model has not been compiled, or if the source file(s) are newer
than the dll, then <em>make_dll</em> will compile the model before returning.
This routine does not load the resulting dll.</p>
<p><em>dtype</em> is a numpy floating point precision specifier indicating whether
the model should be single, double or long double precision.  The default
is double precision, <em>np.dtype(‘d’)</em>.</p>
<p>Set <em>sasmodels.ALLOW_SINGLE_PRECISION_DLLS</em> to False if single precision
models are not allowed as DLLs.</p>
<p>Set <em>sasmodels.kerneldll.SAS_DLL_PATH</em> to the compiled dll output path.
Alternatively, set the environment variable <em>SAS_DLL_PATH</em>.
The default is in ~/.sasmodels/compiled_models.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.kernelpy">
<span id="sasmodels-kernelpy-module"></span><h2>sasmodels.kernelpy module</h2>
<p>Python driver for python kernels</p>
<p>Calls the kernel with a vector of <span class="math notranslate nohighlight">\(q\)</span> values for a single parameter set.
Polydispersity is supported by looping over different parameter sets and
summing the results.  The interface to <a class="reference internal" href="#sasmodels.kernelpy.PyModel" title="sasmodels.kernelpy.PyModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyModel</span></code></a> matches those for
<code class="xref py py-class docutils literal notranslate"><span class="pre">kernelcl.GpuModel</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">kerneldll.DllModel</span></code>.</p>
<dl class="class">
<dt id="sasmodels.kernelpy.PyInput">
<em class="property">class </em><code class="descclassname">sasmodels.kernelpy.</code><code class="descname">PyInput</code><span class="sig-paren">(</span><em>q_vectors</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelpy.html#PyInput"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Make q data available to the gpu.</p>
<p><em>q_vectors</em> is a list of q vectors, which will be <em>[q]</em> for 1-D data,
and <em>[qx, qy]</em> for 2-D data.  Internally, the vectors will be reallocated
to get the best performance on OpenCL, which may involve shifting and
stretching the array to better match the memory architecture.  Additional
points will be evaluated with <em>q=1e-3</em>.</p>
<p><em>dtype</em> is the data type for the q vectors. The data type should be
set to match that of the kernel, which is an attribute of
<code class="xref py py-class docutils literal notranslate"><span class="pre">GpuProgram</span></code>.  Note that not all kernels support double
precision, so even if the program was created for double precision,
the <em>GpuProgram.dtype</em> may be single precision.</p>
<p>Call <a class="reference internal" href="#sasmodels.kernelpy.PyInput.release" title="sasmodels.kernelpy.PyInput.release"><code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code></a> when complete.  Even if not called directly, the
buffer will be released when the data object is freed.</p>
<dl class="method">
<dt id="sasmodels.kernelpy.PyInput.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelpy.html#PyInput.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free resources associated with the model inputs.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.kernelpy.PyKernel">
<em class="property">class </em><code class="descclassname">sasmodels.kernelpy.</code><code class="descname">PyKernel</code><span class="sig-paren">(</span><em>model_info</em>, <em>q_input</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelpy.html#PyKernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.Kernel" title="sasmodels.kernel.Kernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.Kernel</span></code></a></p>
<p>Callable SAS kernel.</p>
<p><em>kernel</em> is the kernel object to call.</p>
<p><em>model_info</em> is the module information</p>
<p><em>q_input</em> is the DllInput q vectors at which the kernel should be
evaluated.</p>
<p>The resulting call method takes the <em>pars</em>, a list of values for
the fixed parameters to the kernel, and <em>pd_pars</em>, a list of (value,weight)
vectors for the polydisperse parameters.  <em>cutoff</em> determines the
integration limits: any points with combined weight less than <em>cutoff</em>
will not be calculated.</p>
<p>Call <a class="reference internal" href="#sasmodels.kernelpy.PyKernel.release" title="sasmodels.kernelpy.PyKernel.release"><code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code></a> when done with the kernel instance.</p>
<dl class="method">
<dt id="sasmodels.kernelpy.PyKernel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelpy.html#PyKernel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free resources associated with the kernel.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.kernelpy.PyModel">
<em class="property">class </em><code class="descclassname">sasmodels.kernelpy.</code><code class="descname">PyModel</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelpy.html#PyModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.KernelModel" title="sasmodels.kernel.KernelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.KernelModel</span></code></a></p>
<p>Wrapper for pure python models.</p>
<dl class="method">
<dt id="sasmodels.kernelpy.PyModel.make_kernel">
<code class="descname">make_kernel</code><span class="sig-paren">(</span><em>q_vectors</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelpy.html#PyModel.make_kernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Instantiate the python kernel with input <em>q_vectors</em></p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.kernelpy.PyModel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/kernelpy.html#PyModel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free resources associated with the model.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-sasmodels.list_pars">
<span id="sasmodels-list-pars-module"></span><h2>sasmodels.list_pars module</h2>
<p>List all parameters used along with the models which use them.</p>
<p>Usage:</p>
<blockquote>
<div>python -m sasmodels.list_pars [-v]</div></blockquote>
<p>If ‘-v’ is given, then list the models containing the parameter in
addition to just the parameter name.</p>
<dl class="function">
<dt id="sasmodels.list_pars.find_pars">
<code class="descclassname">sasmodels.list_pars.</code><code class="descname">find_pars</code><span class="sig-paren">(</span><em>kind=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/list_pars.html#find_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Find all parameters in all models.</p>
<p>Returns the reference table <em>{parameter: [model, model, …]}</em></p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.list_pars.list_pars">
<code class="descclassname">sasmodels.list_pars.</code><code class="descname">list_pars</code><span class="sig-paren">(</span><em>names_only=True</em>, <em>kind=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/list_pars.html#list_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Print all parameters in all models.</p>
<p>If <em>names_only</em> then only print the parameter name, not the models it
occurs in.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.list_pars.main">
<code class="descclassname">sasmodels.list_pars.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/list_pars.html#main"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Program to list the parameters used across all models.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.mixture">
<span id="sasmodels-mixture-module"></span><h2>sasmodels.mixture module</h2>
<div class="section" id="mixture-model">
<h3>Mixture model</h3>
<p>The product model multiplies the structure factor by the form factor,
modulated by the effective radius of the form.  The resulting model
has a attributes of both the model description (with parameters, etc.)
and the module evaluator (with call, release, etc.).</p>
<p>To use it, first load form factor P and structure factor S, then create
<em>ProductModel(P, S)</em>.</p>
<dl class="class">
<dt id="sasmodels.mixture.MixtureKernel">
<em class="property">class </em><code class="descclassname">sasmodels.mixture.</code><code class="descname">MixtureKernel</code><span class="sig-paren">(</span><em>model_info</em>, <em>kernels</em>, <em>q</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/mixture.html#MixtureKernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.Kernel" title="sasmodels.kernel.Kernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.Kernel</span></code></a></p>
<p>Instantiated kernel for mixture of models.</p>
<dl class="method">
<dt id="sasmodels.mixture.MixtureKernel.Iq">
<code class="descname">Iq</code><span class="sig-paren">(</span><em>call_details</em>, <em>values</em>, <em>cutoff</em>, <em>magnetic</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/mixture.html#MixtureKernel.Iq"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns I(q) from the polydisperse average scattering.</p>
<div class="math notranslate nohighlight">
\[I(q) = \text{scale} \cdot P(q) + \text{background}\]</div>
<p>With the correct choice of model and contrast, setting <em>scale</em> to
the volume fraction <span class="math notranslate nohighlight">\(V_f\)</span> of particles should match the measured
absolute scattering.  Some models (e.g., vesicle) have volume fraction
built into the model, and do not need an additional scale.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.mixture.MixtureKernel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/mixture.html#MixtureKernel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free resources associated with the kernel.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.mixture.MixtureModel">
<em class="property">class </em><code class="descclassname">sasmodels.mixture.</code><code class="descname">MixtureModel</code><span class="sig-paren">(</span><em>model_info</em>, <em>parts</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/mixture.html#MixtureModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.KernelModel" title="sasmodels.kernel.KernelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.KernelModel</span></code></a></p>
<p>Model definition for mixture of models.</p>
<dl class="method">
<dt id="sasmodels.mixture.MixtureModel.make_kernel">
<code class="descname">make_kernel</code><span class="sig-paren">(</span><em>q_vectors</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/mixture.html#MixtureModel.make_kernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Instantiate a kernel for evaluating the model at <em>q_vectors</em>.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.mixture.MixtureModel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/mixture.html#MixtureModel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free resources associated with the kernel.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.mixture.make_mixture_info">
<code class="descclassname">sasmodels.mixture.</code><code class="descname">make_mixture_info</code><span class="sig-paren">(</span><em>parts</em>, <em>operation='+'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/mixture.html#make_mixture_info"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create info block for mixture model.</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-sasmodels.model_test">
<span id="sasmodels-model-test-module"></span><h2>sasmodels.model_test module</h2>
<p>Run model unit tests.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">sasmodels</span><span class="o">.</span><span class="n">model_test</span> <span class="p">[</span><span class="n">opencl</span><span class="o">|</span><span class="n">cuda</span><span class="o">|</span><span class="n">dll</span><span class="o">|</span><span class="nb">all</span><span class="p">]</span> <span class="n">model1</span> <span class="n">model2</span> <span class="o">...</span>
</pre></div>
</div>
<p>If model1 is ‘all’, then all except the remaining models will be tested.
Subgroups are also possible, such as ‘py’, ‘single’ or ‘1d’.  See
<code class="xref py py-func docutils literal notranslate"><span class="pre">core.list_models()</span></code> for details.</p>
<p>Each model is tested using the default parameters at q=0.1, (qx, qy)=(0.1, 0.1),
and Fq is called to make sure R_eff, volume and volume ratio are computed.
The return values at these points are not considered.  The test is only to
verify that the models run to completion, and do not produce inf or NaN.</p>
<p>Tests are defined with the <em>tests</em> attribute in the model.py file.  <em>tests</em>
is a list of individual tests to run, where each test consists of the
parameter values for the test, the q-values and the expected results.  For
the effective radius test and volume ratio tests, use the extended output
form, which checks each output of kernel.Fq. For 1-D tests, either specify
the q value or a list of q-values, and the corresponding I(q) value, or
list of I(q) values.</p>
<p>That is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tests</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="n">q</span><span class="p">,</span> <span class="n">I</span><span class="p">(</span><span class="n">q</span><span class="p">)],</span>
    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="p">[</span><span class="n">q</span><span class="p">],</span> <span class="p">[</span><span class="n">I</span><span class="p">(</span><span class="n">q</span><span class="p">)]</span> <span class="p">],</span>
    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="p">[</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="p">[</span><span class="n">I</span><span class="p">(</span><span class="n">q1</span><span class="p">),</span> <span class="n">I</span><span class="p">(</span><span class="n">q2</span><span class="p">),</span> <span class="o">...</span><span class="p">]],</span>

    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="p">(</span><span class="n">qx</span><span class="p">,</span> <span class="n">qy</span><span class="p">),</span> <span class="n">I</span><span class="p">(</span><span class="n">qx</span><span class="p">,</span> <span class="n">Iqy</span><span class="p">)],</span>
    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="p">[(</span><span class="n">qx1</span><span class="p">,</span> <span class="n">qy1</span><span class="p">),</span> <span class="p">(</span><span class="n">qx2</span><span class="p">,</span> <span class="n">qy2</span><span class="p">),</span> <span class="o">...</span><span class="p">],</span>
                    <span class="p">[</span><span class="n">I</span><span class="p">(</span><span class="n">qx1</span><span class="p">,</span> <span class="n">qy1</span><span class="p">),</span> <span class="n">I</span><span class="p">(</span><span class="n">qx2</span><span class="p">,</span> <span class="n">qy2</span><span class="p">),</span> <span class="o">...</span><span class="p">]],</span>

    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="n">q</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">F</span><span class="o">^</span><span class="mi">2</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">R_eff</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">V_r</span> <span class="p">],</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Parameters are <em>key:value</em> pairs, where key is one of the parameters of the
model and value is the value to use for the test.  Any parameters not given
in the parameter list will take on the default parameter value.</p>
<p>Precision defaults to 5 digits (relative).</p>
<dl class="function">
<dt id="sasmodels.model_test.check_model">
<code class="descclassname">sasmodels.model_test.</code><code class="descname">check_model</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/model_test.html#check_model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Run the tests for a single model, capturing the output.</p>
<p>Returns success status and the output string.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.model_test.invalid_pars">
<code class="descclassname">sasmodels.model_test.</code><code class="descname">invalid_pars</code><span class="sig-paren">(</span><em>partable</em>, <em>pars</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/model_test.html#invalid_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a list of parameter names that are not part of the model.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.model_test.is_near">
<code class="descclassname">sasmodels.model_test.</code><code class="descname">is_near</code><span class="sig-paren">(</span><em>target</em>, <em>actual</em>, <em>digits=5</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/model_test.html#is_near"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns true if <em>actual</em> is within <em>digits</em> significant digits of <em>target</em>.</p>
<p><em>taget</em> zero and inf should match <em>actual</em> zero and inf.  If you want to
accept eps for zero, choose a value such as 1e-10, which must match up to
+/- 1e-15 when <em>digits</em> is the default value of 5.</p>
<p>If <em>target</em> is None, then just make sure that <em>actual</em> is not NaN.</p>
<p>If <em>target</em> is NaN, make sure <em>actual</em> is NaN.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.model_test.main">
<code class="descclassname">sasmodels.model_test.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/model_test.html#main"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Run tests given is models.</p>
<p>Returns 0 if success or 1 if any tests fail.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.model_test.make_suite">
<code class="descclassname">sasmodels.model_test.</code><code class="descname">make_suite</code><span class="sig-paren">(</span><em>loaders</em>, <em>models</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/model_test.html#make_suite"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Construct the pyunit test suite.</p>
<p><em>loaders</em> is the list of kernel drivers to use (dll, opencl or cuda).
For python model the python driver is always used.</p>
<p><em>models</em> is the list of models to test, or <em>[“all”]</em> to test all models.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.model_test.model_tests">
<code class="descclassname">sasmodels.model_test.</code><code class="descname">model_tests</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/model_test.html#model_tests"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Test runner visible to nosetests.</p>
<p>Run “nosetests sasmodels” on the command line to invoke it.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.model_test.run_one">
<code class="descclassname">sasmodels.model_test.</code><code class="descname">run_one</code><span class="sig-paren">(</span><em>model_name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/model_test.html#run_one"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>[Deprecated] Run the tests associated with <em>model_name</em>.</p>
<p>Use the following instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">succss</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">check_model</span><span class="p">(</span><span class="n">load_model_info</span><span class="p">(</span><span class="n">model_name</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.modelinfo">
<span id="sasmodels-modelinfo-module"></span><h2>sasmodels.modelinfo module</h2>
<div class="section" id="model-info-and-parameter-tables">
<h3>Model Info and Parameter Tables</h3>
<p>Defines <a class="reference internal" href="#sasmodels.modelinfo.ModelInfo" title="sasmodels.modelinfo.ModelInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelInfo</span></code></a> and <a class="reference internal" href="#sasmodels.modelinfo.ParameterTable" title="sasmodels.modelinfo.ParameterTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterTable</span></code></a> and the routines for
manipulating them.  In particular, <a class="reference internal" href="#sasmodels.modelinfo.make_model_info" title="sasmodels.modelinfo.make_model_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_model_info()</span></code></a> converts a kernel
module into the model info block as seen by the rest of the sasmodels library.</p>
<dl class="data">
<dt id="sasmodels.modelinfo.C_SYMBOLS">
<code class="descclassname">sasmodels.modelinfo.</code><code class="descname">C_SYMBOLS</code><em class="property"> = ['Imagnetic', 'Iq', 'Iqxy', 'Iqac', 'Iqabc', 'form_volume', 'shell_volume', 'c_code', 'valid']</em></dt>
<dd><p>Set of variables defined in the model that might contain C code</p>
</dd></dl>

<dl class="data">
<dt id="sasmodels.modelinfo.MAX_PD">
<code class="descclassname">sasmodels.modelinfo.</code><code class="descname">MAX_PD</code><em class="property"> = 5</em></dt>
<dd><p>Maximum number of simultaneously polydisperse parameters</p>
</dd></dl>

<dl class="class">
<dt id="sasmodels.modelinfo.ModelInfo">
<em class="property">class </em><code class="descclassname">sasmodels.modelinfo.</code><code class="descname">ModelInfo</code><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#ModelInfo"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Interpret the model definition file, categorizing the parameters.</p>
<p>The module can be loaded with a normal python import statement if you
know which module you need, or with __import__(‘sasmodels.model.’+name)
if the name is in a string.</p>
<p>The structure should be mostly static, other than the delayed definition
of <em>Iq</em>, <em>Iqac</em> and <em>Iqabc</em> if they need to be defined.</p>
<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.Imagnetic">
<code class="descname">Imagnetic</code><em class="property"> = None</em></dt>
<dd><p>Returns <em>I(qx, qy, a, b, …)</em>.  The interface follows <a class="reference internal" href="#sasmodels.modelinfo.ModelInfo.Iq" title="sasmodels.modelinfo.ModelInfo.Iq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Iq</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.Iq">
<code class="descname">Iq</code><em class="property"> = None</em></dt>
<dd><p>Returns <em>I(q, a, b, …)</em> for parameters <em>a</em>, <em>b</em>, etc. defined
by the parameter table.  <em>Iq</em> can be defined as a python function, or
as a C function.  If it is defined in C, then set <em>Iq</em> to the body of
the C function, including the return statement.  This function takes
values for <em>q</em> and each of the parameters as separate <em>double</em> values
(which may be converted to float or long double by sasmodels).  All
source code files listed in <code class="xref py py-attr docutils literal notranslate"><span class="pre">sources</span></code> will be loaded before the
<em>Iq</em> function is defined.  If <em>Iq</em> is not present, then sources should
define <em>static double Iq(double q, double a, double b, …)</em> which
will return <em>I(q, a, b, …)</em>.  Multiplicity parameters are sent as
pointers to doubles.  Constants in floating point expressions should
include the decimal point. See <code class="xref py py-mod docutils literal notranslate"><span class="pre">generate</span></code> for more details. If
<em>have_Fq</em> is True, then Iq should return an interleaved array of
<span class="math notranslate nohighlight">\([\sum F(q_1), \sum F^2(q_1), \ldots, \sum F(q_n), \sum F^2(q_n)]\)</span>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.Iqabc">
<code class="descname">Iqabc</code><em class="property"> = None</em></dt>
<dd><p>Returns <em>I(qa, qb, qc, a, b, …)</em>.  The interface follows <a class="reference internal" href="#sasmodels.modelinfo.ModelInfo.Iq" title="sasmodels.modelinfo.ModelInfo.Iq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Iq</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.Iqac">
<code class="descname">Iqac</code><em class="property"> = None</em></dt>
<dd><p>Returns <em>I(qab, qc, a, b, …)</em>.  The interface follows <a class="reference internal" href="#sasmodels.modelinfo.ModelInfo.Iq" title="sasmodels.modelinfo.ModelInfo.Iq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Iq</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.Iqxy">
<code class="descname">Iqxy</code><em class="property"> = None</em></dt>
<dd><p>Returns <em>I(qx, qy, a, b, …)</em>.  The interface follows <a class="reference internal" href="#sasmodels.modelinfo.ModelInfo.Iq" title="sasmodels.modelinfo.ModelInfo.Iq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Iq</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.base">
<code class="descname">base</code><em class="property"> = None</em></dt>
<dd><p>For reparameterized systems, <em>base</em> is the base parameter table.  For
normal systems it is simply a copy of <em>parameters</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.basefile">
<code class="descname">basefile</code><em class="property"> = None</em></dt>
<dd><p>Base file is usually filename, but not when a model has been
reparameterized, in which case it is the file containing the original
model definition.  This is needed to signal an additional dependency for
the model time stamp, and so that the compiler reports correct file
for syntax errors.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.c_code">
<code class="descname">c_code</code><em class="property"> = None</em></dt>
<dd><p>inline source code, added after all elements of source</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.category">
<code class="descname">category</code><em class="property"> = None</em></dt>
<dd><p>Location of the model description in the documentation.  This takes the
form of “section” or “section:subsection”.  So for example,
<a class="reference internal" href="../../user/models/porod.html#porod"><span class="std std-ref">porod</span></a> uses <em>category=”shape-independent”</em> so it is in the
<a class="reference internal" href="../../user/qtgui/Perspectives/Fitting/models/shape-independent.html#shape-independent"><span class="std std-ref">Shape-Independent Functions</span></a> section whereas
<a class="reference internal" href="../../user/models/capped_cylinder.html#capped-cylinder"><span class="std std-ref">capped_cylinder</span></a> uses: <em>category=”shape:cylinder”</em>, which puts
it in the <a class="reference internal" href="../../user/qtgui/Perspectives/Fitting/models/shape-cylinder.html#shape-cylinder"><span class="std std-ref">Cylinder Functions</span></a> section.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.composition">
<code class="descname">composition</code><em class="property"> = None</em></dt>
<dd><p>Composition is None if this is an independent model, or it is a
tuple with comoposition type (‘product’ or ‘misture’) and a list of
<a class="reference internal" href="#sasmodels.modelinfo.ModelInfo" title="sasmodels.modelinfo.ModelInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelInfo</span></code></a> blocks for the composed objects.  This allows us
to rebuild a complete mixture or product model from the info block.
<em>composition</em> is not given in the model definition file, but instead
arises when the model is constructed using names such as
<em>sphere*hardsphere</em> or <em>cylinder+sphere</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.description">
<code class="descname">description</code><em class="property"> = None</em></dt>
<dd><p>Long description of the model.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.docs">
<code class="descname">docs</code><em class="property"> = None</em></dt>
<dd><p>Doc string from the top of the model file.  This should be formatted
using ReStructuredText format, with latex markup in “.. math”
environments, or in dollar signs.  This will be automatically
extracted to a .rst file by <code class="xref py py-func docutils literal notranslate"><span class="pre">generate.make_docs()</span></code>, then
converted to HTML or PDF by Sphinx.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.filename">
<code class="descname">filename</code><em class="property"> = None</em></dt>
<dd><p>Full path to the file defining the kernel, if any.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.form_volume">
<code class="descname">form_volume</code><em class="property"> = None</em></dt>
<dd><p>Returns the form volume for python-based models.  Form volume is needed
for volume normalization in the polydispersity integral.  If no
parameters are <em>volume</em> parameters, then form volume is not needed.
For C-based models, (with <code class="xref py py-attr docutils literal notranslate"><span class="pre">sources</span></code> defined, or with <a class="reference internal" href="#sasmodels.modelinfo.ModelInfo.Iq" title="sasmodels.modelinfo.ModelInfo.Iq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Iq</span></code></a>
defined using a string containing C code), form_volume must also be
C code, either defined as a string, or in the sources.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.modelinfo.ModelInfo.get_hidden_parameters">
<code class="descname">get_hidden_parameters</code><span class="sig-paren">(</span><em>control</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#ModelInfo.get_hidden_parameters"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns the set of hidden parameters for the model.  <em>control</em> is the
value of the control parameter.  Note that multiplicity models have
an implicit control parameter, which is the parameter that controls
the multiplicity.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.have_Fq">
<code class="descname">have_Fq</code><em class="property"> = False</em></dt>
<dd><p>True if the model defines an Fq function with signature
<code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">Fq(double</span> <span class="pre">q,</span> <span class="pre">double</span> <span class="pre">*F1,</span> <span class="pre">double</span> <span class="pre">*F2,</span> <span class="pre">...)</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.hidden">
<code class="descname">hidden</code><em class="property"> = None</em></dt>
<dd><p>Different variants require different parameters.  In order to show
just the parameters needed for the variant selected by <code class="xref py py-attr docutils literal notranslate"><span class="pre">control</span></code>,
you should provide a function <em>hidden(control) -&gt; set([‘a’, ‘b’, …])</em>
indicating which parameters need to be hidden.  For multiplicity
models, you need to use the complete name of the parameter, including
its number.  So for example, if variant “a” uses only <em>sld1</em> and <em>sld2</em>,
then <em>sld3</em>, <em>sld4</em> and <em>sld5</em> of multiplicity parameter <em>sld[5]</em>
should be in the hidden set.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.id">
<code class="descname">id</code><em class="property"> = None</em></dt>
<dd><p>Id of the kernel used to load it from the filesystem.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.lineno">
<code class="descname">lineno</code><em class="property"> = None</em></dt>
<dd><p>Line numbers for symbols defining C code</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.name">
<code class="descname">name</code><em class="property"> = None</em></dt>
<dd><p>Display name of the model, which defaults to the model id but with
capitalization of the parts so for example core_shell defaults to
“Core Shell”.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.opencl">
<code class="descname">opencl</code><em class="property"> = None</em></dt>
<dd><p>True if the model can be run as an opencl model.  If for some reason
the model cannot be run in opencl (e.g., because the model passes
functions by reference), then set this to false.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.parameters">
<code class="descname">parameters</code><em class="property"> = None</em></dt>
<dd><p>Model parameter table. Parameters are defined using a list of parameter
definitions, each of which is contains parameter name, units,
default value, limits, type and description.  See <a class="reference internal" href="#sasmodels.modelinfo.Parameter" title="sasmodels.modelinfo.Parameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code></a>
for details on the individual parameters.  The parameters are gathered
into a <a class="reference internal" href="#sasmodels.modelinfo.ParameterTable" title="sasmodels.modelinfo.ParameterTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterTable</span></code></a>, which provides various views into the
parameter list.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.profile">
<code class="descname">profile</code><em class="property"> = None</em></dt>
<dd><p>Returns a model profile curve <em>x, y</em>.  If <em>profile</em> is defined, this
curve will appear in response to the <em>Show</em> button in SasView.  Use
<a class="reference internal" href="#sasmodels.modelinfo.ModelInfo.profile_axes" title="sasmodels.modelinfo.ModelInfo.profile_axes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">profile_axes</span></code></a> to set the axis labels.  Note that <em>y</em> values
will be scaled by 1e6 before plotting.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.profile_axes">
<code class="descname">profile_axes</code><em class="property"> = None</em></dt>
<dd><p>Axis labels for the <a class="reference internal" href="#sasmodels.modelinfo.ModelInfo.profile" title="sasmodels.modelinfo.ModelInfo.profile"><code class="xref py py-attr docutils literal notranslate"><span class="pre">profile</span></code></a> plot.  The default is <em>[‘x’, ‘y’]</em>.
Only the <em>x</em> component is used for now.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.radius_effective">
<code class="descname">radius_effective</code><em class="property"> = None</em></dt>
<dd><p>Computes the effective radius of the shape given the volume parameters.
Only needed for models defined in python that can be used for
monodisperse approximation for non-dilute solutions, P&#64;S.  The first
argument is the integer effective radius mode, with default 0.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.radius_effective_modes">
<code class="descname">radius_effective_modes</code><em class="property"> = None</em></dt>
<dd><p>List of options for computing the effective radius of the shape,
or None if the model is not usable as a form factor model.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.random">
<code class="descname">random</code><em class="property"> = None</em></dt>
<dd><p>Returns a random parameter set for the model</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.sesans">
<code class="descname">sesans</code><em class="property"> = None</em></dt>
<dd><p>Returns <em>sesans(z, a, b, …)</em> for models which can directly compute
the SESANS correlation function.  Note: not currently implemented.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.shell_volume">
<code class="descname">shell_volume</code><em class="property"> = None</em></dt>
<dd><p>Returns the shell volume for python-based models.  Form volume and
shell volume are needed for volume normalization in the polydispersity
integral and structure interactions for hollow shapes.  If no
parameters are <em>volume</em> parameters, then shell volume is not needed.
For C-based models, (with <code class="xref py py-attr docutils literal notranslate"><span class="pre">sources</span></code> defined, or with <a class="reference internal" href="#sasmodels.modelinfo.ModelInfo.Iq" title="sasmodels.modelinfo.ModelInfo.Iq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Iq</span></code></a>
defined using a string containing C code), shell_volume must also be
C code, either defined as a string, or in the sources.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.single">
<code class="descname">single</code><em class="property"> = None</em></dt>
<dd><p>True if the model can be computed accurately with single precision.
This is True by default, but models such as <a class="reference internal" href="../../user/models/bcc_paracrystal.html#bcc-paracrystal"><span class="std std-ref">bcc_paracrystal</span></a> set
it to False because they require double precision calculations.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.source">
<code class="descname">source</code><em class="property"> = None</em></dt>
<dd><p>List of C source files used to define the model.  The source files
should define the <em>Iq</em> function, and possibly <em>Iqac</em> or <em>Iqabc</em> if the
model defines orientation parameters. Files containing the most basic
functions must appear first in the list, followed by the files that
use those functions.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.structure_factor">
<code class="descname">structure_factor</code><em class="property"> = None</em></dt>
<dd><p>True if the model is a structure factor used to model the interaction
between form factor models.  This will default to False if it is not
provided in the file.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.tests">
<code class="descname">tests</code><em class="property"> = None</em></dt>
<dd><p>The set of tests that must pass.  The format of the tests is described
in <code class="xref py py-mod docutils literal notranslate"><span class="pre">model_test</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.title">
<code class="descname">title</code><em class="property"> = None</em></dt>
<dd><p>Short description of the model.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.translation">
<code class="descname">translation</code><em class="property"> = None</em></dt>
<dd><p>Parameter translation code to convert from <em>parameters</em> table from
caller to the <em>base</em> table used to evaluate the model.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.modelinfo.ModelInfo.valid">
<code class="descname">valid</code><em class="property"> = None</em></dt>
<dd><p>Expression which evaluates to True if the input parameters are valid
and the model can be computed, or False otherwise.  Invalid parameter
sets will not be included in the weighted <span class="math notranslate nohighlight">\(I(Q)\)</span> calculation or its
volume normalization.  Use C syntax for the expressions, with || for or
&amp;&amp; for and and ! for not.  Any non-magnetic parameter can be used.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.modelinfo.Parameter">
<em class="property">class </em><code class="descclassname">sasmodels.modelinfo.</code><code class="descname">Parameter</code><span class="sig-paren">(</span><em>name</em>, <em>units=''</em>, <em>default=None</em>, <em>limits=(-inf</em>, <em>inf)</em>, <em>ptype=''</em>, <em>description=''</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#Parameter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The available kernel parameters are defined as a list, with each parameter
defined as a sublist with the following elements:</p>
<p><em>name</em> is the name that will be displayed to the user.  Names
should be lower case, with words separated by underscore.  If
acronyms are used, the whole acronym should be upper case. For vector
parameters, the name will be followed by <em>[len]</em> where <em>len</em> is an
integer length of the vector, or the name of the parameter which
controls the length.  The attribute <em>id</em> will be created from name
without the length.</p>
<p><em>units</em> should be one of <em>degrees</em> for angles, <em>Ang</em> for lengths,
<em>1e-6/Ang^2</em> for SLDs.</p>
<p><em>default value</em> will be the initial value for  the model when it
is selected, or when an initial value is not otherwise specified.</p>
<p><em>limits = [lb, ub]</em> are the hard limits on the parameter value, used to
limit the polydispersity density function.  In the fit, the parameter limits
given to the fit are the limits  on the central value of the parameter.
If there is polydispersity, it will evaluate parameter values outside
the fit limits, but not outside the hard limits specified in the model.
If there are no limits, use +/-inf imported from numpy.</p>
<p><em>type</em> indicates how the parameter will be used.  “volume” parameters
will be used in all functions.  “orientation” parameters are not passed,
but will be used to convert from <em>qx</em>, <em>qy</em> to <em>qa</em>, <em>qb</em>, <em>qc</em> in calls to
<em>Iqxy</em> and <em>Imagnetic</em>.  If <em>type</em> is the empty string, the parameter will
be used in all of <em>Iq</em>, <em>Iqxy</em> and <em>Imagnetic</em>.  “sld” parameters
can automatically be promoted to magnetic parameters, each of which
will have a magnitude and a direction, which may be different from
other sld parameters. The volume parameters are used for calls
to form_volume within the kernel (required for volume normalization),
to shell_volume (for hollow shapes), and to radius_effective (for
structure factor interactions) respectively.</p>
<p><em>description</em> is a short description of the parameter.  This will
be displayed in the parameter table and used as a tool tip for the
parameter value in the user interface.</p>
<p>Additional values can be set after the parameter is created:</p>
<ul class="simple">
<li><em>length</em> is the length of the field if it is a vector field</li>
<li><em>length_control</em> is the parameter which sets the vector length</li>
<li><em>is_control</em> is True if the parameter is a control parameter for a vector</li>
<li><em>polydisperse</em> is true if the parameter accepts a polydispersity</li>
<li><em>relative_pd</em> is true if that polydispersity is a portion of the
value (so a 10% length dipsersity would use a polydispersity value
of 0.1) rather than absolute dispersisity (such as an angle plus or
minus 15 degrees).</li>
</ul>
<p><em>choices</em> is the option names for a drop down list of options, as for
example, might be used to set the value of a shape parameter.</p>
<p>Control parameters are used for variant models such as <a class="reference internal" href="../../user/models/rpa.html#rpa"><span class="std std-ref">rpa</span></a> which
have different cases with different parameters, as well as models
like <em>spherical_sld</em> with its user defined number of shells.
The control parameter should appear in the parameter table along with the
parameters it is is controlling.  For variant models, use <em>[CASES]</em> in
place of the parameter limits Within the parameter definition table,
with case names such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CASES</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;diblock copolymer&quot;</span><span class="p">,</span> <span class="s2">&quot;triblock copolymer&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>This should give <em>limits=[[case1, case2, …]]</em>, but the model loader
translates it to <em>limits=[0, len(CASES)-1]</em>, and adds <em>choices=CASES</em> to
the <a class="reference internal" href="#sasmodels.modelinfo.Parameter" title="sasmodels.modelinfo.Parameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code></a> definition. Note that models can use a list of
cases as a parameter without it being a control parameter.  Either way,
the parameter is sent to the model evaluator as <em>float(choice_num)</em>,
where choices are numbered from 0. <a class="reference internal" href="#sasmodels.modelinfo.ModelInfo.get_hidden_parameters" title="sasmodels.modelinfo.ModelInfo.get_hidden_parameters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModelInfo.get_hidden_parameters()</span></code></a>
will determine which parameers to display.</p>
<p>The class contructor should not be called directly, but instead the
parameter table is built using <a class="reference internal" href="#sasmodels.modelinfo.make_parameter_table" title="sasmodels.modelinfo.make_parameter_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_parameter_table()</span></code></a> and
<a class="reference internal" href="#sasmodels.modelinfo.parse_parameter" title="sasmodels.modelinfo.parse_parameter"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_parameter()</span></code></a> therein.</p>
<dl class="method">
<dt id="sasmodels.modelinfo.Parameter.as_definition">
<code class="descname">as_definition</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#Parameter.as_definition"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Declare space for the variable in a parameter structure.</p>
<p>For example, the parameter thickness with length 3 will
return “double thickness[3];”, with no spaces before and
no new line character afterward.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.modelinfo.Parameter.as_function_argument">
<code class="descname">as_function_argument</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#Parameter.as_function_argument"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Declare the variable as a function argument.</p>
<p>For example, the parameter thickness with length 3 will
return “double *thickness”, with no spaces before and
no comma afterward.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.modelinfo.ParameterTable">
<em class="property">class </em><code class="descclassname">sasmodels.modelinfo.</code><code class="descname">ParameterTable</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#ParameterTable"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>ParameterTable manages the list of available parameters.</p>
<p>There are a couple of complications which mean that the list of parameters
for the kernel differs from the list of parameters that the user sees.</p>
<p>(1) Common parameters.  Scale and background are implicit to every model,
but are not passed to the kernel.</p>
<p>(2) Vector parameters.  Vector parameters are passed to the kernel as a
pointer to an array, e.g., thick[], but they are seen by the user as n
separate parameters thick1, thick2, …</p>
<p>Therefore, the parameter table is organized by how it is expected to be
used. The following information is needed to set up the kernel functions:</p>
<ul class="simple">
<li><em>kernel_parameters</em> is the list of parameters in the kernel parameter
table, with vector parameter p declared as p[].</li>
<li><em>iq_parameters</em> is the list of parameters to the Iq(q, …) function,
with vector parameter p sent as p[].</li>
<li><em>form_volume_parameters</em> is the list of parameters to the form_volume(…)
function, with vector parameter p sent as p[].</li>
</ul>
<p>Problem details, which sets up the polydispersity loops, requires the
following:</p>
<ul class="simple">
<li><em>theta_offset</em> is the offset of the theta parameter in the kernel parameter
table, with vector parameters counted as n individual parameters
p1, p2, …, or offset is -1 if there is no theta parameter.</li>
<li><em>max_pd</em> is the maximum number of polydisperse parameters, with vector
parameters counted as n individual parameters p1, p2, …  Note that
this number is limited to sasmodels.modelinfo.MAX_PD.</li>
<li><em>npars</em> is the total number of parameters to the kernel, with vector
parameters counted as n individual parameters p1, p2, …</li>
<li><em>common_parameters</em> is the list of common parameters, with a unique
copy for each model so that structure factors can have a default
background of 0.0.</li>
<li><em>call_parameters</em> is the complete list of parameters to the kernel,
including scale and background, with vector parameters recorded as
individual parameters p1, p2, …</li>
<li><em>active_1d</em> is the set of names that may be polydisperse for 1d data</li>
<li><em>active_2d</em> is the set of names that may be polydisperse for 2d data</li>
</ul>
<p>User parameters are the set of parameters visible to the user, including
the scale and background parameters that the kernel does not see.  User
parameters don’t use vector notation, and instead use p1, p2, …</p>
<dl class="method">
<dt id="sasmodels.modelinfo.ParameterTable.check_angles">
<code class="descname">check_angles</code><span class="sig-paren">(</span><em>strict=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#ParameterTable.check_angles"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Check that orientation angles are theta, phi and possibly psi.</p>
<p><em>strict</em> should be True when checking a parameter table defined
in a model file, but False when checking from mixture models, etc.,
where the parameters aren’t being passed to a calculator directly.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.modelinfo.ParameterTable.check_duplicates">
<code class="descname">check_duplicates</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#ParameterTable.check_duplicates"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Check for duplicate parameter names</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.modelinfo.ParameterTable.set_zero_background">
<code class="descname">set_zero_background</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#ParameterTable.set_zero_background"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Set the default background to zero for this model.  This is done for
structure factor models.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.modelinfo.ParameterTable.user_parameters">
<code class="descname">user_parameters</code><span class="sig-paren">(</span><em>pars</em>, <em>is2d=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#ParameterTable.user_parameters"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the list of parameters for the given data type.</p>
<p>Vector parameters are expanded in place.  If multiple parameters
share the same vector length, then the parameters will be interleaved
in the result.  The control parameters come first.  For example,
if the parameter table is ordered as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sld_core</span>
<span class="n">sld_shell</span><span class="p">[</span><span class="n">num_shells</span><span class="p">]</span>
<span class="n">sld_solvent</span>
<span class="n">thickness</span><span class="p">[</span><span class="n">num_shells</span><span class="p">]</span>
<span class="n">num_shells</span>
</pre></div>
</div>
<p>and <em>pars[num_shells]=2</em> then the returned list will be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">num_shells</span>
<span class="n">scale</span>
<span class="n">background</span>
<span class="n">sld_core</span>
<span class="n">sld_shell1</span>
<span class="n">thickness1</span>
<span class="n">sld_shell2</span>
<span class="n">thickness2</span>
<span class="n">sld_solvent</span>
</pre></div>
</div>
<p>Note that shell/thickness pairs are grouped together in the result
even though they were not grouped in the incoming table.  The control
parameter is always returned first since the GUI will want to set it
early, and rerender the table when it is changed.</p>
<p>Parameters marked as sld will automatically have a set of associated
magnetic parameters (p_M0, p_mtheta, p_mphi), as well as polarization
information (up_theta, up_frac_i, up_frac_f).</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.modelinfo.derive_table">
<code class="descclassname">sasmodels.modelinfo.</code><code class="descname">derive_table</code><span class="sig-paren">(</span><em>table</em>, <em>insert</em>, <em>remove</em>, <em>insert_after=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#derive_table"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create a derived parameter table.</p>
<p>Parameters given in <em>insert</em> are added to the table and parameters
named in <em>remove</em> are deleted from the table. If <em>insert_after</em> is
provided, then it indicates where in the new parameter table the
parameters are inserted.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.modelinfo.expand_pars">
<code class="descclassname">sasmodels.modelinfo.</code><code class="descname">expand_pars</code><span class="sig-paren">(</span><em>partable</em>, <em>pars=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#expand_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create a parameter set from key-value pairs.</p>
<p><em>pars</em> are the key-value pairs to use for the parameters.  Any
parameters not specified in <em>pars</em> are set from the <em>partable</em> defaults.</p>
<p>If <em>pars</em> references vector fields, such as thickness[n], then support
different ways of assigning the parameter values, including assigning a
specific value (e.g., thickness3=50.0), assigning a new value to all
(e.g., thickness=50.0) or assigning values using list notation.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.modelinfo.isstr">
<code class="descclassname">sasmodels.modelinfo.</code><code class="descname">isstr</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#isstr"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return True if the object is a string.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.modelinfo.make_model_info">
<code class="descclassname">sasmodels.modelinfo.</code><code class="descname">make_model_info</code><span class="sig-paren">(</span><em>kernel_module</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#make_model_info"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Extract the model definition from the loaded kernel module.</p>
<p>Fill in default values for parts of the module that are not provided.</p>
<p>Note: vectorized Iq and Iqac/Iqabc functions will be created for python
models when the model is first called, not when the model is loaded.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.modelinfo.make_parameter_table">
<code class="descclassname">sasmodels.modelinfo.</code><code class="descname">make_parameter_table</code><span class="sig-paren">(</span><em>pars</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#make_parameter_table"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Construct a parameter table from a list of parameter definitions.</p>
<p>This is used by the module processor to convert the parameter block into
the parameter table seen in the <a class="reference internal" href="#sasmodels.modelinfo.ModelInfo" title="sasmodels.modelinfo.ModelInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelInfo</span></code></a> for the module.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.modelinfo.parse_parameter">
<code class="descclassname">sasmodels.modelinfo.</code><code class="descname">parse_parameter</code><span class="sig-paren">(</span><em>name</em>, <em>units=''</em>, <em>default=nan</em>, <em>user_limits=None</em>, <em>ptype=''</em>, <em>description=''</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#parse_parameter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Parse an individual parameter from the parameter definition block.</p>
<p>This does type and value checking on the definition, leading
to early failure in the model loading process and easier debugging.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.modelinfo.prefix_parameter">
<code class="descclassname">sasmodels.modelinfo.</code><code class="descname">prefix_parameter</code><span class="sig-paren">(</span><em>par</em>, <em>prefix</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#prefix_parameter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a copy of the parameter with its name prefixed.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.modelinfo.suffix_parameter">
<code class="descclassname">sasmodels.modelinfo.</code><code class="descname">suffix_parameter</code><span class="sig-paren">(</span><em>par</em>, <em>suffix</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/modelinfo.html#suffix_parameter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a copy of the parameter with its name prefixed.</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-sasmodels.multiscat">
<span id="sasmodels-multiscat-module"></span><h2>sasmodels.multiscat module</h2>
<p>Multiple scattering calculator</p>
<p>Calculate multiple scattering using 2D FFT convolution.</p>
<p>Usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python -m sasmodels.multiscat [options] model_name model_par=value ...

Options include:
-h, --help: show help and exit
-n, --nq: the number of mesh points (dq = qmax*window/nq)
-o, --outfile: save results to outfile.txt and outfile_powers.txt
-p, --probability: the scattering probability (0.1)
-q, --qmax: that max q that you care about (0.5)
-r, --random: generate a random parameter set
-s, --seed: generate a random parameter set with a given seed
-w, --window: the extension window (q is calculated for qmax*window)
-2, --2d: perform the calculation for an oriented pattern
</pre></div>
</div>
<p>Assume the probability of scattering is <span class="math notranslate nohighlight">\(p\)</span>. After each scattering event,
<span class="math notranslate nohighlight">\(1-p\)</span> neutrons will leave the system and go to the detector, and the remaining
<span class="math notranslate nohighlight">\(p\)</span> will scatter again.</p>
<p>Let the scattering probability for <span class="math notranslate nohighlight">\(n\)</span> scattering event at <span class="math notranslate nohighlight">\(q\)</span> be <span class="math notranslate nohighlight">\(f_n(q)\)</span>,
with</p>
<div class="math notranslate nohighlight">
\[f_1(q) = \frac{I_1(q)}{\int I_1(q) {\rm d}q}\]</div>
<p>for <span class="math notranslate nohighlight">\(I_1(q)\)</span>, the single scattering from the system. After two scattering
events, the scattering probability will be the convolution of the first
scattering and itself, or <span class="math notranslate nohighlight">\(f_2(q) = (f_1*f_1)(q)\)</span>.  After <span class="math notranslate nohighlight">\(n\)</span> events it will be
<span class="math notranslate nohighlight">\(f_n(q) = (f_1 * \cdots * f_1)(q)\)</span>.  The total scattering is calculated
as the weighted sum of <span class="math notranslate nohighlight">\(f_k\)</span>, with weights following the Poisson distribution</p>
<div class="math notranslate nohighlight">
\[P(k; \lambda) = \frac{\lambda^k e^{-\lambda}}{k!}\]</div>
<p>for <span class="math notranslate nohighlight">\(\lambda\)</span> determined by the total thickness divided by the mean
free path between scattering, giving</p>
<div class="math notranslate nohighlight">
\[I(q) = \sum_{k=0}^\infty P(k; \lambda) f_k(q)\]</div>
<p>The <span class="math notranslate nohighlight">\(k=0\)</span> term is ignored since it involves no scattering.
We cut the series when cumulative probability is less than cutoff <span class="math notranslate nohighlight">\(C=99\%\)</span>,
which is <span class="math notranslate nohighlight">\(\max n\)</span> such that</p>
<div class="math notranslate nohighlight">
\[\sum_{k=1}^n \frac{P(k; \lambda)}{1 - P(0; \lambda)} &lt; C\]</div>
<p>Using the convolution theorem, where <span class="math notranslate nohighlight">\(F = \mathcal{F}(f)\)</span> is the
Fourier transform,</p>
<div class="math notranslate nohighlight">
\[f * g = \mathcal{F}^{-1}\{\mathcal{F}\{f\} \cdot \mathcal{F}\{g\}\}\]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\[f * \ldots * f = \mathcal{F}^{-1}\{ F^n \}\]</div>
<p>Since the Fourier transform is a linear operator, we can move the polynomial
expression for the convolution into the transform, giving</p>
<div class="math notranslate nohighlight">
\[I(q) = \mathcal{F}^{-1}\left\{ \sum_{k=1}^{n} P(k; \lambda) F^k \right\}\]</div>
<p>In the dilute limit <span class="math notranslate nohighlight">\(\lambda \rightarrow 0\)</span> only the <span class="math notranslate nohighlight">\(k=1\)</span> term is active,
and so</p>
<div class="math notranslate nohighlight">
\[P(1; \lambda) = \lambda e^{-\lambda} = \int I_1(q) {\rm d}q\]</div>
<p>therefore we compute</p>
<div class="math notranslate nohighlight">
\[I(q) =
\mathcal{F}^{-1}\left\{
    \sum_{l=1}^{n} \frac{P(k; \lambda)}{P(1; \lambda))} F^k \right\}
\, \int I_1(q) {\rm d}q
= \mathcal{F}^{-1}\left\{
    \sum_{l=1}^{n} \frac{\lambda^{k-1}}{k!} F^k \right\}
\, \int I_1(q) {\rm d}q\]</div>
<p>For speed we may use the fast fourier transform with a power of two.
The resulting <span class="math notranslate nohighlight">\(I(q)\)</span> will be linearly spaced and likely heavily oversampled.
The usual pinhole or slit resolution calculation can performed from these
calculated values.</p>
<p>By default single precision OpenCL is used for the calculation.  Set the
environment variable <em>SAS_OPENCL=none</em> to use double precision numpy FFT
instead.  The OpenCL versions is about 10x faster on an elderly Mac with
Intel HD 4000 graphics.  The single precision numerical artifacts don’t
seem to seriously impact overall accuracy, though they look pretty bad.</p>
<dl class="attribute">
<dt id="sasmodels.multiscat.Calculator">
<code class="descclassname">sasmodels.multiscat.</code><code class="descname">Calculator</code></dt>
<dd><p>alias of <a class="reference internal" href="#sasmodels.multiscat.NumpyCalculator" title="sasmodels.multiscat.NumpyCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.multiscat.NumpyCalculator</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="sasmodels.multiscat.ICalculator">
<em class="property">class </em><code class="descclassname">sasmodels.multiscat.</code><code class="descname">ICalculator</code><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#ICalculator"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Multiple scattering calculator</p>
<dl class="method">
<dt id="sasmodels.multiscat.ICalculator.fft">
<code class="descname">fft</code><span class="sig-paren">(</span><em>Iq</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#ICalculator.fft"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute the forward FFT for an image, real -&gt; complex.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.multiscat.ICalculator.ifft">
<code class="descname">ifft</code><span class="sig-paren">(</span><em>fourier_frame</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#ICalculator.ifft"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute the inverse FFT for an image, complex -&gt; complex.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.multiscat.ICalculator.multiple_scattering">
<code class="descname">multiple_scattering</code><span class="sig-paren">(</span><em>Iq</em>, <em>p</em>, <em>coverage=0.99</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#ICalculator.multiple_scattering"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute multiple scattering for I(q) given scattering probability p.</p>
<p>Given a probability p of scattering with the thickness, the expected
number of scattering events, <span class="math notranslate nohighlight">\(\lambda = -\log(1 - p)\)</span>, giving a
Poisson weighted sum of single, double, triple, etc. scattering patterns.
The number of patterns used is based on coverage (default 99%).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.multiscat.MultipleScattering">
<em class="property">class </em><code class="descclassname">sasmodels.multiscat.</code><code class="descname">MultipleScattering</code><span class="sig-paren">(</span><em>qmin=None</em>, <em>qmax=None</em>, <em>nq=None</em>, <em>window=2</em>, <em>probability=None</em>, <em>coverage=0.99</em>, <em>is2d=False</em>, <em>resolution=None</em>, <em>dtype=dtype('float64')</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#MultipleScattering"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.resolution.Resolution" title="sasmodels.resolution.Resolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.resolution.Resolution</span></code></a></p>
<p>Compute multiple scattering using Fourier convolution.</p>
<p>The fourier steps are determined by <em>qmax</em>, the maximum <span class="math notranslate nohighlight">\(q\)</span> value
desired, <em>nq</em> the number of <span class="math notranslate nohighlight">\(q\)</span> steps and <em>window</em>, the amount
of padding around the circular convolution.  The <span class="math notranslate nohighlight">\(q\)</span> spacing
will be <span class="math notranslate nohighlight">\(\Delta q = 2 q_\mathrm{max} w / n_q\)</span>.  If <em>nq</em> is not
given it will use <span class="math notranslate nohighlight">\(n_q = 2^k\)</span> such that <span class="math notranslate nohighlight">\(\Delta q &lt; q_\mathrm{min}\)</span>.</p>
<p><em>probability</em> is related to the expected number of scattering
events in the sample <span class="math notranslate nohighlight">\(\lambda\)</span> as <span class="math notranslate nohighlight">\(p = 1 - e^{-\lambda}\)</span>.</p>
<p><em>coverage</em> determines how many scattering steps to consider.  The
default is 0.99, which sets <span class="math notranslate nohighlight">\(n\)</span> such that <span class="math notranslate nohighlight">\(1 \ldots n\)</span> covers 99%
of the Poisson probability mass function.</p>
<p><em>is2d</em> is True then 2D scattering is used, otherwise it accepts
and returns 1D scattering.</p>
<p><em>resolution</em> is the resolution function to apply after multiple
scattering.  If present, then the resolution <span class="math notranslate nohighlight">\(q\)</span> vectors will provide
default values for <em>qmin</em>, <em>qmax</em> and <em>nq</em>.</p>
<dl class="method">
<dt id="sasmodels.multiscat.MultipleScattering.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>theory</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#MultipleScattering.apply"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Smear <em>theory</em> by the resolution function, returning <em>Iq</em>.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.multiscat.MultipleScattering.radial_profile">
<code class="descname">radial_profile</code><span class="sig-paren">(</span><em>Iqxy</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#MultipleScattering.radial_profile"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute that radial profile for the given Iqxy grid.  The grid should
be defined as for</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.multiscat.NumpyCalculator">
<em class="property">class </em><code class="descclassname">sasmodels.multiscat.</code><code class="descname">NumpyCalculator</code><span class="sig-paren">(</span><em>dims=None</em>, <em>dtype=dtype('float64')</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#NumpyCalculator"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.multiscat.ICalculator" title="sasmodels.multiscat.ICalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.multiscat.ICalculator</span></code></a></p>
<p>Multiple scattering calculator using numpy fft.</p>
<dl class="method">
<dt id="sasmodels.multiscat.NumpyCalculator.fft">
<code class="descname">fft</code><span class="sig-paren">(</span><em>Iq</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#NumpyCalculator.fft"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute the forward FFT for an image, real -&gt; complex.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.multiscat.NumpyCalculator.ifft">
<code class="descname">ifft</code><span class="sig-paren">(</span><em>fourier_frame</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#NumpyCalculator.ifft"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute the inverse FFT for an image, complex -&gt; complex.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.multiscat.NumpyCalculator.multiple_scattering">
<code class="descname">multiple_scattering</code><span class="sig-paren">(</span><em>Iq</em>, <em>p</em>, <em>coverage=0.99</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#NumpyCalculator.multiple_scattering"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute multiple scattering for I(q) given scattering probability p.</p>
<p>Given a probability p of scattering with the thickness, the expected
number of scattering events, <span class="math notranslate nohighlight">\(\lambda = -\log(1 - p)\)</span>, giving a
Poisson weighted sum of single, double, triple, etc. scattering patterns.
The number of patterns used is based on coverage (default 99%).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.multiscat.OpenclCalculator">
<em class="property">class </em><code class="descclassname">sasmodels.multiscat.</code><code class="descname">OpenclCalculator</code><span class="sig-paren">(</span><em>dims</em>, <em>dtype=dtype('float64')</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#OpenclCalculator"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.multiscat.ICalculator" title="sasmodels.multiscat.ICalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.multiscat.ICalculator</span></code></a></p>
<p>Multiple scattering calculator using OpenCL via pyfft.</p>
<dl class="method">
<dt id="sasmodels.multiscat.OpenclCalculator.fft">
<code class="descname">fft</code><span class="sig-paren">(</span><em>Iq</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#OpenclCalculator.fft"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute the forward FFT for an image, real -&gt; complex.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.multiscat.OpenclCalculator.ifft">
<code class="descname">ifft</code><span class="sig-paren">(</span><em>fourier_frame</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#OpenclCalculator.ifft"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute the inverse FFT for an image, complex -&gt; complex.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.multiscat.OpenclCalculator.multiple_scattering">
<code class="descname">multiple_scattering</code><span class="sig-paren">(</span><em>Iq</em>, <em>p</em>, <em>coverage=0.99</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#OpenclCalculator.multiple_scattering"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute multiple scattering for I(q) given scattering probability p.</p>
<p>Given a probability p of scattering with the thickness, the expected
number of scattering events, <span class="math notranslate nohighlight">\(\lambda = -\log(1 - p)\)</span>, giving a
Poisson weighted sum of single, double, triple, etc. scattering patterns.
The number of patterns used is based on coverage (default 99%).</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.multiscat.OpenclCalculator.polyval1d">
<code class="descname">polyval1d</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.multiscat.OpenclCalculator.polyval1f">
<code class="descname">polyval1f</code><em class="property"> = None</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.multiscat.annular_average">
<code class="descclassname">sasmodels.multiscat.</code><code class="descname">annular_average</code><span class="sig-paren">(</span><em>qxy</em>, <em>Iqxy</em>, <em>qbins</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#annular_average"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute annular average of points in <em>Iqxy</em> at <em>qbins</em>.  The <span class="math notranslate nohighlight">\(q_x\)</span>, <span class="math notranslate nohighlight">\(q_y\)</span>
coordinates for <em>Iqxy</em> are given in <em>qxy</em>.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.multiscat.main">
<code class="descclassname">sasmodels.multiscat.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#main"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Command line interface to multiple scattering calculator.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.multiscat.parse_pars">
<code class="descclassname">sasmodels.multiscat.</code><code class="descname">parse_pars</code><span class="sig-paren">(</span><em>model</em>, <em>opts</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#parse_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Parse par=val arguments from the command line.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.multiscat.plotxy">
<code class="descclassname">sasmodels.multiscat.</code><code class="descname">plotxy</code><span class="sig-paren">(</span><em>q</em>, <em>Iq</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#plotxy"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Plot q, Iq or (qx, qy), Iqxy.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.multiscat.rebin">
<code class="descclassname">sasmodels.multiscat.</code><code class="descname">rebin</code><span class="sig-paren">(</span><em>x</em>, <em>I</em>, <em>xo</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#rebin"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Rebin from edges <em>x</em>, bins I into edges <em>xo</em>.</p>
<p><em>x</em> and <em>xo</em> should be monotonically increasing.</p>
<p>If <em>x</em> has duplicate values, then all corresponding values at I(x) will
be effectively summed into the same bin.  If <em>xo</em> has duplicate values,
the first bin will contain the entire contents and subsequent bins will
contain zeros.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.multiscat.scattering_coeffs">
<code class="descclassname">sasmodels.multiscat.</code><code class="descname">scattering_coeffs</code><span class="sig-paren">(</span><em>p</em>, <em>coverage=0.99</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#scattering_coeffs"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the coefficients of the scattering powers for transmission
probability <em>p</em>.  This is just the corresponding values for the
Poisson distribution for <span class="math notranslate nohighlight">\(\lambda = -\ln(1-p)\)</span> such that
<span class="math notranslate nohighlight">\(\sum_{k = 0 \ldots n} P(k; \lambda)\)</span> is larger than <em>coverage</em>.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.multiscat.scattering_powers">
<code class="descclassname">sasmodels.multiscat.</code><code class="descname">scattering_powers</code><span class="sig-paren">(</span><em>Iq</em>, <em>n</em>, <em>dtype='f'</em>, <em>transform=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#scattering_powers"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Calculate the scattering powers up to <em>n</em>.</p>
<p>This includes <em>k=1</em> even though it should just be <em>Iq</em> itself</p>
<p>The frames are unweighted; to weight scale by <span class="math notranslate nohighlight">\(\lambda^k e^{-\lambda}/k!\)</span>.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.multiscat.truncated_poisson_invcdf">
<code class="descclassname">sasmodels.multiscat.</code><code class="descname">truncated_poisson_invcdf</code><span class="sig-paren">(</span><em>coverage</em>, <em>L</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/multiscat.html#truncated_poisson_invcdf"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return smallest k such that cdf(k; L) &gt; coverage from the truncated Poisson
probability excluding k=0</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.product">
<span id="sasmodels-product-module"></span><h2>sasmodels.product module</h2>
<div class="section" id="product-model">
<h3>Product model</h3>
<p>The product model multiplies the structure factor by the form factor,
modulated by the effective radius of the form.  The resulting model
has a attributes of both the model description (with parameters, etc.)
and the module evaluator (with call, release, etc.).</p>
<p>To use it, first load form factor P and structure factor S, then create
<em>make_product_info(P, S)</em>.</p>
<p>The P&#64;S models is somewhat complicated because there are many special
parameters that need to be handled in particular ways.  Much of the
code is used to figure out what special parameters we have, where to
find them in the P&#64;S model inputs and how to distribute them to the underlying
P and S model calculators.</p>
<p>The parameter packet received by the P&#64;S is a <code class="xref py py-class docutils literal notranslate"><span class="pre">details.CallDetails</span></code>
structure along with a data vector. The CallDetails structure indicates which
parameters are polydisperse, the length of the distribution, and where to
find it in the data vector.  The distributions are ordered from longest to
shortest, with length 1 distributions filling out the distribution set.  That
way the kernel calculator doesn’t have to check if it needs another nesting
level since it is always there.  The data vector consists of a list of target
values for the parameters, followed by a concatenation of the distribution
values, and then followed by a concatenation of the distribution weights.
Given the combined details and data for P&#64;S, we must decompose them in to
details for P and details for S separately, which unfortunately requires
intimate knowledge of the data structures and tricky code.</p>
<p>The special parameters are:</p>
<ul>
<li><dl class="first docutils">
<dt><em>scale</em> and <em>background</em>:</dt>
<dd><p class="first last">First two parameters of the value list in each of P, S and P&#64;S.
When decomposing P&#64;S parameters, ignore <em>scale</em> and <em>background</em>,
instead using 1 and 0 for the first two slots of both P and S.
After calling P and S individually, the results are combined as
<code class="code docutils literal notranslate"><span class="pre">volfraction*scale*P*S</span> <span class="pre">+</span> <span class="pre">background</span></code>.  The <em>scale</em> and
<em>background</em> do not show up in the polydispersity structure so
they are easy to handle.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>volfraction</em>:</dt>
<dd><p class="first">Always the first parameter of S, but it may also be in P. If it is in P,
then <em>P.volfraction</em> is used in the combined P&#64;S list, and
<em>S.volfraction</em> is elided, otherwise <em>S.volfraction</em> is used. If we
are using <em>volfraction</em> from P we can treat it like all the other P
parameters when calling P, but when calling S we need to insert the
<em>P.volfraction</em> into data vector for S and assign a slot of length 1
in the distribution. Because we are using the original layout of the
distribution vectors from P&#64;S, but copying it into private data
vectors for S and P, we are free to “borrow” a P slots to store the
missing <em>S.volfraction</em> distribution.  We use the <em>P.volfraction</em>
slot itself but any slot will work.</p>
<p class="last">For hollow shapes, <em>volfraction</em> represents the volume fraction of
material but S needs the volume fraction enclosed by the shape. The
answer is to scale the user specified volume fraction by the form:shell
ratio computed from the average form volume and average shell volume
returned from P. Use the original <em>volfraction</em> divided by <em>shell_volume</em>
to compute the number density, and scale P&#64;S by that to get absolute
scaling on the final <em>I(q)</em>. The <em>scale</em> for P&#64;S should therefore usually
be one.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>radius_effective</em>:</dt>
<dd><p class="first last">Always the second parameter of S and always part of P&#64;S, but never in P.
The value may be calculated using <em>P.radius_effective()</em> or it
may be set to the <em>radius_effective</em> value in P&#64;S, depending on
<em>radius_effective_mode</em>.  If part of S, the value may be polydisperse.
If calculated by P, then it will be the weighted average of effective
radii computed for the polydisperse shape parameters.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>structure_factor_mode</em></dt>
<dd><p class="first last">If P&#64;S supports beta approximation (i.e., if it has the <em>Fq</em> function that
returns &lt;FF*&gt; and &lt;F&gt;&lt;F*&gt;), then <em>structure_factor_mode</em> will be added
to the P&#64;S parameters right after the S parameters.  This mode may be 0
for the monodisperse approximation or 1 for the beta approximation.  We
will add more values here as we implemented more complicated operations,
but for now P and S must be computed separately.  If beta, then we
return <em>I = scale volfrac/volume ( &lt;FF&gt; + &lt;F&gt;^2 (S-1)) + background</em>.
If not beta then return <em>I = scale/volume P S + background</em> .  In both
cases, return the appropriate immediate values.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>radius_effective_mode</em></dt>
<dd><p class="first last">If P defines the <em>radius_effective</em> function (and therefore
<em>P.info.radius_effective_modes</em> is a list of effective radius modes),
then <em>radius_effective_mode</em> will be the final parameter in P&#64;S.  Mode
will be zero if <em>radius_effective</em> is defined by the user using the S
parameter; any other value and the <em>radius_effective</em> parameter will be
filled in from the value computed in P.  In the latter case, the
polydispersity information for <em>S.radius_effective</em> will need to be
suppressed, with pd length set to 1, the first value set to the
effective radius and the first weight set to 1.  Do this after composing
the S data vector so the inputs are left untouched.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>regular parameters</em></dt>
<dd><p class="first last">The regular P parameters form a block of length <em>P.info.npars</em> at the
start of the data vector (after scale and background).  These will be
followed by <em>S.effective_radius</em>, and <em>S.volfraction</em> (if <em>P.volfraction</em>
is absent), and then the regular S parameters.  The P and S blocks can
be copied as a group into the respective P and S data vectors.
We can copy the distribution value and weight vectors untouched to both
the P and S data vectors since they are referenced by offset and length.
We can update the radius_effective slots in the P data vector with
<em>P.radius_effective()</em> if needed.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>magnetic parameters</em></dt>
<dd><p class="first last">For each P parameter that is an SLD there will be a set of three magnetic
parameters tacked on to P&#64;S after the regular P and S and after the
special <em>structure_factor_mode</em> and <em>radius_effective_mode</em>.  These
can be copied as a group after the regular P parameters.  There won’t
be any magnetic S parameters.</p>
</dd>
</dl>
</li>
</ul>
<dl class="class">
<dt id="sasmodels.product.ProductKernel">
<em class="property">class </em><code class="descclassname">sasmodels.product.</code><code class="descname">ProductKernel</code><span class="sig-paren">(</span><em>model_info</em>, <em>p_kernel</em>, <em>s_kernel</em>, <em>q</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/product.html#ProductKernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.Kernel" title="sasmodels.kernel.Kernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.Kernel</span></code></a></p>
<p>Instantiated kernel for product model.</p>
<dl class="method">
<dt id="sasmodels.product.ProductKernel.Iq">
<code class="descname">Iq</code><span class="sig-paren">(</span><em>call_details</em>, <em>values</em>, <em>cutoff</em>, <em>magnetic</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/product.html#ProductKernel.Iq"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns I(q) from the polydisperse average scattering.</p>
<div class="math notranslate nohighlight">
\[I(q) = \text{scale} \cdot P(q) + \text{background}\]</div>
<p>With the correct choice of model and contrast, setting <em>scale</em> to
the volume fraction <span class="math notranslate nohighlight">\(V_f\)</span> of particles should match the measured
absolute scattering.  Some models (e.g., vesicle) have volume fraction
built into the model, and do not need an additional scale.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.product.ProductKernel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/product.html#ProductKernel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free resources associated with the kernel.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.product.ProductModel">
<em class="property">class </em><code class="descclassname">sasmodels.product.</code><code class="descname">ProductModel</code><span class="sig-paren">(</span><em>model_info</em>, <em>P</em>, <em>S</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/product.html#ProductModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.kernel.KernelModel" title="sasmodels.kernel.KernelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.kernel.KernelModel</span></code></a></p>
<p>Model definition for product model.</p>
<dl class="attribute">
<dt id="sasmodels.product.ProductModel.P">
<code class="descname">P</code><em class="property"> = None</em></dt>
<dd><p>Form factor modelling individual particles.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.product.ProductModel.S">
<code class="descname">S</code><em class="property"> = None</em></dt>
<dd><p>Structure factor modelling interaction between particles.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.product.ProductModel.make_kernel">
<code class="descname">make_kernel</code><span class="sig-paren">(</span><em>q_vectors</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/product.html#ProductModel.make_kernel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Instantiate a kernel for evaluating the model at <em>q_vectors</em>.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.product.ProductModel.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/product.html#ProductModel.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Free resources associated with the model.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.product.make_extra_pars">
<code class="descclassname">sasmodels.product.</code><code class="descname">make_extra_pars</code><span class="sig-paren">(</span><em>p_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/product.html#make_extra_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create parameters for structure factor and effective radius modes.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.product.make_product_info">
<code class="descclassname">sasmodels.product.</code><code class="descname">make_product_info</code><span class="sig-paren">(</span><em>p_info</em>, <em>s_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/product.html#make_product_info"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create info block for product model.</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-sasmodels.resolution">
<span id="sasmodels-resolution-module"></span><h2>sasmodels.resolution module</h2>
<p>Define the resolution functions for the data.</p>
<p>This defines classes for 1D and 2D resolution calculations.</p>
<dl class="class">
<dt id="sasmodels.resolution.Resolution">
<em class="property">class </em><code class="descclassname">sasmodels.resolution.</code><code class="descname">Resolution</code><a class="reference internal" href="../../_modules/sasmodels/resolution.html#Resolution"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class defining a 1D resolution function.</p>
<p><em>q</em> is the set of q values at which the data is measured.</p>
<p><em>q_calc</em> is the set of q values at which the theory needs to be evaluated.
This may extend and interpolate the q values.</p>
<p><em>apply</em> is the method to call with I(q_calc) to compute the resolution
smeared theory I(q).</p>
<dl class="method">
<dt id="sasmodels.resolution.Resolution.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>theory</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#Resolution.apply"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Smear <em>theory</em> by the resolution function, returning <em>Iq</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.resolution.Resolution.q">
<code class="descname">q</code><em class="property"> = None</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.resolution.Resolution.q_calc">
<code class="descname">q_calc</code><em class="property"> = None</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.resolution.Perfect1D">
<em class="property">class </em><code class="descclassname">sasmodels.resolution.</code><code class="descname">Perfect1D</code><span class="sig-paren">(</span><em>q</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#Perfect1D"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.resolution.Resolution" title="sasmodels.resolution.Resolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.resolution.Resolution</span></code></a></p>
<p>Resolution function to use when there is no actual resolution smearing
to be applied.  It has the same interface as the other resolution
functions, but returns the identity function.</p>
<dl class="method">
<dt id="sasmodels.resolution.Perfect1D.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>theory</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#Perfect1D.apply"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Smear <em>theory</em> by the resolution function, returning <em>Iq</em>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.resolution.Pinhole1D">
<em class="property">class </em><code class="descclassname">sasmodels.resolution.</code><code class="descname">Pinhole1D</code><span class="sig-paren">(</span><em>q</em>, <em>q_width</em>, <em>q_calc=None</em>, <em>nsigma=(2.5</em>, <em>3.0)</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#Pinhole1D"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.resolution.Resolution" title="sasmodels.resolution.Resolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.resolution.Resolution</span></code></a></p>
<p>Pinhole aperture with q-dependent gaussian resolution.</p>
<p><em>q</em> points at which the data is measured.</p>
<p><em>q_width</em> gaussian 1-sigma resolution at each data point.</p>
<p><em>q_calc</em> is the list of points to calculate, or None if this should
be estimated from the <em>q</em> and <em>q_width</em>.</p>
<p><em>nsigma</em> is the width of the resolution function.  Should be 2.5.
See <a class="reference internal" href="#sasmodels.resolution.pinhole_resolution" title="sasmodels.resolution.pinhole_resolution"><code class="xref py py-func docutils literal notranslate"><span class="pre">pinhole_resolution()</span></code></a> for details.</p>
<dl class="method">
<dt id="sasmodels.resolution.Pinhole1D.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>theory</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#Pinhole1D.apply"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Smear <em>theory</em> by the resolution function, returning <em>Iq</em>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.resolution.Slit1D">
<em class="property">class </em><code class="descclassname">sasmodels.resolution.</code><code class="descname">Slit1D</code><span class="sig-paren">(</span><em>q</em>, <em>qx_width</em>, <em>qy_width=0.0</em>, <em>q_calc=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#Slit1D"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.resolution.Resolution" title="sasmodels.resolution.Resolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.resolution.Resolution</span></code></a></p>
<p>Slit aperture with resolution function.</p>
<p><em>q</em> points at which the data is measured.</p>
<p><em>qx_width</em> slit width in qx</p>
<p><em>qy_width</em> slit height in qy</p>
<p><em>q_calc</em> is the list of points to calculate, or None if this should
be estimated from the <em>q</em> and <em>q_width</em>.</p>
<p>The <em>weight_matrix</em> is computed by <code class="xref py py-func docutils literal notranslate"><span class="pre">slit1d_resolution()</span></code></p>
<dl class="method">
<dt id="sasmodels.resolution.Slit1D.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>theory</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#Slit1D.apply"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Smear <em>theory</em> by the resolution function, returning <em>Iq</em>.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.resolution.apply_resolution_matrix">
<code class="descclassname">sasmodels.resolution.</code><code class="descname">apply_resolution_matrix</code><span class="sig-paren">(</span><em>weight_matrix</em>, <em>theory</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#apply_resolution_matrix"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Apply the resolution weight matrix to the computed theory function.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.resolution.pinhole_resolution">
<code class="descclassname">sasmodels.resolution.</code><code class="descname">pinhole_resolution</code><span class="sig-paren">(</span><em>q_calc</em>, <em>q</em>, <em>q_width</em>, <em>nsigma=(2.5</em>, <em>3.0)</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#pinhole_resolution"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute the convolution matrix <em>W</em> for pinhole resolution 1-D data.</p>
<p>Each row <em>W[i]</em> determines the normalized weight that the corresponding
points <em>q_calc</em> contribute to the resolution smeared point <em>q[i]</em>.  Given
<em>W</em>, the resolution smearing can be computed using <em>dot(W,q)</em>.</p>
<p>Note that resolution is limited to <span class="math notranslate nohighlight">\(\pm 2.5 \sigma\)</span>.[1]  The true resolution
function is a broadened triangle, and does not extend over the entire
range <span class="math notranslate nohighlight">\((-\infty, +\infty)\)</span>.  It is important to impose this limitation
since some models fall so steeply that the weighted value in gaussian
tails would otherwise dominate the integral.</p>
<p><em>q_calc</em> must be increasing.  <em>q_width</em> must be greater than zero.</p>
<p>[1] Barker, J. G., and J. S. Pedersen. 1995. Instrumental Smearing Effects
in Radially Symmetric Small-Angle Neutron Scattering by Numerical and
Analytical Methods. Journal of Applied Crystallography 28 (2): 105–14.
<a class="reference external" href="https://doi.org/10.1107/S0021889894010095">https://doi.org/10.1107/S0021889894010095</a>.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.resolution.slit_resolution">
<code class="descclassname">sasmodels.resolution.</code><code class="descname">slit_resolution</code><span class="sig-paren">(</span><em>q_calc</em>, <em>q</em>, <em>width</em>, <em>height</em>, <em>n_height=30</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#slit_resolution"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Build a weight matrix to compute <em>I_s(q)</em> from <em>I(q_calc)</em>, given
<span class="math notranslate nohighlight">\(q_\perp\)</span> = <em>width</em> and <span class="math notranslate nohighlight">\(q_\parallel\)</span> = <em>height</em>.  <em>n_height</em> is
is the number of steps to use in the integration over <span class="math notranslate nohighlight">\(q_\parallel\)</span>
when both <span class="math notranslate nohighlight">\(q_\perp\)</span> and <span class="math notranslate nohighlight">\(q_\parallel\)</span> are non-zero.</p>
<p>Each <span class="math notranslate nohighlight">\(q\)</span> can have an independent width and height value even though
current instruments use the same slit setting for all measured points.</p>
<p>If slit height is large relative to width, use:</p>
<div class="math notranslate nohighlight">
\[I_s(q_i) = \frac{1}{\Delta q_\perp}
    \int_0^{\Delta q_\perp}
        I\left(\sqrt{q_i^2 + q_\perp^2}\right) \,dq_\perp\]</div>
<p>If slit width is large relative to height, use:</p>
<div class="math notranslate nohighlight">
\[I_s(q_i) = \frac{1}{2 \Delta q_\parallel}
    \int_{-\Delta q_\parallel}^{\Delta q_\parallel}
        I\left(|q_i + q_\parallel|\right) \,dq_\parallel\]</div>
<p>For a mixture of slit width and height use:</p>
<div class="math notranslate nohighlight">
\[I_s(q_i) = \frac{1}{2 \Delta q_\parallel \Delta q_\perp}
    \int_{-\Delta q_\parallel}^{\Delta q_\parallel}
    \int_0^{\Delta q_\perp}
        I\left(\sqrt{(q_i + q_\parallel)^2 + q_\perp^2}\right)
        \,dq_\perp dq_\parallel\]</div>
<p><strong>Definition</strong></p>
<p>We are using the mid-point integration rule to assign weights to each
element of a weight matrix <span class="math notranslate nohighlight">\(W\)</span> so that</p>
<div class="math notranslate nohighlight">
\[I_s(q) = W\,I(q_\text{calc})\]</div>
<p>If <em>q_calc</em> is at the mid-point, we can infer the bin edges from the
pairwise averages of <em>q_calc</em>, adding the missing edges before
<em>q_calc[0]</em> and after <em>q_calc[-1]</em>.</p>
<p>For <span class="math notranslate nohighlight">\(q_\parallel = 0\)</span>, the smeared value can be computed numerically
using the <span class="math notranslate nohighlight">\(u\)</span> substitution</p>
<div class="math notranslate nohighlight">
\[u_j = \sqrt{q_j^2 - q^2}\]</div>
<p>This gives</p>
<div class="math notranslate nohighlight">
\[I_s(q) \approx \sum_j I(u_j) \Delta u_j\]</div>
<p>where <span class="math notranslate nohighlight">\(I(u_j)\)</span> is the value at the mid-point, and <span class="math notranslate nohighlight">\(\Delta u_j\)</span> is the
difference between consecutive edges which have been first converted
to <span class="math notranslate nohighlight">\(u\)</span>.  Only <span class="math notranslate nohighlight">\(u_j \in [0, \Delta q_\perp]\)</span> are used, which corresponds
to <span class="math notranslate nohighlight">\(q_j \in \left[q, \sqrt{q^2 + \Delta q_\perp}\right]\)</span>, so</p>
<div class="math notranslate nohighlight">
\[W_{ij} = \frac{1}{\Delta q_\perp} \Delta u_j
       = \frac{1}{\Delta q_\perp} \left(
            \sqrt{q_{j+1}^2 - q_i^2} - \sqrt{q_j^2 - q_i^2} \right)
    \ \text{if}\  q_j \in \left[q_i, \sqrt{q_i^2 + q_\perp^2}\right]\]</div>
<p>where <span class="math notranslate nohighlight">\(I_s(q_i)\)</span> is the theory function being computed and <span class="math notranslate nohighlight">\(q_j\)</span> are the
mid-points between the calculated values in <em>q_calc</em>.  We tweak the
edges of the initial and final intervals so that they lie on integration
limits.</p>
<p>(To be precise, the transformed midpoint <span class="math notranslate nohighlight">\(u(q_j)\)</span> is not necessarily the
midpoint of the edges <span class="math notranslate nohighlight">\(u((q_{j-1}+q_j)/2)\)</span> and <span class="math notranslate nohighlight">\(u((q_j + q_{j+1})/2)\)</span>,
but it is at least in the interval, so the approximation is going to be
a little better than the left or right Riemann sum, and should be
good enough for our purposes.)</p>
<p>For <span class="math notranslate nohighlight">\(q_\perp = 0\)</span>, the <span class="math notranslate nohighlight">\(u\)</span> substitution is simpler:</p>
<div class="math notranslate nohighlight">
\[u_j = \left|q_j - q\right|\]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\[W_{ij} = \frac{1}{2 \Delta q_\parallel} \Delta u_j
    = \frac{1}{2 \Delta q_\parallel} (q_{j+1} - q_j)
    \ \text{if}\ q_j \in
        \left[q-\Delta q_\parallel, q+\Delta q_\parallel\right]\]</div>
<p>However, we need to support cases were <span class="math notranslate nohighlight">\(u_j &lt; 0\)</span>, which means using
<span class="math notranslate nohighlight">\(2 (q_{j+1} - q_j)\)</span> when <span class="math notranslate nohighlight">\(q_j \in \left[0, q_\parallel-q_i\right]\)</span>.
This is not an issue for <span class="math notranslate nohighlight">\(q_i &gt; q_\parallel\)</span>.</p>
<p>For both <span class="math notranslate nohighlight">\(q_\perp &gt; 0\)</span> and <span class="math notranslate nohighlight">\(q_\parallel &gt; 0\)</span> we perform a 2 dimensional
integration with</p>
<div class="math notranslate nohighlight">
\[u_{jk} = \sqrt{q_j^2 - (q + (k\Delta q_\parallel/L))^2}
    \ \text{for}\ k = -L \ldots L\]</div>
<p>for <span class="math notranslate nohighlight">\(L\)</span> = <em>n_height</em>.  This gives</p>
<div class="math notranslate nohighlight">
\[W_{ij} = \frac{1}{2 \Delta q_\perp q_\parallel}
    \sum_{k=-L}^L \Delta u_{jk}
        \left(\frac{\Delta q_\parallel}{2 L + 1}\right)\]</div>
</dd></dl>

<dl class="function">
<dt id="sasmodels.resolution.pinhole_extend_q">
<code class="descclassname">sasmodels.resolution.</code><code class="descname">pinhole_extend_q</code><span class="sig-paren">(</span><em>q</em>, <em>q_width</em>, <em>nsigma=(2.5</em>, <em>3.0)</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#pinhole_extend_q"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Given <em>q</em> and <em>q_width</em>, find a set of sampling points <em>q_calc</em> so
that each point <span class="math notranslate nohighlight">\(I(q)\)</span> has sufficient support from the underlying
function.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.resolution.slit_extend_q">
<code class="descclassname">sasmodels.resolution.</code><code class="descname">slit_extend_q</code><span class="sig-paren">(</span><em>q</em>, <em>width</em>, <em>height</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#slit_extend_q"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Given <em>q</em>, <em>width</em> and <em>height</em>, find a set of sampling points <em>q_calc</em> so
that each point I(q) has sufficient support from the underlying
function.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.resolution.bin_edges">
<code class="descclassname">sasmodels.resolution.</code><code class="descname">bin_edges</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#bin_edges"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Determine bin edges from bin centers, assuming that edges are centered
between the bins.</p>
<p>Note: this uses the arithmetic mean, which may not be appropriate for
log-scaled data.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.resolution.interpolate">
<code class="descclassname">sasmodels.resolution.</code><code class="descname">interpolate</code><span class="sig-paren">(</span><em>q</em>, <em>max_step</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#interpolate"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns <em>q_calc</em> with points spaced at most max_step apart.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.resolution.linear_extrapolation">
<code class="descclassname">sasmodels.resolution.</code><code class="descname">linear_extrapolation</code><span class="sig-paren">(</span><em>q</em>, <em>q_min</em>, <em>q_max</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#linear_extrapolation"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Extrapolate <em>q</em> out to [<em>q_min</em>, <em>q_max</em>] using the step size in <em>q</em> as
a guide.  Extrapolation below uses about the same size as the first
interval.  Extrapolation above uses about the same size as the final
interval.</p>
<p>Note that extrapolated values may be negative.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.resolution.geometric_extrapolation">
<code class="descclassname">sasmodels.resolution.</code><code class="descname">geometric_extrapolation</code><span class="sig-paren">(</span><em>q</em>, <em>q_min</em>, <em>q_max</em>, <em>points_per_decade=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution.html#geometric_extrapolation"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Extrapolate <em>q</em> to [<em>q_min</em>, <em>q_max</em>] using geometric steps, with the
average geometric step size in <em>q</em> as the step size.</p>
<p>if <em>q_min</em> is zero or less then <em>q[0]/10</em> is used instead.</p>
<p><em>points_per_decade</em> sets the ratio between consecutive steps such
that there will be <span class="math notranslate nohighlight">\(n\)</span> points used for every factor of 10 increase
in <em>q</em>.</p>
<p>If <em>points_per_decade</em> is not given, it will be estimated as follows.
Starting at <span class="math notranslate nohighlight">\(q_1\)</span> and stepping geometrically by <span class="math notranslate nohighlight">\(\Delta q\)</span> to <span class="math notranslate nohighlight">\(q_n\)</span>
in <span class="math notranslate nohighlight">\(n\)</span> points gives a geometric average of:</p>
<div class="math notranslate nohighlight">
\[\log \Delta q = (\log q_n - \log q_1) / (n - 1)\]</div>
<p>From this we can compute the number of steps required to extend <span class="math notranslate nohighlight">\(q\)</span>
from <span class="math notranslate nohighlight">\(q_n\)</span> to <span class="math notranslate nohighlight">\(q_\text{max}\)</span> by <span class="math notranslate nohighlight">\(\Delta q\)</span> as:</p>
<div class="math notranslate nohighlight">
\[n_\text{extend} = (\log q_\text{max} - \log q_n) / \log \Delta q\]</div>
<p>Substituting:</p>
<div class="math notranslate nohighlight">
\[n_\text{extend} = (n-1) (\log q_\text{max} - \log q_n)
   / (\log q_n - \log q_1)\]</div>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.resolution2d">
<span id="sasmodels-resolution2d-module"></span><h2>sasmodels.resolution2d module</h2>
<p>#This software was developed by the University of Tennessee as part of the
#Distributed Data Analysis of Neutron Scattering Experiments (DANSE)
#project funded by the US National Science Foundation.
#See the license text in license.txt</p>
<dl class="class">
<dt id="sasmodels.resolution2d.Pinhole2D">
<em class="property">class </em><code class="descclassname">sasmodels.resolution2d.</code><code class="descname">Pinhole2D</code><span class="sig-paren">(</span><em>data=None</em>, <em>index=None</em>, <em>nsigma=3.0</em>, <em>accuracy='Low'</em>, <em>coords='polar'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution2d.html#Pinhole2D"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.resolution.Resolution" title="sasmodels.resolution.Resolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.resolution.Resolution</span></code></a></p>
<p>Gaussian Q smearing class for SAS 2d data</p>
<dl class="method">
<dt id="sasmodels.resolution2d.Pinhole2D.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>theory</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution2d.html#Pinhole2D.apply"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Smear <em>theory</em> by the resolution function, returning <em>Iq</em>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.resolution2d.Slit2D">
<em class="property">class </em><code class="descclassname">sasmodels.resolution2d.</code><code class="descname">Slit2D</code><span class="sig-paren">(</span><em>q</em>, <em>qx_width</em>, <em>qy_width=0.0</em>, <em>q_calc=None</em>, <em>accuracy='low'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution2d.html#Slit2D"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.resolution.Resolution" title="sasmodels.resolution.Resolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.resolution.Resolution</span></code></a></p>
<p>Slit aperture with resolution function on an oriented sample.</p>
<p><em>q</em> points at which the data is measured.</p>
<p><em>qx_width</em> slit width in qx</p>
<p><em>qy_width</em> slit height in qy; current implementation requires a fixed
qy_width for all q points.</p>
<p><em>q_calc</em> is the list of q points to calculate, or None if this
should be estimated from the <em>q</em> and <em>qx_width</em>.</p>
<p><em>accuracy</em> determines the number of <em>qy</em> points to compute for each <em>q</em>.
The values are stored in sasmodels.resolution2d.N_SLIT_PERP.  The default
values are: low=101, med=401, high=1001, xhigh=2001</p>
<dl class="method">
<dt id="sasmodels.resolution2d.Slit2D.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>theory</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/resolution2d.html#Slit2D.apply"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Smear <em>theory</em> by the resolution function, returning <em>Iq</em>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-sasmodels.rst2html">
<span id="sasmodels-rst2html-module"></span><h2>sasmodels.rst2html module</h2>
<p>Convert a restructured text document to html.</p>
<p>Inline math markup can uses the <em>math</em> directive, or it can use latex
style <em>$expression$</em>.  Math can be rendered using simple html and
unicode, or with mathjax.</p>
<dl class="function">
<dt id="sasmodels.rst2html.can_use_qt">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">can_use_qt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#can_use_qt"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return True if QWebView exists.</p>
<p>Checks first in PyQt5 then in PyQt4</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.load_rst_as_html">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">load_rst_as_html</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#load_rst_as_html"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load rst from file and convert to html</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.main">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#main"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Command line interface to rst or html viewer.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.qtview">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">qtview</code><span class="sig-paren">(</span><em>html</em>, <em>url=''</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#qtview"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>View HTML in a Qt dialog</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.replace_compact_fraction">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">replace_compact_fraction</code><span class="sig-paren">(</span><em>content</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#replace_compact_fraction"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert frac12 to frac{1}{2} for broken latex parsers</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.replace_dollar">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">replace_dollar</code><span class="sig-paren">(</span><em>content</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#replace_dollar"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert dollar signs to inline math markup in rst.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.rst2html">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">rst2html</code><span class="sig-paren">(</span><em>rst</em>, <em>part='whole'</em>, <em>math_output='mathjax'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#rst2html"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert restructured text into simple html.</p>
<p>Valid <em>math_output</em> formats for formulas include:
- html
- mathml
- mathjax
See <a class="reference external" href="http://docutils.sourceforge.net/docs/user/config.html#math-output">http://docutils.sourceforge.net/docs/user/config.html#math-output</a>
for details.</p>
<p>The following <em>part</em> choices are available:
- whole: the entire html document
- html_body: document division with title and contents and footer
- body: contents only</p>
<p>There are other parts, but they don’t make sense alone:</p>
<blockquote>
<div>subtitle, version, encoding, html_prolog, header, meta,
html_title, title, stylesheet, html_subtitle, html_body,
body, head, body_suffix, fragment, docinfo, html_head,
head_prefix, body_prefix, footer, body_pre_docinfo, whole</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.suppress_html_errors">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">suppress_html_errors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#suppress_html_errors"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Context manager for keeping error reports out of the generated HTML.</p>
<p>Within the context, system message nodes in the docutils parse tree
will be ignored.  After the context, the usual behaviour will be restored.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.test_dollar">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">test_dollar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#test_dollar"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Test substitution of dollar signs with equivalent RST math markup</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.view_help">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">view_help</code><span class="sig-paren">(</span><em>filename</em>, <em>qt=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#view_help"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>View rst or html file.  If <em>qt</em> use q viewer, otherwise use wx.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.view_html">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">view_html</code><span class="sig-paren">(</span><em>html</em>, <em>url=''</em><span class="sig-paren">)</span></dt>
<dd><p>HTML viewer app in Qt</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.view_html_qtapp">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">view_html_qtapp</code><span class="sig-paren">(</span><em>html</em>, <em>url=''</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#view_html_qtapp"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>HTML viewer app in Qt</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.view_html_wxapp">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">view_html_wxapp</code><span class="sig-paren">(</span><em>html</em>, <em>url=''</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#view_html_wxapp"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>HTML viewer app in wx</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.view_url_qtapp">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">view_url_qtapp</code><span class="sig-paren">(</span><em>url</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#view_url_qtapp"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>URL viewer app in Qt</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.view_url_wxapp">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">view_url_wxapp</code><span class="sig-paren">(</span><em>url</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#view_url_wxapp"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>URL viewer app in wx</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.rst2html.wxview">
<code class="descclassname">sasmodels.rst2html.</code><code class="descname">wxview</code><span class="sig-paren">(</span><em>html</em>, <em>url=''</em>, <em>size=(850</em>, <em>540)</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/rst2html.html#wxview"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>View HTML in a wx dialog</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.sasview_model">
<span id="sasmodels-sasview-model-module"></span><h2>sasmodels.sasview_model module</h2>
<p>Sasview model constructor.</p>
<p>Given a module defining an OpenCL kernel such as sasmodels.models.cylinder,
create a sasview model class to run that kernel as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sasmodels.sasview_model</span> <span class="k">import</span> <span class="n">load_custom_model</span>
<span class="n">CylinderModel</span> <span class="o">=</span> <span class="n">load_custom_model</span><span class="p">(</span><span class="s1">&#39;sasmodels/models/cylinder.py&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="sasmodels.sasview_model.MODELS">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">MODELS</code><em class="property"> = {}</em></dt>
<dd><p>set of defined models (standard and custom)</p>
</dd></dl>

<dl class="data">
<dt id="sasmodels.sasview_model.MODEL_BY_PATH">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">MODEL_BY_PATH</code><em class="property"> = {}</em></dt>
<dd><p>custom model {path: model} mapping so we can check timestamps</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.MultiplicationModel">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">MultiplicationModel</code><span class="sig-paren">(</span><em>form_factor</em>, <em>structure_factor</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#MultiplicationModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns a constructed product model from form_factor and structure_factor.</p>
</dd></dl>

<dl class="class">
<dt id="sasmodels.sasview_model.MultiplicityInfo">
<em class="property">class </em><code class="descclassname">sasmodels.sasview_model.</code><code class="descname">MultiplicityInfo</code><span class="sig-paren">(</span><em>number</em>, <em>control</em>, <em>choices</em>, <em>x_axis_label</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="sasmodels.sasview_model.MultiplicityInfo.choices">
<code class="descname">choices</code></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.MultiplicityInfo.control">
<code class="descname">control</code></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.MultiplicityInfo.number">
<code class="descname">number</code></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.MultiplicityInfo.x_axis_label">
<code class="descname">x_axis_label</code></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.MultiplicityInfoType">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">MultiplicityInfoType</code></dt>
<dd><p>alias of <a class="reference internal" href="#sasmodels.sasview_model.MultiplicityInfo" title="sasmodels.sasview_model.MultiplicityInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.sasview_model.MultiplicityInfo</span></code></a></p>
</dd></dl>

<dl class="data">
<dt id="sasmodels.sasview_model.SUPPORT_OLD_STYLE_PLUGINS">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">SUPPORT_OLD_STYLE_PLUGINS</code><em class="property"> = True</em></dt>
<dd><p>True if pre-existing plugins, with the old names and parameters, should
continue to be supported.</p>
</dd></dl>

<dl class="class">
<dt id="sasmodels.sasview_model.SasviewModel">
<em class="property">class </em><code class="descclassname">sasmodels.sasview_model.</code><code class="descname">SasviewModel</code><span class="sig-paren">(</span><em>multiplicity=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Sasview wrapper for opencl/ctypes model.</p>
<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.calc_composition_models">
<code class="descname">calc_composition_models</code><span class="sig-paren">(</span><em>qx</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.calc_composition_models"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>returns parts of the composition model or None if not a composition
model.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.calculate_ER">
<code class="descname">calculate_ER</code><span class="sig-paren">(</span><em>mode=1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.calculate_ER"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Calculate the effective radius for P(q)*S(q)</p>
<p><em>mode</em> is the R_eff type, which defaults to 1 to match the ER
calculation for sasview models from version 3.x.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the value of the effective radius</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.calculate_Iq">
<code class="descname">calculate_Iq</code><span class="sig-paren">(</span><em>qx</em>, <em>qy=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.calculate_Iq"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Calculate Iq for one set of q with the current parameters.</p>
<p>If the model is 1D, use <em>q</em>.  If 2D, use <em>qx</em>, <em>qy</em>.</p>
<p>This should NOT be used for fitting since it copies the <em>q</em> vectors
to the card for each evaluation.</p>
<p>The returned tuple contains the scattering intensity followed by a
callable which returns a dictionary of intermediate data from
ProductKernel.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.calculate_VR">
<code class="descname">calculate_VR</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.calculate_VR"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Calculate the volf ratio for P(q)*S(q)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the value of the form:shell volume ratio</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.category">
<code class="descname">category</code><em class="property"> = None</em></dt>
<dd><p>default model category</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.clone">
<code class="descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.clone"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a identical copy of self</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.cutoff">
<code class="descname">cutoff</code><em class="property"> = 1e-05</em></dt>
<dd><p>default cutoff for polydispersity</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.description">
<code class="descname">description</code><em class="property"> = None</em></dt>
<dd><p>short model description</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.details">
<code class="descname">details</code><em class="property"> = None</em></dt>
<dd><p>units and limits for each parameter</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.dispersion">
<code class="descname">dispersion</code><em class="property"> = None</em></dt>
<dd><p>values for dispersion width, npts, nsigmas and type</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.evalDistribution">
<code class="descname">evalDistribution</code><span class="sig-paren">(</span><em>qdist</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.evalDistribution"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Evaluate a distribution of q-values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qdist</strong> – array of q or a list of arrays [qx,qy]</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>For 1D, a numpy array is expected as input</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">evalDistribution</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

<span class="n">where</span> <span class="o">*</span><span class="n">q</span><span class="o">*</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">numpy</span> <span class="n">array</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li>For 2D, a list of <em>[qx,qy]</em> is expected with 1D arrays as input</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qx</span> <span class="o">=</span> <span class="p">[</span> <span class="n">qx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qx</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">qx</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">....</span><span class="p">]</span>
<span class="n">qy</span> <span class="o">=</span> <span class="p">[</span> <span class="n">qy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">qy</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">....</span><span class="p">]</span>
</pre></div>
</div>
<p>If the model is 1D only, then</p>
<div class="math notranslate nohighlight">
\[q = \sqrt{q_x^2+q_y^2}\]</div>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.fixed">
<code class="descname">fixed</code><em class="property"> = None</em></dt>
<dd><p>names of the fittable parameters</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.getDispParamList">
<code class="descname">getDispParamList</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.getDispParamList"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a list of polydispersity parameters for the model</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.getParam">
<code class="descname">getParam</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.getParam"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Set the value of a model parameter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> – name of the parameter</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.getParamList">
<code class="descname">getParamList</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.getParamList"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a list of all available parameters for the model</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.getProfile">
<code class="descname">getProfile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.getProfile"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Get SLD profile</p>
<dl class="docutils">
<dt>: return: (z, beta) where z is a list of depth of the transition points</dt>
<dd>beta is a list of the corresponding SLD values</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.id">
<code class="descname">id</code><em class="property"> = None</em></dt>
<dd><p>load/save name for the model</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.input_name">
<code class="descname">input_name</code><em class="property"> = 'Q'</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.input_unit">
<code class="descname">input_unit</code><em class="property"> = 'A^{-1}'</em></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.is_fittable">
<code class="descname">is_fittable</code><span class="sig-paren">(</span><em>par_name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.is_fittable"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Check if a given parameter is fittable or not</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>par_name</strong> – the parameter name to check</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.is_form_factor">
<code class="descname">is_form_factor</code><em class="property"> = False</em></dt>
<dd><p>True if model should appear as a form factor</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.is_multiplicity_model">
<code class="descname">is_multiplicity_model</code><em class="property"> = False</em></dt>
<dd><p>True if model has multiplicity</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.is_structure_factor">
<code class="descname">is_structure_factor</code><em class="property"> = False</em></dt>
<dd><p>True if model should appear as a structure factor</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.magnetic_params">
<code class="descname">magnetic_params</code><em class="property"> = None</em></dt>
<dd><p>names of the magnetic parameters in the order they appear</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.multiplicity">
<code class="descname">multiplicity</code><em class="property"> = None</em></dt>
<dd><p>multiplicity value, or None if no multiplicity on the model</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.multiplicity_info">
<code class="descname">multiplicity_info</code><em class="property"> = None</em></dt>
<dd><p>Multiplicity information</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.name">
<code class="descname">name</code><em class="property"> = None</em></dt>
<dd><p>display name for the model</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.non_fittable">
<code class="descname">non_fittable</code><em class="property"> = ()</em></dt>
<dd><p>parameters that are not fitted</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.orientation_params">
<code class="descname">orientation_params</code><em class="property"> = None</em></dt>
<dd><p>names of the orientation parameters in the order they appear</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.output_name">
<code class="descname">output_name</code><em class="property"> = 'Intensity'</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.output_unit">
<code class="descname">output_unit</code><em class="property"> = 'cm^{-1}'</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.sasview_model.SasviewModel.params">
<code class="descname">params</code><em class="property"> = None</em></dt>
<dd><p>parameter {name: value} mapping</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>x=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.run"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Evaluate the model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – input q, or [q,phi]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">scattering function P(q)</td>
</tr>
</tbody>
</table>
<p><strong>DEPRECATED</strong>: use calculate_Iq instead</p>
</dd></dl>

<dl class="classmethod">
<dt id="sasmodels.sasview_model.SasviewModel.runTests">
<em class="property">classmethod </em><code class="descname">runTests</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.runTests"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Run any tests built into the model and captures the test output.</p>
<p>Returns success flag and output</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.runXY">
<code class="descname">runXY</code><span class="sig-paren">(</span><em>x=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.runXY"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Evaluate the model in cartesian coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – input q, or [qx, qy]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">scattering function P(q)</td>
</tr>
</tbody>
</table>
<p><strong>DEPRECATED</strong>: use calculate_Iq instead</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.setParam">
<code class="descname">setParam</code><span class="sig-paren">(</span><em>name</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.setParam"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Set the value of a model parameter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – name of the parameter</li>
<li><strong>value</strong> – value of the parameter</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sasmodels.sasview_model.SasviewModel.set_dispersion">
<code class="descname">set_dispersion</code><span class="sig-paren">(</span><em>parameter</em>, <em>dispersion</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#SasviewModel.set_dispersion"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Set the dispersion object for a model parameter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>parameter</strong> – name of the parameter [string]</li>
<li><strong>dispersion</strong> – dispersion object of type Dispersion</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.find_model">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">find_model</code><span class="sig-paren">(</span><em>modelname</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#find_model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Find a model by name.  If the model name ends in py, try loading it from
custom models, otherwise look for it in the list of builtin models.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.load_custom_model">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">load_custom_model</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#load_custom_model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load a custom model given the model path.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.load_standard_models">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">load_standard_models</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#load_standard_models"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load and return the list of predefined models.</p>
<p>If there is an error loading a model, then a traceback is logged and the
model is not returned.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.magnetic_demo">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">magnetic_demo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#magnetic_demo"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Demostrate call to magnetic model.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.make_model_from_info">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">make_model_from_info</code><span class="sig-paren">(</span><em>model_info</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#make_model_from_info"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert <em>model_info</em> into a SasView model wrapper.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.reset_environment">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">reset_environment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#reset_environment"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Clear the compute engine context so that the GUI can change devices.</p>
<p>This removes all compiled kernels, even those that are active on fit
pages, but they will be restored the next time they are needed.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.test_cylinder">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">test_cylinder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#test_cylinder"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Test that the cylinder model runs, returning the value at [0.1,0.1].</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.test_empty_distribution">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">test_empty_distribution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#test_empty_distribution"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Make sure that sasmodels returns NaN when there are no polydispersity points</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.test_model_list">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">test_model_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#test_model_list"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Make sure that all models build as sasview models</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.test_old_name">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">test_old_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#test_old_name"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load and run cylinder model as sas.models.CylinderModel</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.test_product">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">test_product</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#test_product"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Test that 2-D hardsphere model runs and doesn’t produce NaN.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.test_rpa">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">test_rpa</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#test_rpa"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Test that the 2-D RPA model runs</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.test_structure_factor">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">test_structure_factor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#test_structure_factor"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Test that 2-D hardsphere model runs and doesn’t produce NaN.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.sasview_model.test_structure_factor_background">
<code class="descclassname">sasmodels.sasview_model.</code><code class="descname">test_structure_factor_background</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sasview_model.html#test_structure_factor_background"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Check that sasview model and direct model match, with background=0.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels.sesans">
<span id="sasmodels-sesans-module"></span><h2>sasmodels.sesans module</h2>
<p>Conversion of scattering cross section from SANS (I(q), or rather, ds/dO) in absolute
units (cm-1)into SESANS correlation function G using a Hankel transformation, then converting
the SESANS correlation function into polarisation from the SESANS experiment</p>
<p>Everything is in units of metres except specified otherwise (NOT TRUE!!!)
Everything is in conventional units (nm for spin echo length)</p>
<p>Wim Bouwman (<a class="reference external" href="mailto:w&#46;g&#46;bouwman&#37;&#52;&#48;tudelft&#46;nl">w<span>&#46;</span>g<span>&#46;</span>bouwman<span>&#64;</span>tudelft<span>&#46;</span>nl</a>), June 2013</p>
<dl class="class">
<dt id="sasmodels.sesans.SesansTransform">
<em class="property">class </em><code class="descclassname">sasmodels.sesans.</code><code class="descname">SesansTransform</code><span class="sig-paren">(</span><em>z</em>, <em>SElength</em>, <em>lam</em>, <em>zaccept</em>, <em>Rmax</em>, <em>log_spacing=1.0003</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sesans.html#SesansTransform"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Spin-Echo SANS transform calculator.  Similar to a resolution function,
the SesansTransform object takes I(q) for the set of <em>q_calc</em> values and
produces a transformed dataset</p>
<p><em>SElength</em> (A) is the set of spin-echo lengths in the measured data.</p>
<p><em>zaccept</em> (1/A) is the maximum acceptance of scattering vector in the spin
echo encoding dimension (for ToF: Q of min(R) and max(lam)).</p>
<p><em>Rmax</em> (A) is the maximum size sensitivity; larger radius requires more
computation time.</p>
<dl class="method">
<dt id="sasmodels.sesans.SesansTransform.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>Iq</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/sesans.html#SesansTransform.apply"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Apply the SESANS transform to the computed I(q).</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sesans.SesansTransform.q">
<code class="descname">q</code><em class="property"> = None</em></dt>
<dd><p>SElength from the data in the original data units; not used by transform
but the GUI uses it, so make sure that it is present.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.sesans.SesansTransform.q_calc">
<code class="descname">q_calc</code><em class="property"> = None</em></dt>
<dd><p>q values to calculate when computing transform</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-sasmodels.special">
<span id="sasmodels-special-module"></span><h2>sasmodels.special module</h2>
<div class="section" id="special-functions">
<h3>Special Functions</h3>
<p>This following standard C99 math functions are available:</p>
<blockquote>
<div><dl class="docutils">
<dt>M_PI, M_PI_2, M_PI_4, M_SQRT1_2, M_E:</dt>
<dd><span class="math notranslate nohighlight">\(\pi\)</span>, <span class="math notranslate nohighlight">\(\pi/2\)</span>, <span class="math notranslate nohighlight">\(\pi/4\)</span>, <span class="math notranslate nohighlight">\(1/\sqrt{2}\)</span> and Euler’s constant <span class="math notranslate nohighlight">\(e\)</span></dd>
<dt>exp, log, pow(x,y), expm1, log1p, sqrt, cbrt:</dt>
<dd>Power functions <span class="math notranslate nohighlight">\(e^x\)</span>, <span class="math notranslate nohighlight">\(\ln x\)</span>, <span class="math notranslate nohighlight">\(x^y\)</span>, <span class="math notranslate nohighlight">\(e^x - 1\)</span>, <span class="math notranslate nohighlight">\(\ln 1 + x\)</span>,
<span class="math notranslate nohighlight">\(\sqrt{x}\)</span>, <span class="math notranslate nohighlight">\(\sqrt[3]{x}\)</span>. The functions expm1(x) and log1p(x)
are accurate across all <span class="math notranslate nohighlight">\(x\)</span>, including <span class="math notranslate nohighlight">\(x\)</span> very close to zero.</dd>
<dt>sin, cos, tan, asin, acos, atan:</dt>
<dd>Trigonometry functions and inverses, operating on radians.</dd>
<dt>sinh, cosh, tanh, asinh, acosh, atanh:</dt>
<dd>Hyperbolic trigonometry functions.</dd>
<dt>atan2(y,x):</dt>
<dd>Angle from the <span class="math notranslate nohighlight">\(x\)</span>-axis to the point <span class="math notranslate nohighlight">\((x,y)\)</span>, which is equal to
<span class="math notranslate nohighlight">\(\tan^{-1}(y/x)\)</span> corrected for quadrant.  That is, if <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are
both negative, then atan2(y,x) returns a value in quadrant III where
atan(y/x) would return a value in quadrant I. Similarly for
quadrants II and IV when <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> have opposite sign.</dd>
<dt>fabs(x), fmin(x,y), fmax(x,y), trunc, rint:</dt>
<dd>Floating point functions.  rint(x) returns the nearest integer.</dd>
<dt>NAN:</dt>
<dd>NaN, Not a Number, <span class="math notranslate nohighlight">\(0/0\)</span>.  Use isnan(x) to test for NaN.  Note that
you cannot use <code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">==</span> <span class="pre">NAN</span></code> to test for NaN values since that
will always return false.  NAN does not equal NAN!  The alternative,
<code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">!=</span> <span class="pre">x</span></code> may fail if the compiler optimizes the test away.</dd>
<dt>INFINITY:</dt>
<dd><span class="math notranslate nohighlight">\(\infty, 1/0\)</span>.  Use isinf(x) to test for infinity, or isfinite(x)
to test for finite and not NaN.</dd>
<dt>erf, erfc, tgamma, lgamma:  <strong>do not use</strong></dt>
<dd>Special functions that should be part of the standard, but are missing
or inaccurate on some platforms. Use sas_erf, sas_erfc and sas_gamma
instead (see below). Note: lgamma(x) has not yet been tested.</dd>
</dl>
</div></blockquote>
<p>Some non-standard constants and functions are also provided:</p>
<blockquote>
<div><dl class="docutils">
<dt>M_PI_180, M_4PI_3:</dt>
<dd><span class="math notranslate nohighlight">\(\frac{\pi}{180}\)</span>, <span class="math notranslate nohighlight">\(\frac{4\pi}{3}\)</span></dd>
<dt>SINCOS(x, s, c):</dt>
<dd>Macro which sets s=sin(x) and c=cos(x). The variables <em>c</em> and <em>s</em>
must be declared first.</dd>
<dt>square(x):</dt>
<dd><span class="math notranslate nohighlight">\(x^2\)</span></dd>
<dt>cube(x):</dt>
<dd><span class="math notranslate nohighlight">\(x^3\)</span></dd>
<dt>sas_sinx_x(x):</dt>
<dd><span class="math notranslate nohighlight">\(\sin(x)/x\)</span>, with limit <span class="math notranslate nohighlight">\(\sin(0)/0 = 1\)</span>.</dd>
<dt>powr(x, y):</dt>
<dd><span class="math notranslate nohighlight">\(x^y\)</span> for <span class="math notranslate nohighlight">\(x \ge 0\)</span>; this is faster than general <span class="math notranslate nohighlight">\(x^y\)</span> on some GPUs.</dd>
<dt>pown(x, n):</dt>
<dd><span class="math notranslate nohighlight">\(x^n\)</span> for <span class="math notranslate nohighlight">\(n\)</span> integer; this is faster than general <span class="math notranslate nohighlight">\(x^n\)</span> on some GPUs.</dd>
<dt>FLOAT_SIZE:</dt>
<dd><p class="first">The number of bytes in a floating point value.  Even though all
variables are declared double, they may be converted to single
precision float before running. If your algorithm depends on
precision (which is not uncommon for numerical algorithms), use
the following:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#if FLOAT_SIZE&gt;4</span>
<span class="o">...</span> <span class="n">code</span> <span class="k">for</span> <span class="n">double</span> <span class="n">precision</span> <span class="o">...</span>
<span class="c1">#else</span>
<span class="o">...</span> <span class="n">code</span> <span class="k">for</span> <span class="n">single</span> <span class="n">precision</span> <span class="o">...</span>
<span class="c1">#endif</span>
</pre></div>
</div>
</dd>
<dt>SAS_DOUBLE:</dt>
<dd>A replacement for <code class="code docutils literal notranslate"><span class="pre">double</span></code> so that the declared variable will
stay double precision; this should generally not be used since some
graphics cards do not support double precision.  There is no provision
for forcing a constant to stay double precision.</dd>
</dl>
</div></blockquote>
<p>The following special functions and scattering calculations are defined.
These functions have been tuned to be fast and numerically stable down
to <span class="math notranslate nohighlight">\(q=0\)</span> even in single precision.  In some cases they work around bugs
which appear on some platforms but not others, so use them where needed.
Add the files listed in <code class="code docutils literal notranslate"><span class="pre">source</span> <span class="pre">=</span> <span class="pre">[&quot;lib/file.c&quot;,</span> <span class="pre">...]</span></code> to your <em>model.py</em>
file in the order given, otherwise these functions will not be available.</p>
<blockquote>
<div><dl class="docutils">
<dt>polevl(x, c, n):</dt>
<dd><p class="first">Polynomial evaluation <span class="math notranslate nohighlight">\(p(x) = \sum_{i=0}^n c_i x^i\)</span> using Horner’s
method so it is faster and more accurate.</p>
<p class="last"><span class="math notranslate nohighlight">\(c = \{c_n, c_{n-1}, \ldots, c_0 \}\)</span> is the table of coefficients,
sorted from highest to lowest.</p>
</dd>
<dt>p1evl(x, c, n):</dt>
<dd><p class="first">Evaluate normalized polynomial <span class="math notranslate nohighlight">\(p(x) = x^n + \sum_{i=0}^{n-1} c_i x^i\)</span>
using Horner’s method so it is faster and more accurate.</p>
<p class="last"><span class="math notranslate nohighlight">\(c = \{c_{n-1}, c_{n-2} \ldots, c_0 \}\)</span> is the table of coefficients,
sorted from highest to lowest.</p>
</dd>
<dt>sas_gamma(x):</dt>
<dd><p class="first">Gamma function sas_gamma<span class="math notranslate nohighlight">\((x) = \Gamma(x)\)</span>.</p>
<p class="last">The standard math function, tgamma(x) is unstable for <span class="math notranslate nohighlight">\(x &lt; 1\)</span>
on some platforms.</p>
</dd>
<dt>sas_gammaln(x):</dt>
<dd><p class="first">log gamma function sas_gammaln<span class="math notranslate nohighlight">\((x) = \log \Gamma(|x|)\)</span>.</p>
<p class="last">The standard math function, lgamma(x), is incorrect for single
precision on some platforms.</p>
</dd>
<dt>sas_gammainc(a, x), sas_gammaincc(a, x):</dt>
<dd>Incomplete gamma function
sas_gammainc<span class="math notranslate nohighlight">\((a, x) = \int_0^x t^{a-1}e^{-t}\,dt / \Gamma(a)\)</span>
and complementary incomplete gamma function
sas_gammaincc<span class="math notranslate nohighlight">\((a, x) = \int_x^\infty t^{a-1}e^{-t}\,dt / \Gamma(a)\)</span></dd>
<dt>sas_erf(x), sas_erfc(x):</dt>
<dd><p class="first">Error function
sas_erf<span class="math notranslate nohighlight">\((x) = \frac{2}{\sqrt\pi}\int_0^x e^{-t^2}\,dt\)</span>
and complementary error function
sas_erfc<span class="math notranslate nohighlight">\((x) = \frac{2}{\sqrt\pi}\int_x^{\infty} e^{-t^2}\,dt\)</span>.</p>
<p class="last">The standard math functions erf(x) and erfc(x) are slower and broken
on some platforms.</p>
</dd>
<dt>sas_J0(x):</dt>
<dd><p class="first">Bessel function of the first kind sas_J0<span class="math notranslate nohighlight">\((x)=J_0(x)\)</span> where
<span class="math notranslate nohighlight">\(J_0(x) = \frac{1}{\pi}\int_0^\pi \cos(x\sin(\tau))\,d\tau\)</span>.</p>
<p class="last">The standard math function j0(x) is not available on all platforms.</p>
</dd>
<dt>sas_J1(x):</dt>
<dd><p class="first">Bessel function of the first kind  sas_J1<span class="math notranslate nohighlight">\((x)=J_1(x)\)</span> where
<span class="math notranslate nohighlight">\(J_1(x) = \frac{1}{\pi}\int_0^\pi \cos(\tau - x\sin(\tau))\,d\tau\)</span>.</p>
<p class="last">The standard math function j1(x) is not available on all platforms.</p>
</dd>
<dt>sas_JN(n, x):</dt>
<dd><p class="first">Bessel function of the first kind and integer order <span class="math notranslate nohighlight">\(n\)</span>:
sas_JN<span class="math notranslate nohighlight">\((n, x)=J_n(x)\)</span> where
<span class="math notranslate nohighlight">\(J_n(x) = \frac{1}{\pi}\int_0^\pi \cos(n\tau - x\sin(\tau))\,d\tau\)</span>.
If <span class="math notranslate nohighlight">\(n\)</span> = 0 or 1, it uses sas_J0(x) or sas_J1(x), respectively.</p>
<p class="last">The standard math function jn(n, x) is not available on all platforms.</p>
</dd>
<dt>sas_Si(x):</dt>
<dd><p class="first">Sine integral sas_Si<span class="math notranslate nohighlight">\((x) = \int_0^x \tfrac{\sin t}{t}\,dt\)</span>.</p>
<p>This function uses Taylor series for small and large arguments:</p>
<p>For large arguments,</p>
<div class="math notranslate nohighlight">
\[\text{Si}(x) \sim \frac{\pi}{2}
 - \frac{\cos(x)}{x}
\left(1 - \frac{2!}{x^2} + \frac{4!}{x^4} - \frac{6!}{x^6} \right)
 - \frac{\sin(x)}{x}
\left(\frac{1}{x} - \frac{3!}{x^3} + \frac{5!}{x^5} - \frac{7!}{x^7}\right)\]</div>
<p>For small arguments,</p>
<div class="last math notranslate nohighlight">
\[\text{Si}(x) \sim x
- \frac{x^3}{3\times 3!} + \frac{x^5}{5 \times 5!} - \frac{x^7}{7 \times 7!}
+ \frac{x^9}{9\times 9!} - \frac{x^{11}}{11\times 11!}\]</div>
</dd>
<dt>sas_3j1x_x(x):</dt>
<dd><p class="first">Spherical Bessel form
sas_3j1x_x<span class="math notranslate nohighlight">\((x) = 3 j_1(x)/x = 3 (\sin(x) - x \cos(x))/x^3\)</span>,
with a limiting value of 1 at <span class="math notranslate nohighlight">\(x=0\)</span>, where <span class="math notranslate nohighlight">\(j_1(x)\)</span> is the spherical
Bessel function of the first kind and first order.</p>
<p class="last">This function uses a Taylor series for small <span class="math notranslate nohighlight">\(x\)</span> for numerical accuracy.</p>
</dd>
<dt>sas_2J1x_x(x):</dt>
<dd>Bessel form sas_2J1x_x<span class="math notranslate nohighlight">\((x) = 2 J_1(x)/x\)</span>, with a limiting value
of 1 at <span class="math notranslate nohighlight">\(x=0\)</span>, where <span class="math notranslate nohighlight">\(J_1(x)\)</span> is the Bessel function of first kind
and first order.</dd>
<dt>gauss76.n, gauss76.z[i], gauss76.w[i]:</dt>
<dd><p class="first">Points <span class="math notranslate nohighlight">\(z_i\)</span> and weights <span class="math notranslate nohighlight">\(w_i\)</span> for 76-point Gaussian quadrature, respectively,
computing <span class="math notranslate nohighlight">\(\int_{-1}^1 f(z)\,dz \approx \sum_{i=1}^{76} w_i\,f(z_i)\)</span>.
When translating the model to C, include ‘lib/gauss76.c’ in the source
and use <code class="code docutils literal notranslate"><span class="pre">GAUSS_N</span></code>, <code class="code docutils literal notranslate"><span class="pre">GAUSS_Z</span></code>, and <code class="code docutils literal notranslate"><span class="pre">GAUSS_W</span></code>.</p>
<p class="last">Similar arrays are available in <code class="code docutils literal notranslate"><span class="pre">gauss20</span></code> for 20-point quadrature
and <code class="code docutils literal notranslate"><span class="pre">gauss150.c</span></code> for 150-point quadrature. By using
<code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">gauss76</span> <span class="pre">as</span> <span class="pre">gauss</span></code> it is easy to change the number of
points in the integration.</p>
</dd>
</dl>
</div></blockquote>
<dl class="class">
<dt id="sasmodels.special.Gauss">
<em class="property">class </em><code class="descclassname">sasmodels.special.</code><code class="descname">Gauss</code><span class="sig-paren">(</span><em>w</em>, <em>z</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#Gauss"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gauss-Legendre integration weights</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.SINCOS">
<code class="descclassname">sasmodels.special.</code><code class="descname">SINCOS</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#SINCOS"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return sin(x), cos(x)</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.cube">
<code class="descclassname">sasmodels.special.</code><code class="descname">cube</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#cube"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return x^3</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.p1evl">
<code class="descclassname">sasmodels.special.</code><code class="descname">p1evl</code><span class="sig-paren">(</span><em>x</em>, <em>c</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#p1evl"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return x^n + p(x) for polynomial p of degree n-1 with coefficients c</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.polevl">
<code class="descclassname">sasmodels.special.</code><code class="descname">polevl</code><span class="sig-paren">(</span><em>x</em>, <em>c</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#polevl"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return p(x) for polynomial p of degree n-1 with coefficients c</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.pown">
<code class="descclassname">sasmodels.special.</code><code class="descname">pown</code><span class="sig-paren">(</span><em>x</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#pown"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return x^n for n integer</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.powr">
<code class="descclassname">sasmodels.special.</code><code class="descname">powr</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#powr"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return x^y for x&gt;0</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.sas_2J1x_x">
<code class="descclassname">sasmodels.special.</code><code class="descname">sas_2J1x_x</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#sas_2J1x_x"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return 2*J1(x)/x</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.sas_3j1x_x">
<code class="descclassname">sasmodels.special.</code><code class="descname">sas_3j1x_x</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#sas_3j1x_x"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return 3*j1(x)/x</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.sas_Si">
<code class="descclassname">sasmodels.special.</code><code class="descname">sas_Si</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#sas_Si"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return Si(x)</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.sas_j1">
<code class="descclassname">sasmodels.special.</code><code class="descname">sas_j1</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#sas_j1"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return j1(x)</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.sas_sinx_x">
<code class="descclassname">sasmodels.special.</code><code class="descname">sas_sinx_x</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#sas_sinx_x"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return sin(x)/x</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.sincos">
<code class="descclassname">sasmodels.special.</code><code class="descname">sincos</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span></dt>
<dd><p>return sin(x), cos(x)</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.special.square">
<code class="descclassname">sasmodels.special.</code><code class="descname">square</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/special.html#square"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return x^2</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-sasmodels.weights">
<span id="sasmodels-weights-module"></span><h2>sasmodels.weights module</h2>
<p>SAS distributions for polydispersity.</p>
<dl class="class">
<dt id="sasmodels.weights.ArrayDispersion">
<em class="property">class </em><code class="descclassname">sasmodels.weights.</code><code class="descname">ArrayDispersion</code><span class="sig-paren">(</span><em>npts=None</em>, <em>width=None</em>, <em>nsigmas=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#ArrayDispersion"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.weights.Dispersion" title="sasmodels.weights.Dispersion"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.weights.Dispersion</span></code></a></p>
<p>Empirical dispersion curve.</p>
<p>Use <a class="reference internal" href="#sasmodels.weights.ArrayDispersion.set_weights" title="sasmodels.weights.ArrayDispersion.set_weights"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_weights()</span></code></a> to set <span class="math notranslate nohighlight">\(w = f(x)\)</span>.</p>
<dl class="attribute">
<dt id="sasmodels.weights.ArrayDispersion.default">
<code class="descname">default</code><em class="property"> = {'npts': 35, 'nsigmas': 1, 'width': 0}</em></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sasmodels.weights.ArrayDispersion.set_weights">
<code class="descname">set_weights</code><span class="sig-paren">(</span><em>values</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#ArrayDispersion.set_weights"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Set the weights for the given x values.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.weights.ArrayDispersion.type">
<code class="descname">type</code><em class="property"> = 'array'</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.weights.BoltzmannDispersion">
<em class="property">class </em><code class="descclassname">sasmodels.weights.</code><code class="descname">BoltzmannDispersion</code><span class="sig-paren">(</span><em>npts=None</em>, <em>width=None</em>, <em>nsigmas=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#BoltzmannDispersion"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.weights.Dispersion" title="sasmodels.weights.Dispersion"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.weights.Dispersion</span></code></a></p>
<p>Boltzmann dispersion, with <span class="math notranslate nohighlight">\(\sigma=k T/E\)</span>.</p>
<div class="math notranslate nohighlight">
\[w = \exp\left( -|x - c|/\sigma\right)\]</div>
<dl class="attribute">
<dt id="sasmodels.weights.BoltzmannDispersion.default">
<code class="descname">default</code><em class="property"> = {'npts': 35, 'nsigmas': 3, 'width': 0}</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.weights.BoltzmannDispersion.type">
<code class="descname">type</code><em class="property"> = 'boltzmann'</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.weights.Dispersion">
<em class="property">class </em><code class="descclassname">sasmodels.weights.</code><code class="descname">Dispersion</code><span class="sig-paren">(</span><em>npts=None</em>, <em>width=None</em>, <em>nsigmas=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#Dispersion"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base dispersion object.</p>
<p>Subclasses should define <em>_weights(center, sigma, lb, ub)</em>
which returns the x points and their corresponding weights.</p>
<dl class="attribute">
<dt id="sasmodels.weights.Dispersion.default">
<code class="descname">default</code><em class="property"> = {'npts': 35, 'nsigmas': 3, 'width': 0}</em></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sasmodels.weights.Dispersion.get_pars">
<code class="descname">get_pars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#Dispersion.get_pars"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the parameters to the disperser as a dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.weights.Dispersion.get_weights">
<code class="descname">get_weights</code><span class="sig-paren">(</span><em>center</em>, <em>lb</em>, <em>ub</em>, <em>relative</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#Dispersion.get_weights"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the weights for the distribution.</p>
<p><em>center</em> is the center of the distribution</p>
<p><em>lb</em>, <em>ub</em> are the min and max allowed values</p>
<p><em>relative</em> is True if the distribution width is proportional to the
center value instead of absolute.  For polydispersity use relative.
For orientation parameters use absolute.</p>
</dd></dl>

<dl class="method">
<dt id="sasmodels.weights.Dispersion.set_weights">
<code class="descname">set_weights</code><span class="sig-paren">(</span><em>values</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#Dispersion.set_weights"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Set the weights on the disperser if it is <a class="reference internal" href="#sasmodels.weights.ArrayDispersion" title="sasmodels.weights.ArrayDispersion"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArrayDispersion</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sasmodels.weights.Dispersion.type">
<code class="descname">type</code><em class="property"> = 'base disperser'</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.weights.GaussianDispersion">
<em class="property">class </em><code class="descclassname">sasmodels.weights.</code><code class="descname">GaussianDispersion</code><span class="sig-paren">(</span><em>npts=None</em>, <em>width=None</em>, <em>nsigmas=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#GaussianDispersion"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.weights.Dispersion" title="sasmodels.weights.Dispersion"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.weights.Dispersion</span></code></a></p>
<p>Gaussian dispersion, with 1-<span class="math notranslate nohighlight">\(\sigma\)</span> width.</p>
<div class="math notranslate nohighlight">
\[w = \exp\left(-\tfrac12 (x - c)^2/\sigma^2\right)\]</div>
<dl class="attribute">
<dt id="sasmodels.weights.GaussianDispersion.default">
<code class="descname">default</code><em class="property"> = {'npts': 35, 'nsigmas': 3, 'width': 0}</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.weights.GaussianDispersion.type">
<code class="descname">type</code><em class="property"> = 'gaussian'</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.weights.LogNormalDispersion">
<em class="property">class </em><code class="descclassname">sasmodels.weights.</code><code class="descname">LogNormalDispersion</code><span class="sig-paren">(</span><em>npts=None</em>, <em>width=None</em>, <em>nsigmas=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#LogNormalDispersion"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.weights.Dispersion" title="sasmodels.weights.Dispersion"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.weights.Dispersion</span></code></a></p>
<p>log Gaussian dispersion, with 1-<span class="math notranslate nohighlight">\(\sigma\)</span> width.</p>
<div class="math notranslate nohighlight">
\[w = \frac{\exp\left(-\tfrac12 (\ln x - c)^2/\sigma^2\right)}{x\sigma}\]</div>
<dl class="attribute">
<dt id="sasmodels.weights.LogNormalDispersion.default">
<code class="descname">default</code><em class="property"> = {'npts': 80, 'nsigmas': 8, 'width': 0}</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.weights.LogNormalDispersion.type">
<code class="descname">type</code><em class="property"> = 'lognormal'</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.weights.RectangleDispersion">
<em class="property">class </em><code class="descclassname">sasmodels.weights.</code><code class="descname">RectangleDispersion</code><span class="sig-paren">(</span><em>npts=None</em>, <em>width=None</em>, <em>nsigmas=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#RectangleDispersion"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.weights.Dispersion" title="sasmodels.weights.Dispersion"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.weights.Dispersion</span></code></a></p>
<p>Uniform dispersion, with width <span class="math notranslate nohighlight">\(\sqrt{3}\sigma\)</span>.</p>
<div class="math notranslate nohighlight">
\[w = 1\]</div>
<dl class="attribute">
<dt id="sasmodels.weights.RectangleDispersion.default">
<code class="descname">default</code><em class="property"> = {'npts': 35, 'nsigmas': 1.73205, 'width': 0}</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.weights.RectangleDispersion.type">
<code class="descname">type</code><em class="property"> = 'rectangle'</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.weights.SchulzDispersion">
<em class="property">class </em><code class="descclassname">sasmodels.weights.</code><code class="descname">SchulzDispersion</code><span class="sig-paren">(</span><em>npts=None</em>, <em>width=None</em>, <em>nsigmas=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#SchulzDispersion"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.weights.Dispersion" title="sasmodels.weights.Dispersion"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.weights.Dispersion</span></code></a></p>
<p>Schultz dispersion, with 1-<span class="math notranslate nohighlight">\(\sigma\)</span> width.</p>
<div class="math notranslate nohighlight">
\[w = \frac{z^z\,R^{z-1}}{e^{Rz}\,c \Gamma(z)}\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is the center of the distribution, <span class="math notranslate nohighlight">\(R = x/c\)</span> and <span class="math notranslate nohighlight">\(z=(c/\sigma)^2\)</span>.</p>
<p>This is evaluated using logarithms as</p>
<div class="math notranslate nohighlight">
\[w = \exp\left(z \ln z + (z-1)\ln R - Rz - \ln c - \ln \Gamma(z) \right)\]</div>
<dl class="attribute">
<dt id="sasmodels.weights.SchulzDispersion.default">
<code class="descname">default</code><em class="property"> = {'npts': 80, 'nsigmas': 8, 'width': 0}</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.weights.SchulzDispersion.type">
<code class="descname">type</code><em class="property"> = 'schulz'</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sasmodels.weights.UniformDispersion">
<em class="property">class </em><code class="descclassname">sasmodels.weights.</code><code class="descname">UniformDispersion</code><span class="sig-paren">(</span><em>npts=None</em>, <em>width=None</em>, <em>nsigmas=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#UniformDispersion"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasmodels.weights.Dispersion" title="sasmodels.weights.Dispersion"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasmodels.weights.Dispersion</span></code></a></p>
<p>Uniform dispersion, with width <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<div class="math notranslate nohighlight">
\[w = 1\]</div>
<dl class="attribute">
<dt id="sasmodels.weights.UniformDispersion.default">
<code class="descname">default</code><em class="property"> = {'npts': 35, 'nsigmas': None, 'width': 0}</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sasmodels.weights.UniformDispersion.type">
<code class="descname">type</code><em class="property"> = 'uniform'</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="sasmodels.weights.get_weights">
<code class="descclassname">sasmodels.weights.</code><code class="descname">get_weights</code><span class="sig-paren">(</span><em>disperser</em>, <em>n</em>, <em>width</em>, <em>nsigmas</em>, <em>value</em>, <em>limits</em>, <em>relative</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#get_weights"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the set of values and weights for a polydisperse parameter.</p>
<p><em>disperser</em> is the name of the disperser.</p>
<p><em>n</em> is the number of points in the weight vector.</p>
<p><em>width</em> is the width of the disperser distribution.</p>
<p><em>nsigmas</em> is the number of sigmas to span for the dispersion convolution.</p>
<p><em>value</em> is the value of the parameter in the model.</p>
<p><em>limits</em> is [lb, ub], the lower and upper bound on the possible values.</p>
<p><em>relative</em> is true if <em>width</em> is defined in proportion to the value
of the parameter, and false if it is an absolute width.</p>
<p>Returns <em>(value, weight)</em>, where <em>value</em> and <em>weight</em> are vectors.</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.weights.load_weights">
<code class="descclassname">sasmodels.weights.</code><code class="descname">load_weights</code><span class="sig-paren">(</span><em>pattern=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#load_weights"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load dispersion distributions matching the given glob pattern</p>
</dd></dl>

<dl class="function">
<dt id="sasmodels.weights.plot_weights">
<code class="descclassname">sasmodels.weights.</code><code class="descname">plot_weights</code><span class="sig-paren">(</span><em>model_info</em>, <em>mesh</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels/weights.html#plot_weights"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Plot the weights returned by <a class="reference internal" href="#sasmodels.weights.get_weights" title="sasmodels.weights.get_weights"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_weights()</span></code></a>.</p>
<p><em>model_info</em> defines model parameters, etc.</p>
<p><em>mesh</em> is a list of tuples containing (<em>value</em>, <em>dispersity</em>, <em>weights</em>)
for each parameter, where (<em>dispersity</em>, <em>weights</em>) pairs are the
distributions to be plotted.</p>
</dd></dl>

</div>
<div class="section" id="module-sasmodels">
<span id="module-contents"></span><h2>Module contents</h2>
<div class="section" id="sasmodels">
<h3>sasmodels</h3>
<p><strong>sasmodels</strong> is a package containing models for small angle neutron and xray
scattering.  Models supported are the one dimensional circular average and
two dimensional oriented patterns.  As well as the form factor calculations
for the individual shapes <strong>sasmodels</strong> also provides automatic shape
polydispersity, angular dispersion and resolution convolution.  SESANS
patterns can be computed for any model.</p>
<p>Models can be written in python or in C.  C models can run on the GPU if
OpenCL drivers are available.  See <code class="xref py py-mod docutils literal notranslate"><span class="pre">generate</span></code> for details on
defining new models.</p>
<dl class="function">
<dt id="sasmodels.data_files">
<code class="descclassname">sasmodels.</code><code class="descname">data_files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sasmodels.html#data_files"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the data files to be installed with the package.</p>
<p>The format is a list of (directory, [files…]) pairs which can be
used directly in setup(…,data_files=…) for setup.py.</p>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">sasmodels package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-sasmodels.alignment">sasmodels.alignment module</a></li>
<li><a class="reference internal" href="#module-sasmodels.bumps_model">sasmodels.bumps_model module</a></li>
<li><a class="reference internal" href="#module-sasmodels.compare">sasmodels.compare module</a><ul>
<li><a class="reference internal" href="#program-description">Program description</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-sasmodels.compare_many">sasmodels.compare_many module</a></li>
<li><a class="reference internal" href="#module-sasmodels.conversion_table">sasmodels.conversion_table module</a></li>
<li><a class="reference internal" href="#module-sasmodels.convert">sasmodels.convert module</a></li>
<li><a class="reference internal" href="#module-sasmodels.core">sasmodels.core module</a></li>
<li><a class="reference internal" href="#module-sasmodels.data">sasmodels.data module</a></li>
<li><a class="reference internal" href="#module-sasmodels.details">sasmodels.details module</a><ul>
<li><a class="reference internal" href="#kernel-call-details">Kernel Call Details</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-sasmodels.direct_model">sasmodels.direct_model module</a></li>
<li><a class="reference internal" href="#module-sasmodels.exception">sasmodels.exception module</a></li>
<li><a class="reference internal" href="#module-sasmodels.generate">sasmodels.generate module</a></li>
<li><a class="reference internal" href="#module-sasmodels.gengauss">sasmodels.gengauss module</a></li>
<li><a class="reference internal" href="#module-sasmodels.guyou">sasmodels.guyou module</a></li>
<li><a class="reference internal" href="#module-sasmodels.jitter">sasmodels.jitter module</a><ul>
<li><a class="reference internal" href="#jitter-explorer">Jitter Explorer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-sasmodels.kernel">sasmodels.kernel module</a><ul>
<li><a class="reference internal" href="#execution-kernel-interface">Execution kernel interface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-sasmodels.kernelcl">sasmodels.kernelcl module</a></li>
<li><a class="reference internal" href="#module-sasmodels.kernelcuda">sasmodels.kernelcuda module</a></li>
<li><a class="reference internal" href="#module-sasmodels.kerneldll">sasmodels.kerneldll module</a></li>
<li><a class="reference internal" href="#module-sasmodels.kernelpy">sasmodels.kernelpy module</a></li>
<li><a class="reference internal" href="#module-sasmodels.list_pars">sasmodels.list_pars module</a></li>
<li><a class="reference internal" href="#module-sasmodels.mixture">sasmodels.mixture module</a><ul>
<li><a class="reference internal" href="#mixture-model">Mixture model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-sasmodels.model_test">sasmodels.model_test module</a></li>
<li><a class="reference internal" href="#module-sasmodels.modelinfo">sasmodels.modelinfo module</a><ul>
<li><a class="reference internal" href="#model-info-and-parameter-tables">Model Info and Parameter Tables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-sasmodels.multiscat">sasmodels.multiscat module</a></li>
<li><a class="reference internal" href="#module-sasmodels.product">sasmodels.product module</a><ul>
<li><a class="reference internal" href="#product-model">Product model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-sasmodels.resolution">sasmodels.resolution module</a></li>
<li><a class="reference internal" href="#module-sasmodels.resolution2d">sasmodels.resolution2d module</a></li>
<li><a class="reference internal" href="#module-sasmodels.rst2html">sasmodels.rst2html module</a></li>
<li><a class="reference internal" href="#module-sasmodels.sasview_model">sasmodels.sasview_model module</a></li>
<li><a class="reference internal" href="#module-sasmodels.sesans">sasmodels.sesans module</a></li>
<li><a class="reference internal" href="#module-sasmodels.special">sasmodels.special module</a><ul>
<li><a class="reference internal" href="#special-functions">Special Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-sasmodels.weights">sasmodels.weights module</a></li>
<li><a class="reference internal" href="#module-sasmodels">Module contents</a><ul>
<li><a class="reference internal" href="#sasmodels">sasmodels</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="modules.html"
                        title="previous chapter">sasmodels</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="sasmodels.custom.html"
                        title="next chapter">sasmodels.custom package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/dev/sasmodels-api/sasmodels.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sasmodels.custom.html" title="sasmodels.custom package"
             >next</a> |</li>
        <li class="right" >
          <a href="modules.html" title="sasmodels"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 5.0.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../dev.html" >Developer Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="modules.html" >sasmodels</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, The SasView Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>