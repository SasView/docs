
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>stacked_disks &#8212; SasView 5.0.4 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Ellipsoid Functions" href="../qtgui/Perspectives/Fitting/models/shape-ellipsoid.html" />
    <link rel="prev" title="pringle" href="pringle.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../qtgui/Perspectives/Fitting/models/shape-ellipsoid.html" title="Ellipsoid Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pringle.html" title="pringle"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 5.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../user.html" >SasView User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qtgui/Perspectives/Fitting/models/index.html" >Model Functions</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../qtgui/Perspectives/Fitting/models/shape-cylinder.html" accesskey="U">Cylinder Functions</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="stacked-disks">
<span id="id1"></span><h1>stacked_disks</h1>
<p>Form factor for a stacked set of non exfoliated core/shell disks</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="63%" />
<col width="13%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
<th class="head">Units</th>
<th class="head">Default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>scale</td>
<td>Scale factor or Volume fraction</td>
<td>None</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>background</td>
<td>Source background</td>
<td>cm<sup>-1</sup></td>
<td>0.001</td>
</tr>
<tr class="row-even"><td>thick_core</td>
<td>Thickness of the core disk</td>
<td>Å</td>
<td>10</td>
</tr>
<tr class="row-odd"><td>thick_layer</td>
<td>Thickness of layer each side of core</td>
<td>Å</td>
<td>10</td>
</tr>
<tr class="row-even"><td>radius</td>
<td>Radius of the stacked disk</td>
<td>Å</td>
<td>15</td>
</tr>
<tr class="row-odd"><td>n_stacking</td>
<td>Number of stacked layer/core/layer disks</td>
<td>None</td>
<td>1</td>
</tr>
<tr class="row-even"><td>sigma_d</td>
<td>Sigma of nearest neighbor spacing</td>
<td>Å</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>sld_core</td>
<td>Core scattering length density</td>
<td>10<sup>-6</sup>Å<sup>-2</sup></td>
<td>4</td>
</tr>
<tr class="row-even"><td>sld_layer</td>
<td>Layer scattering length density</td>
<td>10<sup>-6</sup>Å<sup>-2</sup></td>
<td>0</td>
</tr>
<tr class="row-odd"><td>sld_solvent</td>
<td>Solvent scattering length density</td>
<td>10<sup>-6</sup>Å<sup>-2</sup></td>
<td>5</td>
</tr>
<tr class="row-even"><td>theta</td>
<td>Orientation of the stacked disk axis w/respect incoming beam</td>
<td>degree</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>phi</td>
<td>Rotation about beam</td>
<td>degree</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>The returned value is scaled to units of cm<sup>-1</sup> sr<sup>-1</sup>, absolute scale.</p>
<p><strong>Definition</strong></p>
<p>This model provides the form factor, <span class="math notranslate nohighlight">\(P(q)\)</span>, for stacked discs (tactoids)
with a core/layer structure which is constructed itself as <span class="math notranslate nohighlight">\(P(q) S(Q)\)</span>
multiplying a <span class="math notranslate nohighlight">\(P(q)\)</span> for individual core/layer disks by a structure factor
<span class="math notranslate nohighlight">\(S(q)\)</span> proposed by Kratky and Porod in 1949<a class="footnote-reference" href="#kratky1949" id="id2">[1]</a> assuming the next
neighbor distance (d-spacing) in the stack of parallel discs obeys a Gaussian
distribution. As such the normalization of this “composite” form factor is
relative to the individual disk volume, not the volume of the stack of disks.
This model is appropriate for example for non non exfoliated clay particles
such as Laponite.</p>
<div class="figure" id="id6">
<img alt="../../_images/stacked_disks_geometry.png" src="../../_images/stacked_disks_geometry.png" />
<p class="caption"><span class="caption-number">Fig. 36 </span><span class="caption-text">Geometry of a single core/layer disk</span></p>
</div>
<p>The scattered intensity <span class="math notranslate nohighlight">\(I(q)\)</span> is calculated as</p>
<div class="math notranslate nohighlight">
\[I(q) = N\int_{0}^{\pi /2}\left[ \Delta \rho_t
\left( V_t f_t(q,\alpha) - V_c f_c(q,\alpha)\right) + \Delta
\rho_c V_c f_c(q,\alpha)\right]^2 S(q,\alpha)\sin{\alpha}\ d\alpha
+ \text{background}\]</div>
<p>where the contrast</p>
<div class="math notranslate nohighlight">
\[\Delta \rho_i = \rho_i - \rho_\text{solvent}\]</div>
<p>and <span class="math notranslate nohighlight">\(N\)</span> is the number of individual (single) discs per unit volume, <span class="math notranslate nohighlight">\(\alpha\)</span>
is the angle between the axis of the disc and <span class="math notranslate nohighlight">\(q\)</span>, and <span class="math notranslate nohighlight">\(V_t\)</span> and <span class="math notranslate nohighlight">\(V_c\)</span> are the
total volume and the core volume of a single disc, respectively, and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}f_t(q,\alpha) =
\left(\frac{\sin(q(d+h)\cos{\alpha})}{q(d+h)\cos{\alpha}}\right)
\left(\frac{2J_1(qR\sin{\alpha})}{qR\sin{\alpha}} \right)\\f_c(q,\alpha) =
\left(\frac{\sin(qh)\cos{\alpha})}{qh\cos{\alpha}}\right)
\left(\frac{2J_1(qR\sin{\alpha})}{qR\sin{\alpha}}\right)\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(d\)</span> = thickness of the layer (<em>thick_layer</em>),
<span class="math notranslate nohighlight">\(2h\)</span> = core thickness (<em>thick_core</em>), and <span class="math notranslate nohighlight">\(R\)</span> = radius of the disc (<em>radius</em>).</p>
<div class="math notranslate nohighlight">
\[S(q,\alpha) = 1 + \frac{1}{2}\sum_{k=1}^n(n-k)\cos{(kDq\cos{\alpha})}
\exp\left[ -k(q)^2(D\cos{\alpha}~\sigma_d)^2/2\right]\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the total number of the disc stacked (<em>n_stacking</em>),
<span class="math notranslate nohighlight">\(D = 2(d+h)\)</span> is the next neighbor center-to-center distance (d-spacing),
and <span class="math notranslate nohighlight">\(\sigma_d\)</span> = the Gaussian standard deviation of the d-spacing (<em>sigma_d</em>).
Note that <span class="math notranslate nohighlight">\(D\cos(\alpha)\)</span> is the component of <span class="math notranslate nohighlight">\(D\)</span> parallel to <span class="math notranslate nohighlight">\(q\)</span> and the last
term in the equation above is effectively a Debye-Waller factor term.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>1. Each assembly in the stack is layer/core/layer, so the spacing of the
cores is core plus two layers. The 2nd virial coefficient of the cylinder
is calculated based on the <em>radius</em> and <em>length</em>
= <em>n_stacking</em> * (<em>thick_core</em> + 2 * <em>thick_layer</em>)
values, and used as the effective radius for <span class="math notranslate nohighlight">\(S(Q)\)</span> when <span class="math notranslate nohighlight">\(P(Q) * S(Q)\)</span>
is applied.</p>
<p class="last">2. the resolution smearing calculation uses 76 Gaussian quadrature points
to properly smear the model since the function is HIGHLY oscillatory,
especially around the q-values that correspond to the repeat distance of
the layers.</p>
</div>
<p>2d scattering from oriented stacks is calculated in the same way as for
cylinders, for further details of the calculation and angular dispersions
see <a class="reference internal" href="../qtgui/Perspectives/Fitting/orientation/orientation.html#orientation"><span class="std std-ref">Oriented particles</span></a>.</p>
<div class="figure" id="id7">
<img alt="../../_images/cylinder_angle_definition.png" src="../../_images/cylinder_angle_definition.png" />
<p class="caption"><span class="caption-number">Fig. 37 </span><span class="caption-text">Angles <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> orient the stack of discs relative
to the beam line coordinates, where the beam is along the <span class="math notranslate nohighlight">\(z\)</span> axis.
Rotation <span class="math notranslate nohighlight">\(\theta\)</span>, initially in the <span class="math notranslate nohighlight">\(xz\)</span> plane, is carried out first,
then rotation <span class="math notranslate nohighlight">\(\phi\)</span> about the <span class="math notranslate nohighlight">\(z\)</span> axis. Orientation distributions are
described as rotations about two perpendicular axes <span class="math notranslate nohighlight">\(\delta_1\)</span> and
<span class="math notranslate nohighlight">\(\delta_2\)</span> in the frame of the cylinder itself, which when
<span class="math notranslate nohighlight">\(\theta = \phi = 0\)</span> are parallel to the <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(X\)</span> axes.</span></p>
</div>
<p>Our model is derived from the form factor calculations implemented in a
C-library provided by the NIST Center for Neutron Research<a class="footnote-reference" href="#kline2006" id="id3">[2]</a></p>
<div class="figure" id="id8">
<img alt="../../_images/stacked_disks_autogenfig.png" src="../../_images/stacked_disks_autogenfig.png" />
<p class="caption"><span class="caption-number">Fig. 38 </span><span class="caption-text">1D and 2D plots corresponding to the default parameters of the model.</span></p>
</div>
<p><strong>Source</strong></p>
<p><a class="reference download internal" download="" href="../../_downloads/c2cb69e1dc23879ec1bb758b76ff5288/stacked_disks.py"><code class="xref download docutils literal notranslate"><span class="pre">stacked_disks.py</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/6f2a6c6d827ca2a8c9b3ed7a071e5896/stacked_disks.c"><code class="xref download docutils literal notranslate"><span class="pre">stacked_disks.c</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/8d7f71afcb56f060bc93bd8ec5af0bfd/gauss76.c"><code class="xref download docutils literal notranslate"><span class="pre">gauss76.c</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/6f2e8dceeefbaa525721c5ebabb4c04f/sas_J1.c"><code class="xref download docutils literal notranslate"><span class="pre">sas_J1.c</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/24ddf5d205ee60568a83094f935424da/polevl.c"><code class="xref download docutils literal notranslate"><span class="pre">polevl.c</span></code></a></p>
<p><strong>References</strong></p>
<p>See also Higgins and Benoit <a class="footnote-reference" href="#higgins1994" id="id4">[3]</a> and Guinier and
Fournet <a class="footnote-reference" href="#guinier1955" id="id5">[4]</a>.</p>
<table class="docutils footnote" frame="void" id="kratky1949" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>O Kratky and G Porod, <em>J. Colloid Science</em>, 4, (1949) 35</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="kline2006" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>S R Kline, <em>J Appl. Cryst.</em>, 39 (2006) 895</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="higgins1994" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[3]</a></td><td>J S Higgins and H C Benoit, <em>Polymers and Neutron Scattering</em>,
Clarendon, Oxford, 1994</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="guinier1955" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[4]</a></td><td>A Guinier and G Fournet, <em>Small-Angle Scattering of X-Rays</em>,
John Wiley and Sons, New York, 1955</td></tr>
</tbody>
</table>
<p><strong>Authorship and Verification</strong></p>
<ul class="simple">
<li><strong>Author:</strong> NIST IGOR/DANSE <strong>Date:</strong> pre 2010</li>
<li><strong>Last Modified by:</strong> Paul Butler and Paul Kienzle <strong>Date:</strong> November 26, 2016</li>
<li><strong>Last Reviewed by:</strong> Paul Butler and Paul Kienzle <strong>Date:</strong> November 26, 2016</li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="pringle.html"
                        title="previous chapter">pringle</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../qtgui/Perspectives/Fitting/models/shape-ellipsoid.html"
                        title="next chapter">Ellipsoid Functions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user/models/stacked_disks.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../qtgui/Perspectives/Fitting/models/shape-ellipsoid.html" title="Ellipsoid Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="pringle.html" title="pringle"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 5.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../user.html" >SasView User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qtgui/Perspectives/Fitting/models/index.html" >Model Functions</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../qtgui/Perspectives/Fitting/models/shape-cylinder.html" >Cylinder Functions</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, The SasView Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>