
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>spherical_sld &#8212; SasView 5.0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="vesicle" href="vesicle.html" />
    <link rel="prev" title="sphere" href="sphere.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vesicle.html" title="vesicle"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sphere.html" title="sphere"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 5.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../user.html" >SasView User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qtgui/Perspectives/Fitting/models/index.html" >Model Functions</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../qtgui/Perspectives/Fitting/models/shape-sphere.html" accesskey="U">Sphere Functions</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="spherical-sld">
<span id="id1"></span><h1>spherical_sld</h1>
<p>Spherical SLD intensity calculation</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="57%" />
<col width="12%" />
<col width="13%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
<th class="head">Units</th>
<th class="head">Default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>scale</td>
<td>Source intensity</td>
<td>None</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>background</td>
<td>Source background</td>
<td>cm<sup>-1</sup></td>
<td>0.001</td>
</tr>
<tr class="row-even"><td>n_shells</td>
<td>number of shells (must be integer)</td>
<td>None</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>sld_solvent</td>
<td>solvent sld</td>
<td>10<sup>-6</sup>Å<sup>-2</sup></td>
<td>1</td>
</tr>
<tr class="row-even"><td>sld[n_shells]</td>
<td>sld of the shell</td>
<td>10<sup>-6</sup>Å<sup>-2</sup></td>
<td>4.06</td>
</tr>
<tr class="row-odd"><td>thickness[n_shells]</td>
<td>thickness shell</td>
<td>Å</td>
<td>100</td>
</tr>
<tr class="row-even"><td>interface[n_shells]</td>
<td>thickness of the interface</td>
<td>Å</td>
<td>50</td>
</tr>
<tr class="row-odd"><td>shape[n_shells]</td>
<td>interface shape</td>
<td>None</td>
<td>0</td>
</tr>
<tr class="row-even"><td>nu[n_shells]</td>
<td>interface shape exponent</td>
<td>None</td>
<td>2.5</td>
</tr>
<tr class="row-odd"><td>n_steps</td>
<td>number of steps in each interface (must be an odd integer)</td>
<td>None</td>
<td>35</td>
</tr>
</tbody>
</table>
<p>The returned value is scaled to units of cm<sup>-1</sup> sr<sup>-1</sup>, absolute scale.</p>
<p><strong>Definition</strong></p>
<p>Similarly to the onion, this model provides the form factor, <span class="math notranslate nohighlight">\(P(q)\)</span>, for
a multi-shell sphere, where the interface between the each neighboring
shells can be described by the error function, power-law, or exponential
functions.  The scattering intensity is computed by building a continuous
custom SLD profile along the radius of the particle. The SLD profile is
composed of a number of uniform shells with interfacial shells between them.</p>
<div class="figure" id="id2">
<img alt="../../_images/spherical_sld_profile.png" src="../../_images/spherical_sld_profile.png" />
<p class="caption"><span class="caption-number">Fig. 90 </span><span class="caption-text">Example SLD profile</span></p>
</div>
<p>Unlike the <a class="reference internal" href="onion.html#onion"><span class="std std-ref">onion</span></a> model (using an analytical integration), the interfacial
shells here are sub-divided and numerically integrated assuming each
sub-shell is described by a line function, with <em>n_steps</em> sub-shells per
interface. The form factor is normalized by the total volume of the sphere.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>n_shells</em> must be an integer. <em>n_steps</em> must be an ODD integer.</p>
</div>
<p>Interface shapes are as follows:</p>
<blockquote>
<div><p>0: erf(<span class="math notranslate nohighlight">\(\nu z\)</span>)</p>
<p>1: Rpow(<span class="math notranslate nohighlight">\(z^\nu\)</span>)</p>
<p>2: Lpow(<span class="math notranslate nohighlight">\(z^\nu\)</span>)</p>
<p>3: Rexp(<span class="math notranslate nohighlight">\(-\nu z\)</span>)</p>
<p>4: Lexp(<span class="math notranslate nohighlight">\(-\nu z\)</span>)</p>
</div></blockquote>
<p>The form factor <span class="math notranslate nohighlight">\(P(q)\)</span> in 1D is calculated by:</p>
<div class="math notranslate nohighlight">
\[P(q) = \frac{f^2}{V_\text{particle}} \text{ where }
f = f_\text{core} + \sum_{\text{inter}_i=0}^N f_{\text{inter}_i} +
\sum_{\text{flat}_i=0}^N f_{\text{flat}_i} +f_\text{solvent}\]</div>
<p>For a spherically symmetric particle with a particle density <span class="math notranslate nohighlight">\(\rho_x(r)\)</span>
the sld function can be defined as:</p>
<div class="math notranslate nohighlight">
\[f_x = 4 \pi \int_{0}^{\infty} \rho_x(r)  \frac{\sin(qr)} {qr^2} r^2 dr\]</div>
<p>so that individual terms can be calculated as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f_\text{core} &amp;= 4 \pi \int_{0}^{r_\text{core}} \rho_\text{core}
\frac{\sin(qr)} {qr} r^2 dr =
3 \rho_\text{core} V(r_\text{core})
\Big[ \frac{\sin(qr_\text{core}) - qr_\text{core} \cos(qr_\text{core})}
{qr_\text{core}^3} \Big] \\
f_{\text{inter}_i} &amp;= 4 \pi \int_{\Delta t_{ \text{inter}_i } }
\rho_{ \text{inter}_i } \frac{\sin(qr)} {qr} r^2 dr \\
f_{\text{shell}_i} &amp;= 4 \pi \int_{\Delta t_{ \text{inter}_i } }
\rho_{ \text{flat}_i } \frac{\sin(qr)} {qr} r^2 dr =
3 \rho_{ \text{flat}_i } V ( r_{ \text{inter}_i } +
\Delta t_{ \text{inter}_i } )
\Big[ \frac{\sin(qr_{\text{inter}_i} + \Delta t_{ \text{inter}_i } )
- q (r_{\text{inter}_i} + \Delta t_{ \text{inter}_i })
\cos(q( r_{\text{inter}_i} + \Delta t_{ \text{inter}_i } ) ) }
{q ( r_{\text{inter}_i} + \Delta t_{ \text{inter}_i } )^3 }  \Big]
-3 \rho_{ \text{flat}_i } V(r_{ \text{inter}_i })
\Big[ \frac{\sin(qr_{\text{inter}_i}) - qr_{\text{flat}_i}
\cos(qr_{\text{inter}_i}) } {qr_{\text{inter}_i}^3} \Big] \\
f_\text{solvent} &amp;= 4 \pi \int_{r_N}^{\infty} \rho_\text{solvent}
\frac{\sin(qr)} {qr} r^2 dr =
3 \rho_\text{solvent} V(r_N)
\Big[ \frac{\sin(qr_N) - qr_N \cos(qr_N)} {qr_N^3} \Big]\end{split}\]</div>
<p>Here we assumed that the SLDs of the core and solvent are constant in <span class="math notranslate nohighlight">\(r\)</span>.
The SLD at the interface between shells, <span class="math notranslate nohighlight">\(\rho_{\text {inter}_i}\)</span>
is calculated with a function chosen by an user, where the functions are</p>
<p>Exp:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\rho_{{inter}_i} (r) &amp;= \begin{cases}
B \exp\Big( \frac {\pm A(r - r_{\text{flat}_i})}
{\Delta t_{ \text{inter}_i }} \Big) +C  &amp; \mbox{for } A \neq 0 \\
B \Big( \frac {(r - r_{\text{flat}_i})}
{\Delta t_{ \text{inter}_i }} \Big) +C  &amp; \mbox{for } A = 0 \\
\end{cases}\end{split}\]</div>
<p>Power-Law:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\rho_{{inter}_i} (r) &amp;= \begin{cases}
\pm B \Big( \frac {(r - r_{\text{flat}_i} )} {\Delta t_{ \text{inter}_i }}
\Big) ^A  +C  &amp; \mbox{for } A \neq 0 \\
\rho_{\text{flat}_{i+1}}  &amp; \mbox{for } A = 0 \\
\end{cases}\end{split}\]</div>
<p>Erf:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\rho_{{inter}_i} (r) = \begin{cases}
B \text{erf} \Big( \frac { A(r - r_{\text{flat}_i})}
{\sqrt{2} \Delta t_{ \text{inter}_i }} \Big) +C  &amp; \mbox{for } A \neq 0 \\
B \Big( \frac {(r - r_{\text{flat}_i} )} {\Delta t_{ \text{inter}_i }}
\Big)  +C  &amp; \mbox{for } A = 0 \\
\end{cases}\end{split}\]</div>
<p>The functions are normalized so that they vary between 0 and 1, and they are
constrained such that the SLD is continuous at the boundaries of the interface
as well as each sub-shell. Thus B and C are determined.</p>
<p>Once <span class="math notranslate nohighlight">\(\rho_{\text{inter}_i}\)</span> is found at the boundary of the sub-shell of the
interface, we can find its contribution to the form factor <span class="math notranslate nohighlight">\(P(q)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}f_{\text{inter}_i} &amp;= 4 \pi \int_{\Delta t_{ \text{inter}_i } }
\rho_{ \text{inter}_i } \frac{\sin(qr)} {qr} r^2 dr =
4 \pi \sum_{j=1}^{n_\text{steps}}
\int_{r_j}^{r_{j+1}} \rho_{ \text{inter}_i } (r_j)
\frac{\sin(qr)} {qr} r^2 dr \\
\approx 4 \pi \sum_{j=1}^{n_\text{steps}} \Big[
3 ( \rho_{ \text{inter}_i } ( r_{j+1} ) - \rho_{ \text{inter}_i }
( r_{j} ) V (r_j)
\Big[ \frac {r_j^2 \beta_\text{out}^2 \sin(\beta_\text{out})
- (\beta_\text{out}^2-2) \cos(\beta_\text{out}) }
{\beta_\text{out}^4 } \Big] \\
{} - 3 ( \rho_{ \text{inter}_i } ( r_{j+1} ) - \rho_{ \text{inter}_i }
( r_{j} ) V ( r_{j-1} )
\Big[ \frac {r_{j-1}^2 \sin(\beta_\text{in})
- (\beta_\text{in}^2-2) \cos(\beta_\text{in}) }
{\beta_\text{in}^4 } \Big] \\
{} + 3 \rho_{ \text{inter}_i } ( r_{j+1} )  V ( r_j )
\Big[ \frac {\sin(\beta_\text{out}) - \cos(\beta_\text{out}) }
{\beta_\text{out}^4 } \Big]
- 3 \rho_{ \text{inter}_i } ( r_{j} )  V ( r_j )
\Big[ \frac {\sin(\beta_\text{in}) - \cos(\beta_\text{in}) }
{\beta_\text{in}^4 } \Big]
\Big]\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\begin{align*}
V(a) &amp;= \frac {4\pi}{3}a^3 &amp;&amp; \\
a_\text{in} \sim \frac{r_j}{r_{j+1} -r_j} \text{, } &amp; a_\text{out}
\sim \frac{r_{j+1}}{r_{j+1} -r_j} \\
\beta_\text{in} &amp;= qr_j \text{, } &amp; \beta_\text{out} &amp;= qr_{j+1}
\end{align*}</div><p>We assume <span class="math notranslate nohighlight">\(\rho_{\text{inter}_j} (r)\)</span> is approximately linear
within the sub-shell <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>Finally the form factor can be calculated by</p>
<div class="math notranslate nohighlight">
\[P(q) = \frac{[f]^2} {V_\text{particle}} \mbox{ where } V_\text{particle}
= V(r_{\text{shell}_N})\]</div>
<p>For 2D data the scattering intensity is calculated in the same way as 1D,
where the <span class="math notranslate nohighlight">\(q\)</span> vector is defined as</p>
<div class="math notranslate nohighlight">
\[q = \sqrt{q_x^2 + q_y^2}\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The outer most radius is used as the effective radius for <span class="math notranslate nohighlight">\(S(Q)\)</span>
when <span class="math notranslate nohighlight">\(P(Q) * S(Q)\)</span> is applied.</p>
</div>
<div class="figure" id="id3">
<img alt="../../_images/spherical_sld_autogenfig.png" src="../../_images/spherical_sld_autogenfig.png" />
<p class="caption"><span class="caption-number">Fig. 91 </span><span class="caption-text">1D plot corresponding to the default parameters of the model.</span></p>
</div>
<p><strong>Source</strong></p>
<p><a class="reference download internal" download="" href="../../_downloads/741dd98bd13af7267e0440c785f79955/spherical_sld.py"><code class="xref download docutils literal notranslate"><span class="pre">spherical_sld.py</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/02047b0ee09f6a0a9dd594e29c00cbcc/spherical_sld.c"><code class="xref download docutils literal notranslate"><span class="pre">spherical_sld.c</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/6846240e6b225baee866f56076213b29/sas_3j1x_x.c"><code class="xref download docutils literal notranslate"><span class="pre">lib/sas_3j1x_x.c</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/9e8c8f16866a0282883223a6816634fe/sas_erf.c"><code class="xref download docutils literal notranslate"><span class="pre">lib/sas_erf.c</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/9aa055a3bd852f216e2ff4f4ad9e9d79/polevl.c"><code class="xref download docutils literal notranslate"><span class="pre">lib/polevl.c</span></code></a></p>
<p><strong>References</strong></p>
<ol class="arabic simple">
<li>L A Feigin and D I Svergun, Structure Analysis by Small-Angle X-Ray
and Neutron Scattering, Plenum Press, New York, (1987)</li>
</ol>
<p><strong>Authorship and Verification</strong></p>
<ul class="simple">
<li><strong>Author:</strong> Jae-Hie Cho <strong>Date:</strong> Nov 1, 2010</li>
<li><strong>Last Modified by:</strong> Paul Kienzle <strong>Date:</strong> Dec 20, 2016</li>
<li><strong>Last Reviewed by:</strong> Steve King <strong>Date:</strong> March 29, 2019</li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="sphere.html"
                        title="previous chapter">sphere</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="vesicle.html"
                        title="next chapter">vesicle</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user/models/spherical_sld.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vesicle.html" title="vesicle"
             >next</a> |</li>
        <li class="right" >
          <a href="sphere.html" title="sphere"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 5.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../user.html" >SasView User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qtgui/Perspectives/Fitting/models/index.html" >Model Functions</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../qtgui/Perspectives/Fitting/models/shape-sphere.html" >Sphere Functions</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, The SasView Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>